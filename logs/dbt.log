2021-11-11 04:08:45.260755 (MainThread): Running with dbt=0.21.0
2021-11-11 04:08:46.186715 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:08:46.189337 (MainThread): Tracking: tracking
2021-11-11 04:08:46.190094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b84eba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb005460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb0058e0>]}
2021-11-11 04:08:46.204194 (MainThread): Partial parsing not enabled
2021-11-11 04:08:46.216339 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:08:46.219775 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:08:46.257145 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:08:46.260761 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:08:46.264877 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:08:46.266093 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:08:46.268924 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:08:46.276822 (MainThread): Parsing macros/core.sql
2021-11-11 04:08:46.280147 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:08:46.286185 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:08:46.295772 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:08:46.298249 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:08:46.313490 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:08:46.343551 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:08:46.364597 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:08:46.366212 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:08:46.374826 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:08:46.390729 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:08:46.401902 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:08:46.408758 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:08:46.414621 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:08:46.417694 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:08:46.419081 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:08:46.419810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:08:46.420967 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:08:46.427900 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:08:46.429295 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:08:46.431155 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:08:46.432375 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:08:46.477844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:08:46.479206 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:08:46.480116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:08:46.481134 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:08:46.708572 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:08:46.720640 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:08:46.758206 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00801b58-6181-4eca-8e10-b1ff3fafe549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12fd00>]}
2021-11-11 04:08:46.762367 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00801b58-6181-4eca-8e10-b1ff3fafe549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12feb0>]}
2021-11-11 04:08:46.762893 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:08:46.764530 (MainThread): 
2021-11-11 04:08:46.765091 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:08:46.766171 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:08:46.780392 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:08:46.780601 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:08:46.780904 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:08:47.661723 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.88 seconds
2021-11-11 04:08:47.664758 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:08:47.833599 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.834308 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.834734 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-11-11 04:08:47.843308 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.843587 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-11-11 04:08:47.843790 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-11 04:08:48.413389 (ThreadPoolExecutor-0_0): Snowflake query id: 01a035b8-3200-8f0f-0000-00008a252179
2021-11-11 04:08:48.413831 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-11-11 04:08:48.414214 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-11-11 04:08:48.414501 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-11-11 04:08:48.414849 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-11-11 04:08:48.583970 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:08:48.584402 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-11-11 04:08:48.584838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ba7ee2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12a280>]}
2021-11-11 04:08:48.585362 (MainThread): Flushing usage events
2021-11-11 04:08:49.842421 (MainThread): Encountered an error:
2021-11-11 04:08:49.842936 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-11-11 04:08:49.851836 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    create_future.result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in create_schema
    adapter.create_schema(relation)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-11-11 04:15:21.088696 (MainThread): Running with dbt=0.21.0
2021-11-11 04:15:21.923209 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:15:21.925322 (MainThread): Tracking: tracking
2021-11-11 04:15:21.926506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a194abbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c701a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c701a90>]}
2021-11-11 04:15:21.939104 (MainThread): Partial parsing not enabled
2021-11-11 04:15:21.949156 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:15:21.952658 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:15:21.987974 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:15:21.991568 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:15:21.995641 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:15:21.996859 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:15:21.999675 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:15:22.008614 (MainThread): Parsing macros/core.sql
2021-11-11 04:15:22.012802 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:15:22.019000 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:15:22.028927 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:15:22.030566 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:15:22.047244 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:15:22.078110 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:15:22.098433 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:15:22.099868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:15:22.108221 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:15:22.124624 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:15:22.136573 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:15:22.142927 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:15:22.148947 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:15:22.152566 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:15:22.153874 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:15:22.154606 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:15:22.155761 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:15:22.162630 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:15:22.164011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:15:22.165890 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:15:22.167104 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:15:22.213503 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:15:22.214883 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:15:22.215916 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:15:22.216971 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:15:22.436874 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:22.447629 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:15:22.482372 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c7ec730>]}
2021-11-11 04:15:22.487803 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c7a7ca0>]}
2021-11-11 04:15:22.488213 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:15:22.489610 (MainThread): 
2021-11-11 04:15:22.490053 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:15:22.491106 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:15:22.502443 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:15:22.502606 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:15:22.502720 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:15:23.465515 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.96 seconds
2021-11-11 04:15:23.469387 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:15:23.630811 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.631497 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.631925 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-11-11 04:15:23.640364 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.640630 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-11-11 04:15:23.640825 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-11 04:15:24.449751 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.81 seconds
2021-11-11 04:15:24.451892 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-11-11 04:15:24.619166 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:15:24.631018 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:15:24.631314 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:15:24.631529 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:15:25.166486 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.53 seconds
2021-11-11 04:15:25.169517 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:15:25.331661 (MainThread): 12:15:25 | Concurrency: 1 threads (target='dev')
2021-11-11 04:15:25.332159 (MainThread): 12:15:25 | 
2021-11-11 04:15:25.334188 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:25.334985 (Thread-1): 12:15:25 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:15:25.335569 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:25.335879 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:25.340332 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:15:25.341546 (Thread-1): finished collecting timing info
2021-11-11 04:15:25.372660 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:15:25.373934 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:25.374098 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:15:25.374270 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:15:25.967506 (Thread-1): Snowflake query id: 01a035bf-3200-8f0f-0000-00008a252309
2021-11-11 04:15:25.967931 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:15:25.968369 (Thread-1): finished collecting timing info
2021-11-11 04:15:25.969072 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:15:26.127974 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:15:26.132188 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d3ba5e0>]}
2021-11-11 04:15:26.133435 (Thread-1): 12:15:26 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.80s]
2021-11-11 04:15:26.133871 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:26.135617 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:15:26.136305 (Thread-1): 12:15:26 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:15:26.136751 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:15:26.138880 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:15:26.139670 (MainThread): 12:15:26 | 
2021-11-11 04:15:26.139963 (MainThread): 12:15:26 | Finished running 1 table model, 1 view model in 3.65s.
2021-11-11 04:15:26.140216 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:15:26.140420 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:15:26.147882 (MainThread): 
2021-11-11 04:15:26.148205 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:15:26.148436 (MainThread): 
2021-11-11 04:15:26.148653 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:15:26.148848 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:15:26.149036 (MainThread):   
2021-11-11 04:15:26.149217 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:15:26.149443 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:15:26.149746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d02c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d30e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d30ea60>]}
2021-11-11 04:15:26.150105 (MainThread): Flushing usage events
2021-11-11 04:17:13.933173 (MainThread): Running with dbt=0.21.0
2021-11-11 04:17:14.769624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:17:14.771223 (MainThread): Tracking: tracking
2021-11-11 04:17:14.771837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e534abee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55f04a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55f04ac0>]}
2021-11-11 04:17:14.783735 (MainThread): Partial parsing not enabled
2021-11-11 04:17:14.793747 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:17:14.797244 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:17:14.832091 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:17:14.835684 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:17:14.839853 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:17:14.841086 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:17:14.843956 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:17:14.852093 (MainThread): Parsing macros/core.sql
2021-11-11 04:17:14.855481 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:17:14.861642 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:17:14.870715 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:17:14.873005 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:17:14.890247 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:17:14.921517 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:17:14.943583 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:17:14.945052 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:17:14.953382 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:17:14.970088 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:17:14.982306 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:17:14.989227 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:17:14.995541 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:17:14.998739 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:17:14.999972 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:17:15.000747 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:17:15.002534 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:17:15.010094 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:17:15.011609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:17:15.014094 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:17:15.016051 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:17:15.072884 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:17:15.074514 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:17:15.075610 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:17:15.076825 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:17:15.296925 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:15.307811 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:17:15.345369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55fec3d0>]}
2021-11-11 04:17:15.349094 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55fa7400>]}
2021-11-11 04:17:15.349356 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:17:15.350201 (MainThread): 
2021-11-11 04:17:15.350622 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:17:15.351306 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:17:15.362706 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:17:15.362881 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:17:15.362989 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:17:16.395130 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.03 seconds
2021-11-11 04:17:16.398482 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:17:16.562166 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:17:16.574147 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:17:16.574453 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:17:16.574663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:17:17.279713 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.70 seconds
2021-11-11 04:17:17.282898 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:17:17.446716 (MainThread): 12:17:17 | Concurrency: 1 threads (target='dev')
2021-11-11 04:17:17.447212 (MainThread): 12:17:17 | 
2021-11-11 04:17:17.449209 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:17.449909 (Thread-1): 12:17:17 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:17:17.450498 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:17.450778 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:17.455157 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:17:17.456018 (Thread-1): finished collecting timing info
2021-11-11 04:17:17.486476 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:17:17.487429 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:17.487604 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:17:17.487738 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:17:18.068796 (Thread-1): Snowflake query id: 01a035c1-3200-8f0d-0000-00008a2532d5
2021-11-11 04:17:18.069141 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:17:18.069477 (Thread-1): finished collecting timing info
2021-11-11 04:17:18.069791 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:17:18.224588 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:17:18.231242 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e563dea00>]}
2021-11-11 04:17:18.232302 (Thread-1): 12:17:18 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.78s]
2021-11-11 04:17:18.232699 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:18.233695 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:17:18.234101 (Thread-1): 12:17:18 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:17:18.234740 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:17:18.237024 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:17:18.237835 (MainThread): 12:17:18 | 
2021-11-11 04:17:18.238193 (MainThread): 12:17:18 | Finished running 1 table model, 1 view model in 2.89s.
2021-11-11 04:17:18.238452 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:17:18.238658 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:17:18.246102 (MainThread): 
2021-11-11 04:17:18.246427 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:17:18.246662 (MainThread): 
2021-11-11 04:17:18.246876 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:17:18.247074 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:17:18.247286 (MainThread):   
2021-11-11 04:17:18.247470 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:17:18.247677 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:17:18.247975 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5612c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e564be880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e564beb20>]}
2021-11-11 04:17:18.248318 (MainThread): Flushing usage events
2021-11-11 04:22:44.872330 (MainThread): Running with dbt=0.21.0
2021-11-11 04:22:45.713139 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:22:45.714927 (MainThread): Tracking: tracking
2021-11-11 04:22:45.715447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0adabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0059a0>]}
2021-11-11 04:22:45.726331 (MainThread): Partial parsing not enabled
2021-11-11 04:22:45.736394 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:22:45.739628 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:22:45.774003 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:22:45.777621 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:22:45.781743 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:22:45.783146 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:22:45.786036 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:22:45.793719 (MainThread): Parsing macros/core.sql
2021-11-11 04:22:45.796776 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:22:45.802419 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:22:45.810641 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:22:45.812029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:22:45.828337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:22:45.861077 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:22:45.882415 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:22:45.884031 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:22:45.893680 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:22:45.912007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:22:45.923876 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:22:45.930277 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:22:45.936513 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:22:45.940070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:22:45.941354 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:22:45.942111 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:22:45.943280 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:22:45.950224 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:22:45.952094 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:22:45.954094 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:22:45.955410 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:22:46.002959 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:22:46.004416 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:22:46.005379 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:22:46.006426 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:22:46.223304 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:46.234254 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:22:46.274309 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0a7df0>]}
2021-11-11 04:22:46.278472 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0a7be0>]}
2021-11-11 04:22:46.278800 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:22:46.279799 (MainThread): 
2021-11-11 04:22:46.280337 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:22:46.281184 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:22:46.291839 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:22:46.292006 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:22:46.292112 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:22:47.106757 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.81 seconds
2021-11-11 04:22:47.110729 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:22:47.269280 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:22:47.281284 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:22:47.281584 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:22:47.281795 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:22:47.963769 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.68 seconds
2021-11-11 04:22:47.966907 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:22:48.138663 (MainThread): 12:22:48 | Concurrency: 1 threads (target='dev')
2021-11-11 04:22:48.139171 (MainThread): 12:22:48 | 
2021-11-11 04:22:48.141171 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.141864 (Thread-1): 12:22:48 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:22:48.142426 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:48.142698 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.147140 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:22:48.148007 (Thread-1): finished collecting timing info
2021-11-11 04:22:48.178088 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:22:48.179021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:48.179149 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:22:48.179251 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:22:48.746311 (Thread-1): Snowflake query id: 01a035c6-3200-8f0d-0000-00008a2532f9
2021-11-11 04:22:48.746656 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:22:48.746998 (Thread-1): finished collecting timing info
2021-11-11 04:22:48.747318 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:22:48.905569 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:22:48.909073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d41d040>]}
2021-11-11 04:22:48.909926 (Thread-1): 12:22:48 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.77s]
2021-11-11 04:22:48.910327 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.911674 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:22:48.912176 (Thread-1): 12:22:48 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:22:48.912728 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:22:48.914924 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:22:48.915529 (MainThread): 12:22:48 | 
2021-11-11 04:22:48.915853 (MainThread): 12:22:48 | Finished running 1 table model, 1 view model in 2.64s.
2021-11-11 04:22:48.916109 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:22:48.916315 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:22:48.923442 (MainThread): 
2021-11-11 04:22:48.923769 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:22:48.923996 (MainThread): 
2021-11-11 04:22:48.924207 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:22:48.924435 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:22:48.924623 (MainThread):   
2021-11-11 04:22:48.924804 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:22:48.925012 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:22:48.925309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d12d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d3db4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d3db760>]}
2021-11-11 04:22:48.925659 (MainThread): Flushing usage events
2021-11-11 04:24:11.575235 (MainThread): Running with dbt=0.21.0
2021-11-11 04:24:12.386921 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:24:12.388686 (MainThread): Tracking: tracking
2021-11-11 04:24:12.389299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7aaebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf0a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf0a9a0>]}
2021-11-11 04:24:12.401082 (MainThread): Partial parsing not enabled
2021-11-11 04:24:12.411152 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:24:12.414496 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:24:12.449205 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:24:12.452823 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:24:12.457175 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:24:12.458459 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:24:12.461300 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:24:12.469308 (MainThread): Parsing macros/core.sql
2021-11-11 04:24:12.472540 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:24:12.478074 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:24:12.486399 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:24:12.488087 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:24:12.503397 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:24:12.535230 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:24:12.556120 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:24:12.557648 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:24:12.566440 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:24:12.583134 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:24:12.594394 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:24:12.601629 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:24:12.607528 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:24:12.610773 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:24:12.611935 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:24:12.612672 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:24:12.613980 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:24:12.620758 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:24:12.622125 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:24:12.624020 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:24:12.625214 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:24:12.674953 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:24:12.676563 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:24:12.677642 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:24:12.678844 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:24:12.892305 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:12.903090 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:12.939032 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb6a0>]}
2021-11-11 04:24:12.943362 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb670>]}
2021-11-11 04:24:12.943708 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:24:12.944622 (MainThread): 
2021-11-11 04:24:12.945029 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:24:12.945828 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:24:12.957438 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:24:12.957610 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:24:12.957725 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:24:13.804237 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2021-11-11 04:24:13.807558 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:24:13.967109 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:24:13.978939 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:24:13.979228 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:24:13.979438 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:24:14.720982 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.74 seconds
2021-11-11 04:24:14.724050 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:24:14.887542 (MainThread): 12:24:14 | Concurrency: 1 threads (target='dev')
2021-11-11 04:24:14.888056 (MainThread): 12:24:14 | 
2021-11-11 04:24:14.890125 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:14.890757 (Thread-1): 12:24:14 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:24:14.891531 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:14.891871 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:14.896308 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:24:14.897066 (Thread-1): finished collecting timing info
2021-11-11 04:24:14.927276 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:24:14.928234 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:14.928371 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:24:14.928486 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:24:16.427323 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-11-11 04:24:16.446090 (Thread-1): finished collecting timing info
2021-11-11 04:24:16.446446 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:24:16.610747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7dc86af0>]}
2021-11-11 04:24:16.611659 (Thread-1): 12:24:16 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.72s]
2021-11-11 04:24:16.612081 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:16.613223 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:16.613795 (Thread-1): 12:24:16 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-11-11 04:24:16.614620 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:16.614933 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:16.619148 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-11 04:24:16.619992 (Thread-1): finished collecting timing info
2021-11-11 04:24:16.641225 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-11 04:24:16.642168 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:16.642366 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-11-11 04:24:16.642488 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:24:17.264527 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-11-11 04:24:17.267975 (Thread-1): finished collecting timing info
2021-11-11 04:24:17.268410 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-11 04:24:17.430129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7dc86970>]}
2021-11-11 04:24:17.431029 (Thread-1): 12:24:17 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 0.82s]
2021-11-11 04:24:17.431460 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:17.433716 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:24:17.434470 (MainThread): 12:24:17 | 
2021-11-11 04:24:17.434767 (MainThread): 12:24:17 | Finished running 1 table model, 1 view model in 4.49s.
2021-11-11 04:24:17.435021 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:24:17.435248 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-11 04:24:17.442258 (MainThread): 
2021-11-11 04:24:17.442570 (MainThread): Completed successfully
2021-11-11 04:24:17.442821 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-11 04:24:17.443141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf406a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7d92ac70>]}
2021-11-11 04:24:17.443493 (MainThread): Flushing usage events
2021-11-24 03:42:47.593555 (MainThread): Running with dbt=0.21.0
2021-11-24 03:42:49.604085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:42:49.606233 (MainThread): Tracking: tracking
2021-11-24 03:42:49.606759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f9cebfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fce07af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fce07b80>]}
2021-11-24 03:42:49.618729 (MainThread): Partial parsing not enabled
2021-11-24 03:42:49.640530 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:42:49.643853 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:42:49.698159 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:42:49.702473 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:42:49.707699 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:42:49.709112 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:42:49.712780 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:42:49.720994 (MainThread): Parsing macros/core.sql
2021-11-24 03:42:49.724399 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:42:49.730668 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:42:49.739611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:42:49.741187 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:42:49.757005 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:42:49.785896 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:42:49.805731 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:42:49.807415 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:42:49.816203 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:42:49.832755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:42:49.843993 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:42:49.850334 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:42:49.856228 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:42:49.859293 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:42:49.860612 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:42:49.861347 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:42:49.862515 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:42:49.869540 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:42:49.870948 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:42:49.872833 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:42:49.874072 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:42:49.919455 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:42:49.920797 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:42:49.921738 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:42:49.922785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:42:50.137158 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:50.148040 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:50.185507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd82b6a0>]}
2021-11-24 03:42:50.189914 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd82b1c0>]}
2021-11-24 03:42:50.190223 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:42:50.191139 (MainThread): 
2021-11-24 03:42:50.191502 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:42:50.192258 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:42:50.203868 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:42:50.204048 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:42:50.204168 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:42:51.260810 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.06 seconds
2021-11-24 03:42:51.264266 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:42:51.443601 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:42:51.456638 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:42:51.457040 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:42:51.457270 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:42:52.300275 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.84 seconds
2021-11-24 03:42:52.303837 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:42:52.468778 (MainThread): 11:42:52 | Concurrency: 1 threads (target='dev')
2021-11-24 03:42:52.469277 (MainThread): 11:42:52 | 
2021-11-24 03:42:52.471368 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:52.472050 (Thread-1): 11:42:52 | 1 of 2 START view model dbt.my_first_dbt_model....................... [RUN]
2021-11-24 03:42:52.472618 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:52.472949 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:52.477270 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:42:52.480177 (Thread-1): finished collecting timing info
2021-11-24 03:42:52.515152 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" because it is of type table
2021-11-24 03:42:52.519536 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:52.519713 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */
drop table if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-11-24 03:42:52.519829 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:42:53.097036 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-11-24 03:42:53.109792 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:42:53.111599 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:53.111833 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */

  create or replace  view analytics.dbt.my_first_dbt_model  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-24 03:42:53.318153 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-11-24 03:42:53.332024 (Thread-1): finished collecting timing info
2021-11-24 03:42:53.332364 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:42:53.507077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb98a30>]}
2021-11-24 03:42:53.507994 (Thread-1): 11:42:53 | 1 of 2 OK created view model dbt.my_first_dbt_model.................. [SUCCESS 1 in 1.03s]
2021-11-24 03:42:53.508427 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:53.509314 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:53.509865 (Thread-1): 11:42:53 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-11-24 03:42:53.510468 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:53.510729 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:53.515948 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:42:53.516843 (Thread-1): finished collecting timing info
2021-11-24 03:42:53.519586 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:42:53.521716 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:53.522039 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-11-24 03:42:53.522252 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:42:54.311133 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-11-24 03:42:54.314643 (Thread-1): finished collecting timing info
2021-11-24 03:42:54.315088 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:42:54.488554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb9c4f0>]}
2021-11-24 03:42:54.489464 (Thread-1): 11:42:54 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 0.98s]
2021-11-24 03:42:54.489875 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:54.492271 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:42:54.492940 (MainThread): 11:42:54 | 
2021-11-24 03:42:54.493241 (MainThread): 11:42:54 | Finished running 2 view models in 4.30s.
2021-11-24 03:42:54.493496 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:42:54.493699 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:42:54.500985 (MainThread): 
2021-11-24 03:42:54.501301 (MainThread): Completed successfully
2021-11-24 03:42:54.501565 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:42:54.501996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd8767c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f9cb1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb59a60>]}
2021-11-24 03:42:54.502365 (MainThread): Flushing usage events
2021-11-24 03:44:32.314060 (MainThread): Running with dbt=0.21.0
2021-11-24 03:44:33.157256 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:44:33.158550 (MainThread): Tracking: tracking
2021-11-24 03:44:33.159080 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0064bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008605970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008605a30>]}
2021-11-24 03:44:33.169798 (MainThread): Partial parsing not enabled
2021-11-24 03:44:33.179097 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:44:33.182397 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:44:33.217008 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:44:33.220693 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:44:33.224973 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:44:33.226204 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:44:33.229092 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:44:33.237069 (MainThread): Parsing macros/core.sql
2021-11-24 03:44:33.240430 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:44:33.246507 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:44:33.255405 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:44:33.257099 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:44:33.274434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:44:33.305841 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:44:33.326958 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:44:33.328577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:44:33.338115 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:44:33.355812 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:44:33.367811 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:44:33.401583 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:44:33.412285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:44:33.416941 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:44:33.418570 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:44:33.419618 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:44:33.421177 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:44:33.429372 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:44:33.430977 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:44:33.433245 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:44:33.434648 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:44:33.486252 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:44:33.487842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:44:33.488906 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:44:33.490403 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:44:33.702353 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:33.712436 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:33.747208 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0064b8490>]}
2021-11-24 03:44:33.750801 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0086cdfa0>]}
2021-11-24 03:44:33.751126 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:44:33.752208 (MainThread): 
2021-11-24 03:44:33.752699 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:44:33.753534 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:44:33.765051 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:44:33.765230 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:44:33.765337 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:44:34.622051 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-11-24 03:44:34.625404 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:44:34.780041 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:44:34.791931 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:44:34.792224 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:44:34.792435 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:44:35.539559 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.75 seconds
2021-11-24 03:44:35.543057 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:44:35.716545 (MainThread): 11:44:35 | Concurrency: 1 threads (target='dev')
2021-11-24 03:44:35.717063 (MainThread): 11:44:35 | 
2021-11-24 03:44:35.719221 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:35.719821 (Thread-1): 11:44:35 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:44:35.720413 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:35.720703 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:35.723295 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:44:35.724126 (Thread-1): finished collecting timing info
2021-11-24 03:44:35.745433 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" because it is of type view
2021-11-24 03:44:35.751534 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:35.751789 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-11-24 03:44:35.751958 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:44:36.311020 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-11-24 03:44:36.331461 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:44:36.332839 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:36.333046 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:44:37.530651 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-11-24 03:44:37.552034 (Thread-1): finished collecting timing info
2021-11-24 03:44:37.552362 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:44:37.711716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008bac8b0>]}
2021-11-24 03:44:37.712620 (Thread-1): 11:44:37 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.99s]
2021-11-24 03:44:37.713055 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:37.713945 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:37.714784 (Thread-1): 11:44:37 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:44:37.715835 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:37.716158 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:37.719871 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:44:37.720680 (Thread-1): finished collecting timing info
2021-11-24 03:44:37.723193 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" because it is of type view
2021-11-24 03:44:37.725371 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:37.725605 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" cascade
2021-11-24 03:44:37.725802 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:44:38.305972 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-11-24 03:44:38.309096 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:44:38.310891 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:38.311218 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:44:39.169135 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-11-24 03:44:39.172536 (Thread-1): finished collecting timing info
2021-11-24 03:44:39.172984 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:44:39.332051 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008bac3d0>]}
2021-11-24 03:44:39.332972 (Thread-1): 11:44:39 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.62s]
2021-11-24 03:44:39.333403 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:39.335581 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:44:39.336282 (MainThread): 11:44:39 | 
2021-11-24 03:44:39.336586 (MainThread): 11:44:39 | Finished running 2 table models in 5.58s.
2021-11-24 03:44:39.336846 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:44:39.337058 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:44:39.344363 (MainThread): 
2021-11-24 03:44:39.344685 (MainThread): Completed successfully
2021-11-24 03:44:39.344967 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:44:39.345305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0086ec340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008621910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008650820>]}
2021-11-24 03:44:39.345671 (MainThread): Flushing usage events
2021-11-24 03:54:35.795684 (MainThread): Running with dbt=0.21.0
2021-11-24 03:54:36.599745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:54:36.601182 (MainThread): Tracking: tracking
2021-11-24 03:54:36.601739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f9cabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbf05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbf059d0>]}
2021-11-24 03:54:36.612884 (MainThread): Partial parsing not enabled
2021-11-24 03:54:36.622836 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:54:36.626124 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:54:36.661185 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:54:36.664860 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:54:36.668990 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:54:36.670218 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:54:36.673072 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:54:36.681259 (MainThread): Parsing macros/core.sql
2021-11-24 03:54:36.684635 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:54:36.690937 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:54:36.700183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:54:36.702359 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:54:36.719070 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:54:36.750238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:54:36.770849 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:54:36.772398 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:54:36.780548 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:54:36.797385 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:54:36.809012 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:54:36.815387 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:54:36.821687 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:54:36.824880 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:54:36.826046 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:54:36.826789 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:54:36.827954 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:54:36.834740 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:54:36.836119 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:54:36.838200 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:54:36.839534 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:54:36.889546 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:54:36.891141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:54:36.892397 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:54:36.893631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:54:37.109321 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:37.118824 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:37.121619 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:37.162652 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc8199a0>]}
2021-11-24 03:54:37.166541 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc8199d0>]}
2021-11-24 03:54:37.166873 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:54:37.167880 (MainThread): 
2021-11-24 03:54:37.168235 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:54:37.168970 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:54:37.180187 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:54:37.180367 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:54:37.180480 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:54:38.159330 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.98 seconds
2021-11-24 03:54:38.162582 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:54:38.325465 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:54:38.338124 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:54:38.338436 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:54:38.338654 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:54:38.889415 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.55 seconds
2021-11-24 03:54:38.893217 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:54:39.053930 (MainThread): 11:54:39 | Concurrency: 1 threads (target='dev')
2021-11-24 03:54:39.054451 (MainThread): 11:54:39 | 
2021-11-24 03:54:39.057129 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:54:39.057777 (Thread-1): 11:54:39 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:54:39.058391 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:39.058707 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:54:39.064087 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:54:39.064826 (Thread-1): finished collecting timing info
2021-11-24 03:54:39.111371 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:54:39.112227 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:39.112368 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */


      create or replace transient table analytics.dbt.dates  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


      );
2021-11-24 03:54:39.112479 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:41.506324 (Thread-1): SQL status: SUCCESS 1 in 2.39 seconds
2021-11-24 03:54:41.525708 (Thread-1): finished collecting timing info
2021-11-24 03:54:41.526026 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:54:41.686096 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcbbb220>]}
2021-11-24 03:54:41.687001 (Thread-1): 11:54:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.63s]
2021-11-24 03:54:41.687432 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:54:41.687843 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:41.688359 (Thread-1): 11:54:41 | 2 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:54:41.689264 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:41.689622 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:41.692327 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:54:41.693173 (Thread-1): finished collecting timing info
2021-11-24 03:54:41.706171 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:54:41.707537 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:41.707746 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:54:41.707946 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:43.759666 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2021-11-24 03:54:43.763130 (Thread-1): finished collecting timing info
2021-11-24 03:54:43.763595 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:54:43.923228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcbedac0>]}
2021-11-24 03:54:43.924145 (Thread-1): 11:54:43 | 2 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.23s]
2021-11-24 03:54:43.924571 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:43.925470 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:43.926029 (Thread-1): 11:54:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:54:43.927006 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:43.927339 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:43.931071 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:54:43.932156 (Thread-1): finished collecting timing info
2021-11-24 03:54:43.935370 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:54:43.936570 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:43.936797 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:54:43.937000 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:45.295460 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-11-24 03:54:45.298917 (Thread-1): finished collecting timing info
2021-11-24 03:54:45.299381 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:54:45.469998 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcc1da00>]}
2021-11-24 03:54:45.470917 (Thread-1): 11:54:45 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.54s]
2021-11-24 03:54:45.471352 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:45.473400 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:54:45.474074 (MainThread): 11:54:45 | 
2021-11-24 03:54:45.474386 (MainThread): 11:54:45 | Finished running 1 incremental model, 2 table models in 8.31s.
2021-11-24 03:54:45.474647 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:54:45.474855 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:54:45.481645 (MainThread): 
2021-11-24 03:54:45.481949 (MainThread): Completed successfully
2021-11-24 03:54:45.482197 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-24 03:54:45.482510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc819b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbfcc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcb46910>]}
2021-11-24 03:54:45.482863 (MainThread): Flushing usage events
2021-11-24 03:55:36.060045 (MainThread): Running with dbt=0.21.0
2021-11-24 03:55:36.852645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:55:36.854288 (MainThread): Tracking: tracking
2021-11-24 03:55:36.854769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb134cee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15809a60>]}
2021-11-24 03:55:36.865400 (MainThread): Partial parsing not enabled
2021-11-24 03:55:36.874594 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:55:36.877703 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:55:36.912889 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:55:36.916540 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:55:36.920687 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:55:36.922010 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:55:36.924914 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:55:36.932905 (MainThread): Parsing macros/core.sql
2021-11-24 03:55:36.936317 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:55:36.942471 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:55:36.951473 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:55:36.953985 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:55:36.972002 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:55:37.004628 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:55:37.026878 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:55:37.028539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:55:37.038169 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:55:37.055729 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:55:37.067644 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:55:37.074100 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:55:37.079936 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:55:37.082956 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:55:37.084106 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:55:37.084851 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:55:37.086029 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:55:37.093411 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:55:37.094839 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:55:37.096733 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:55:37.097970 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:55:37.145307 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:55:37.146746 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:55:37.147696 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:55:37.148741 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:55:37.356825 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:37.366379 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:37.369229 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:37.409477 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15827970>]}
2021-11-24 03:55:37.413173 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158279d0>]}
2021-11-24 03:55:37.413671 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:55:37.414913 (MainThread): 
2021-11-24 03:55:37.415335 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:55:37.416231 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:55:37.427155 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:55:37.427327 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:55:37.427436 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:55:38.347682 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.92 seconds
2021-11-24 03:55:38.350992 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:55:38.514644 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:55:38.526415 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:55:38.526710 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:55:38.526925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:55:39.096996 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.57 seconds
2021-11-24 03:55:39.100602 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:55:39.271250 (MainThread): 11:55:39 | Concurrency: 1 threads (target='dev')
2021-11-24 03:55:39.271794 (MainThread): 11:55:39 | 
2021-11-24 03:55:39.273772 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:55:39.274502 (Thread-1): 11:55:39 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:55:39.275074 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:39.275357 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:55:39.284314 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:55:39.285125 (Thread-1): finished collecting timing info
2021-11-24 03:55:39.328702 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:39.328912 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 03:55:39.329036 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:40.431184 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-11-24 03:55:40.448709 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.448987 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 03:55:40.572750 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-24 03:55:40.581893 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.582203 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 03:55:40.689889 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:55:40.705601 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.705883 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 03:55:40.817789 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:55:40.854081 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:55:40.856599 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.856767 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 03:55:40.991512 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-24 03:55:40.992248 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.992513 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 03:55:41.511082 (Thread-1): SQL status: SUCCESS 0 in 0.52 seconds
2021-11-24 03:55:41.511605 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:41.511916 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 03:55:41.679693 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-24 03:55:41.698699 (Thread-1): finished collecting timing info
2021-11-24 03:55:41.699076 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:55:41.868771 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15bae550>]}
2021-11-24 03:55:41.869690 (Thread-1): 11:55:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.59s]
2021-11-24 03:55:41.870120 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:55:41.870528 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:41.871048 (Thread-1): 11:55:41 | 2 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:55:41.871757 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:41.872095 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:41.874646 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:55:41.875635 (Thread-1): finished collecting timing info
2021-11-24 03:55:41.889632 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:55:41.891031 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:41.891269 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:55:41.891451 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:43.150812 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-11-24 03:55:43.154192 (Thread-1): finished collecting timing info
2021-11-24 03:55:43.154646 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:55:43.332259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15bae520>]}
2021-11-24 03:55:43.333179 (Thread-1): 11:55:43 | 2 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.46s]
2021-11-24 03:55:43.333597 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:43.334484 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:43.335040 (Thread-1): 11:55:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:55:43.336018 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:43.336490 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:43.340403 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:55:43.341257 (Thread-1): finished collecting timing info
2021-11-24 03:55:43.344567 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:55:43.345805 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:43.346031 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:55:43.346230 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:44.892307 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-11-24 03:55:44.895788 (Thread-1): finished collecting timing info
2021-11-24 03:55:44.896234 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:55:45.069944 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15cbcc10>]}
2021-11-24 03:55:45.070889 (Thread-1): 11:55:45 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.73s]
2021-11-24 03:55:45.071318 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:45.073561 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:55:45.074229 (MainThread): 11:55:45 | 
2021-11-24 03:55:45.074533 (MainThread): 11:55:45 | Finished running 1 incremental model, 2 table models in 7.66s.
2021-11-24 03:55:45.074790 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:55:45.074998 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:55:45.081884 (MainThread): 
2021-11-24 03:55:45.082195 (MainThread): Completed successfully
2021-11-24 03:55:45.082445 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-24 03:55:45.082753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1593a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158a4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15cc8f10>]}
2021-11-24 03:55:45.083107 (MainThread): Flushing usage events
2021-11-24 03:59:05.303603 (MainThread): Running with dbt=0.21.0
2021-11-24 03:59:06.121363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:59:06.122567 (MainThread): Tracking: tracking
2021-11-24 03:59:06.123143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfacebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfcf07970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfcf07a00>]}
2021-11-24 03:59:06.134262 (MainThread): Partial parsing not enabled
2021-11-24 03:59:06.143353 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:59:06.146377 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:59:06.180227 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:59:06.183825 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:59:06.187900 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:59:06.189114 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:59:06.191934 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:59:06.199977 (MainThread): Parsing macros/core.sql
2021-11-24 03:59:06.202886 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:59:06.208102 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:59:06.215642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:59:06.216933 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:59:06.232377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:59:06.264377 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:59:06.285129 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:59:06.286544 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:59:06.297375 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:59:06.316704 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:59:06.329550 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:59:06.336897 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:59:06.343675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:59:06.347111 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:59:06.348449 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:59:06.349289 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:59:06.350622 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:59:06.358368 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:59:06.359754 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:59:06.361618 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:59:06.362851 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:59:06.410444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:59:06.411827 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:59:06.412757 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:59:06.413785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:59:06.621277 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:59:06.632889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:06.636097 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:06.679902 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd1051c0>]}
2021-11-24 03:59:06.683545 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd1054f0>]}
2021-11-24 03:59:06.683870 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:59:06.684825 (MainThread): 
2021-11-24 03:59:06.685236 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:59:06.686033 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:59:06.696739 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:59:06.696912 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:59:06.697015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:59:07.549585 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2021-11-24 03:59:07.552942 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:59:07.713771 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:59:07.725683 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:59:07.725984 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:59:07.726204 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:59:08.496978 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.77 seconds
2021-11-24 03:59:08.500463 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:59:08.665020 (MainThread): 11:59:08 | Concurrency: 1 threads (target='dev')
2021-11-24 03:59:08.665530 (MainThread): 11:59:08 | 
2021-11-24 03:59:08.667498 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:59:08.668157 (Thread-1): 11:59:08 | 1 of 2 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:59:08.668734 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:08.669024 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:59:08.677886 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:59:08.678682 (Thread-1): finished collecting timing info
2021-11-24 03:59:08.722000 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:08.722290 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 03:59:08.722438 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:59:10.817280 (Thread-1): SQL status: SUCCESS 1 in 2.09 seconds
2021-11-24 03:59:10.834899 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:10.835197 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 03:59:10.946225 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:59:10.955586 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:10.955884 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 03:59:11.055844 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-24 03:59:11.071527 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.071807 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 03:59:11.165764 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-24 03:59:11.201814 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:59:11.204539 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.204722 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 03:59:11.331356 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-24 03:59:11.332436 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.332881 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 03:59:11.718460 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-11-24 03:59:11.719193 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.719636 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 03:59:11.905867 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-24 03:59:11.924644 (Thread-1): finished collecting timing info
2021-11-24 03:59:11.925008 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:59:12.096672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd3b1610>]}
2021-11-24 03:59:12.097558 (Thread-1): 11:59:12 | 1 of 2 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.43s]
2021-11-24 03:59:12.097964 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:59:12.098350 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.099012 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:59:12.099348 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.103593 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:59:12.104479 (Thread-1): finished collecting timing info
2021-11-24 03:59:12.105119 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.106000 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:12.106616 (Thread-1): 11:59:12 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:59:12.107099 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:12.107323 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:12.119449 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:59:12.120038 (Thread-1): finished collecting timing info
2021-11-24 03:59:12.129299 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:59:12.130517 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:12.130685 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models

select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-11-24 03:59:12.130814 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:59:13.282227 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-11-24 03:59:13.284712 (Thread-1): finished collecting timing info
2021-11-24 03:59:13.285076 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:59:13.458823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd3df760>]}
2021-11-24 03:59:13.459713 (Thread-1): 11:59:13 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.35s]
2021-11-24 03:59:13.460137 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:13.462381 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:59:13.462986 (MainThread): 11:59:13 | 
2021-11-24 03:59:13.463280 (MainThread): 11:59:13 | Finished running 1 incremental model, 1 table model in 6.78s.
2021-11-24 03:59:13.463533 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:59:13.463732 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:59:13.472020 (MainThread): 
2021-11-24 03:59:13.472340 (MainThread): Completed successfully
2021-11-24 03:59:13.472589 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:59:13.473012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd34e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd662880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd662940>]}
2021-11-24 03:59:13.473386 (MainThread): Flushing usage events
2021-11-24 04:00:15.435926 (MainThread): Running with dbt=0.21.0
2021-11-24 04:00:16.241283 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 04:00:16.242538 (MainThread): Tracking: tracking
2021-11-24 04:00:16.243069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ceba1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1703940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d17039d0>]}
2021-11-24 04:00:16.254129 (MainThread): Partial parsing not enabled
2021-11-24 04:00:16.263359 (MainThread): Parsing macros/catalog.sql
2021-11-24 04:00:16.266432 (MainThread): Parsing macros/adapters.sql
2021-11-24 04:00:16.300927 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 04:00:16.304500 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 04:00:16.308585 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 04:00:16.309802 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 04:00:16.312663 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 04:00:16.319979 (MainThread): Parsing macros/core.sql
2021-11-24 04:00:16.322896 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 04:00:16.328134 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 04:00:16.336344 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 04:00:16.337658 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 04:00:16.353712 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 04:00:16.385038 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 04:00:16.404902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 04:00:16.406776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 04:00:16.414961 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 04:00:16.431081 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 04:00:16.442193 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 04:00:16.448556 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 04:00:16.454443 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 04:00:16.457436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 04:00:16.458580 (MainThread): Parsing macros/etc/query.sql
2021-11-24 04:00:16.459307 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 04:00:16.460489 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 04:00:16.467225 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 04:00:16.468626 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 04:00:16.470489 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 04:00:16.471722 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 04:00:16.525348 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 04:00:16.526933 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 04:00:16.528038 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 04:00:16.529240 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 04:00:16.740288 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 04:00:16.752009 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:16.755278 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:16.794184 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d191b7c0>]}
2021-11-24 04:00:16.798220 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d191b9a0>]}
2021-11-24 04:00:16.798549 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 04:00:16.799499 (MainThread): 
2021-11-24 04:00:16.799922 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 04:00:16.800921 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 04:00:16.813808 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 04:00:16.813978 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 04:00:16.814086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 04:00:17.675898 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-11-24 04:00:17.680738 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 04:00:17.856503 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 04:00:17.868216 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 04:00:17.868512 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 04:00:17.868736 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 04:00:18.426581 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-24 04:00:18.430099 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 04:00:18.604933 (MainThread): 12:00:18 | Concurrency: 1 threads (target='dev')
2021-11-24 04:00:18.605456 (MainThread): 12:00:18 | 
2021-11-24 04:00:18.607420 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 04:00:18.608110 (Thread-1): 12:00:18 | 1 of 2 START incremental model dbt.dates............................. [RUN]
2021-11-24 04:00:18.608680 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:18.608967 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 04:00:18.617694 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 04:00:18.618486 (Thread-1): finished collecting timing info
2021-11-24 04:00:18.662298 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:18.662507 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 04:00:18.662630 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 04:00:20.448809 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-11-24 04:00:20.468751 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.469056 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 04:00:20.584624 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-24 04:00:20.593512 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.593896 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 04:00:20.685366 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-24 04:00:20.700734 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.701014 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 04:00:20.802308 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-24 04:00:20.837111 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 04:00:20.839384 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.839530 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 04:00:20.954764 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-24 04:00:20.955846 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.956302 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 04:00:21.472914 (Thread-1): SQL status: SUCCESS 0 in 0.52 seconds
2021-11-24 04:00:21.473685 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:21.474134 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 04:00:21.719339 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-11-24 04:00:21.738055 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.738416 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 04:00:21.916734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1d2a160>]}
2021-11-24 04:00:21.917641 (Thread-1): 12:00:21 | 1 of 2 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.31s]
2021-11-24 04:00:21.918069 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 04:00:21.918481 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.919152 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 04:00:21.919491 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.923711 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 04:00:21.924568 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.925182 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.926075 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:21.926696 (Thread-1): 12:00:21 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 04:00:21.927193 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:21.927421 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:21.939415 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 04:00:21.940005 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.949318 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 04:00:21.950461 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:21.950615 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models

select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-11-24 04:00:21.950745 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 04:00:23.213560 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-11-24 04:00:23.216977 (Thread-1): finished collecting timing info
2021-11-24 04:00:23.217421 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 04:00:23.387752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1d2a4c0>]}
2021-11-24 04:00:23.388683 (Thread-1): 12:00:23 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.46s]
2021-11-24 04:00:23.389117 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:23.391328 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 04:00:23.391964 (MainThread): 12:00:23 | 
2021-11-24 04:00:23.392266 (MainThread): 12:00:23 | Finished running 1 incremental model, 1 table model in 6.59s.
2021-11-24 04:00:23.392527 (MainThread): Connection 'master' was properly closed.
2021-11-24 04:00:23.392736 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 04:00:23.400929 (MainThread): 
2021-11-24 04:00:23.401251 (MainThread): Completed successfully
2021-11-24 04:00:23.401495 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 04:00:23.401803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea64c0>]}
2021-11-24 04:00:23.402148 (MainThread): Flushing usage events
2021-11-29 01:57:50.677170 (MainThread): Running with dbt=0.21.0
2021-11-29 01:57:53.089867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 01:57:53.092176 (MainThread): Tracking: tracking
2021-11-29 01:57:53.092782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1bcabb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e602970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e602a00>]}
2021-11-29 01:57:53.105896 (MainThread): Partial parsing not enabled
2021-11-29 01:57:53.130760 (MainThread): Parsing macros/catalog.sql
2021-11-29 01:57:53.134524 (MainThread): Parsing macros/adapters.sql
2021-11-29 01:57:53.173498 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 01:57:53.177119 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 01:57:53.181278 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 01:57:53.182506 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 01:57:53.185347 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 01:57:53.195075 (MainThread): Parsing macros/core.sql
2021-11-29 01:57:53.199106 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 01:57:53.206134 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 01:57:53.216546 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 01:57:53.218162 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 01:57:53.235926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 01:57:53.268708 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 01:57:53.292144 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 01:57:53.293932 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 01:57:53.304911 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 01:57:53.324682 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 01:57:53.339714 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 01:57:53.347845 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 01:57:53.355020 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 01:57:53.358670 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 01:57:53.360816 (MainThread): Parsing macros/etc/query.sql
2021-11-29 01:57:53.361770 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 01:57:53.363144 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 01:57:53.372045 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 01:57:53.373928 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 01:57:53.376190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 01:57:53.377625 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 01:57:53.433673 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 01:57:53.435309 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 01:57:53.436849 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 01:57:53.438747 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 01:57:53.651473 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:57:53.661725 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:57:53.664524 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:53.704534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e8095e0>]}
2021-11-29 01:57:53.708983 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e809610>]}
2021-11-29 01:57:53.709327 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 01:57:53.710292 (MainThread): 
2021-11-29 01:57:53.710710 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:57:53.711680 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:57:53.721880 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:57:53.722038 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:57:53.722142 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 01:57:55.008904 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.29 seconds
2021-11-29 01:57:55.012243 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:57:55.180653 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 01:57:55.191906 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 01:57:55.192185 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 01:57:55.192474 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:57:55.956083 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.76 seconds
2021-11-29 01:57:55.960074 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 01:57:56.129027 (MainThread): 09:57:56 | Concurrency: 1 threads (target='dev')
2021-11-29 01:57:56.129557 (MainThread): 09:57:56 | 
2021-11-29 01:57:56.132059 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 01:57:56.132788 (Thread-1): 09:57:56 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 01:57:56.133533 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:56.133893 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 01:57:56.143349 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:57:56.146622 (Thread-1): finished collecting timing info
2021-11-29 01:57:56.201172 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:56.201400 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 01:57:56.201570 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:57:58.453786 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2021-11-29 01:57:58.471324 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.471610 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 01:57:58.578174 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:57:58.587440 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.587756 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 01:57:58.686093 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 01:57:58.693540 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.693754 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 01:57:58.786867 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 01:57:58.816312 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:57:58.818812 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.818978 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 01:57:58.982473 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-11-29 01:57:58.983554 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.984023 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 01:57:59.938989 (Thread-1): SQL status: SUCCESS 5 in 0.95 seconds
2021-11-29 01:57:59.939731 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:59.940042 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 01:58:00.257146 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-11-29 01:58:00.283044 (Thread-1): finished collecting timing info
2021-11-29 01:58:00.283366 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 01:58:00.459539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1edf3370>]}
2021-11-29 01:58:00.460301 (Thread-1): 09:58:00 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.33s]
2021-11-29 01:58:00.460732 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 01:58:00.461343 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:00.462453 (Thread-1): 09:58:00 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 01:58:00.463467 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:58:00.464011 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:00.470054 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:58:00.471209 (Thread-1): finished collecting timing info
2021-11-29 01:58:00.485424 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:58:00.486824 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:58:00.487033 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 01:58:00.487214 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:58:01.627666 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-11-29 01:58:01.631387 (Thread-1): finished collecting timing info
2021-11-29 01:58:01.631908 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 01:58:01.801494 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ee59c70>]}
2021-11-29 01:58:01.802419 (Thread-1): 09:58:01 | 2 of 3 OK created table model dbt.first_model........................ [SUCCESS 1 in 1.34s]
2021-11-29 01:58:01.802855 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:01.804645 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:01.805472 (Thread-1): 09:58:01 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 01:58:01.806130 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:58:01.806427 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:01.810707 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:58:01.811664 (Thread-1): finished collecting timing info
2021-11-29 01:58:01.814815 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:58:01.816174 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:58:01.816409 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model
where id = 1
      );
2021-11-29 01:58:01.816621 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:58:03.472868 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-11-29 01:58:03.476273 (Thread-1): finished collecting timing info
2021-11-29 01:58:03.476751 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 01:58:03.864584 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ef9bd00>]}
2021-11-29 01:58:03.865558 (Thread-1): 09:58:03 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.06s]
2021-11-29 01:58:03.866000 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:03.868171 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:58:03.868871 (MainThread): 09:58:03 | 
2021-11-29 01:58:03.869221 (MainThread): 09:58:03 | Finished running 1 incremental model, 2 table models in 10.16s.
2021-11-29 01:58:03.869503 (MainThread): Connection 'master' was properly closed.
2021-11-29 01:58:03.869730 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 01:58:03.877260 (MainThread): 
2021-11-29 01:58:03.877622 (MainThread): Completed successfully
2021-11-29 01:58:03.877895 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 01:58:03.878237 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e618820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e846250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ef9bd60>]}
2021-11-29 01:58:03.878619 (MainThread): Flushing usage events
2021-11-29 01:59:31.947508 (MainThread): Running with dbt=0.21.0
2021-11-29 01:59:33.083278 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 01:59:33.084729 (MainThread): Tracking: tracking
2021-11-29 01:59:33.085268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ce4a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d07029a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0702a30>]}
2021-11-29 01:59:33.097855 (MainThread): Partial parsing not enabled
2021-11-29 01:59:33.109032 (MainThread): Parsing macros/catalog.sql
2021-11-29 01:59:33.112484 (MainThread): Parsing macros/adapters.sql
2021-11-29 01:59:33.149208 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 01:59:33.153325 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 01:59:33.158370 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 01:59:33.159828 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 01:59:33.163118 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 01:59:33.171664 (MainThread): Parsing macros/core.sql
2021-11-29 01:59:33.176114 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 01:59:33.183558 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 01:59:33.193644 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 01:59:33.195261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 01:59:33.212913 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 01:59:33.245814 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 01:59:33.267284 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 01:59:33.268976 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 01:59:33.279867 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 01:59:33.299114 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 01:59:33.312185 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 01:59:33.319813 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 01:59:33.326656 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 01:59:33.330185 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 01:59:33.331571 (MainThread): Parsing macros/etc/query.sql
2021-11-29 01:59:33.332386 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 01:59:33.333565 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 01:59:33.343726 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 01:59:33.345551 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 01:59:33.347484 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 01:59:33.348715 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 01:59:33.399518 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 01:59:33.401271 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 01:59:33.402582 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 01:59:33.404268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 01:59:33.642889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:33.656093 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:33.660680 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:33.705250 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d760>]}
2021-11-29 01:59:33.709540 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d9a0>]}
2021-11-29 01:59:33.709826 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 01:59:33.710854 (MainThread): 
2021-11-29 01:59:33.711401 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:59:33.712329 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:59:33.726200 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:59:33.726397 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:59:33.726582 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 01:59:34.662444 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2021-11-29 01:59:34.665151 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:59:34.845467 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:59:34.849364 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:59:34.849685 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:59:34.849944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 01:59:35.554034 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.70 seconds
2021-11-29 01:59:35.557430 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:59:35.729879 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.730472 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.730840 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_dbt_dev"
2021-11-29 01:59:35.738056 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.738316 (ThreadPoolExecutor-0_0): On create_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt_dbt_dev"} */
create schema if not exists analytics.dbt_dbt_dev
2021-11-29 01:59:35.738539 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 01:59:36.323908 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.59 seconds
2021-11-29 01:59:36.325785 (ThreadPoolExecutor-0_0): On create_analytics_dbt_dbt_dev: Close
2021-11-29 01:59:36.511049 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 01:59:36.523296 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 01:59:36.523754 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 01:59:36.524270 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:59:37.071214 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.55 seconds
2021-11-29 01:59:37.073905 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 01:59:37.234502 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 01:59:37.237561 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 01:59:37.237872 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 01:59:37.238126 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:59:37.792977 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.55 seconds
2021-11-29 01:59:37.809373 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 01:59:37.977333 (MainThread): 09:59:37 | Concurrency: 1 threads (target='dev')
2021-11-29 01:59:37.977764 (MainThread): 09:59:37 | 
2021-11-29 01:59:37.979215 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 01:59:37.979682 (Thread-1): 09:59:37 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 01:59:37.980161 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:37.980401 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 01:59:37.988587 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:59:37.989358 (Thread-1): finished collecting timing info
2021-11-29 01:59:38.034302 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:38.034510 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 01:59:38.034640 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:40.241111 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2021-11-29 01:59:40.259256 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.259646 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 01:59:40.370722 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:59:40.378780 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.379052 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 01:59:40.486859 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:59:40.500353 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.500612 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 01:59:40.604279 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 01:59:40.640284 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:59:40.642869 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.643030 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 01:59:40.780336 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 01:59:40.781098 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.781424 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 01:59:41.424816 (Thread-1): SQL status: SUCCESS 0 in 0.64 seconds
2021-11-29 01:59:41.425353 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:41.425663 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 01:59:41.623238 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 01:59:41.641506 (Thread-1): finished collecting timing info
2021-11-29 01:59:41.642008 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 01:59:41.822579 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c1cdf0>]}
2021-11-29 01:59:41.823456 (Thread-1): 09:59:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.84s]
2021-11-29 01:59:41.823776 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 01:59:41.824063 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:41.824419 (Thread-1): 09:59:41 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 01:59:41.824890 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:41.825120 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:41.828752 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:59:41.829602 (Thread-1): finished collecting timing info
2021-11-29 01:59:41.841598 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:59:41.842741 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:41.842922 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_dbt_dev.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 01:59:41.843067 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:43.016768 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-11-29 01:59:43.020411 (Thread-1): finished collecting timing info
2021-11-29 01:59:43.021382 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 01:59:43.185436 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c59fa0>]}
2021-11-29 01:59:43.185969 (Thread-1): 09:59:43 | 2 of 3 OK created table model dbt_dbt_dev.first_model................ [SUCCESS 1 in 1.36s]
2021-11-29 01:59:43.186193 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:43.186969 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:43.187283 (Thread-1): 09:59:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 01:59:43.187618 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:43.187779 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:43.190058 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:59:43.190739 (Thread-1): finished collecting timing info
2021-11-29 01:59:43.192655 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:59:43.193434 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:43.193561 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt_dbt_dev.first_model
where id = 1
      );
2021-11-29 01:59:43.193673 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:44.410816 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-11-29 01:59:44.413966 (Thread-1): finished collecting timing info
2021-11-29 01:59:44.414374 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 01:59:44.570669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c59ac0>]}
2021-11-29 01:59:44.571341 (Thread-1): 09:59:44 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.38s]
2021-11-29 01:59:44.571658 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:44.573274 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:59:44.573899 (MainThread): 09:59:44 | 
2021-11-29 01:59:44.574182 (MainThread): 09:59:44 | Finished running 1 incremental model, 2 table models in 10.86s.
2021-11-29 01:59:44.574458 (MainThread): Connection 'master' was properly closed.
2021-11-29 01:59:44.574826 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 01:59:44.581670 (MainThread): 
2021-11-29 01:59:44.582051 (MainThread): Completed successfully
2021-11-29 01:59:44.582380 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 01:59:44.582842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c0c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d1c0>]}
2021-11-29 01:59:44.583494 (MainThread): Flushing usage events
2021-11-29 02:05:37.484301 (MainThread): Running with dbt=0.21.0
2021-11-29 02:05:38.936691 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:05:38.938850 (MainThread): Tracking: tracking
2021-11-29 02:05:38.939678 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec804acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83701a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83701af0>]}
2021-11-29 02:05:38.952754 (MainThread): Partial parsing not enabled
2021-11-29 02:05:38.966394 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:05:38.969793 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:05:39.009347 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:05:39.013007 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:05:39.018467 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:05:39.019854 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:05:39.022751 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:05:39.031705 (MainThread): Parsing macros/core.sql
2021-11-29 02:05:39.035233 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:05:39.042532 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:05:39.053054 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:05:39.054745 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:05:39.071609 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:05:39.104537 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:05:39.127047 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:05:39.129458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:05:39.139142 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:05:39.160070 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:05:39.174786 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:05:39.182206 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:05:39.189545 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:05:39.193139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:05:39.194484 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:05:39.195561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:05:39.197441 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:05:39.205348 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:05:39.207282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:05:39.210030 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:05:39.211489 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:05:39.268807 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:05:39.270711 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:05:39.271860 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:05:39.273090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:05:39.520846 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:05:39.534688 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:05:39.538321 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:39.583247 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:05:39.587588 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec838057c0>]}
2021-11-29 02:05:39.593467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83805a90>]}
2021-11-29 02:05:39.594041 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:05:39.595266 (MainThread): 
2021-11-29 02:05:39.595639 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:05:39.596444 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:05:39.609032 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:05:39.609236 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:05:39.609366 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:05:40.594233 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.98 seconds
2021-11-29 02:05:40.598639 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:05:40.767506 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:05:40.770850 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:05:40.771216 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:05:40.771643 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 02:05:41.522989 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.75 seconds
2021-11-29 02:05:41.526469 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:05:41.725300 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:05:41.737069 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:05:41.737375 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:05:41.737592 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:05:42.298424 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.56 seconds
2021-11-29 02:05:42.302063 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:05:42.489842 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:05:42.493413 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:05:42.493724 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 02:05:42.493978 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:05:43.038753 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.54 seconds
2021-11-29 02:05:43.042098 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 02:05:43.214844 (MainThread): 10:05:43 | Concurrency: 1 threads (target='dev')
2021-11-29 02:05:43.215274 (MainThread): 10:05:43 | 
2021-11-29 02:05:43.216872 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:05:43.217437 (Thread-1): 10:05:43 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:05:43.218014 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:43.218306 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:05:43.226651 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:05:43.227369 (Thread-1): finished collecting timing info
2021-11-29 02:05:43.270218 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:43.270425 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:05:43.270555 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:05:44.870554 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-11-29 02:05:44.887817 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:44.888109 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:05:44.998876 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:05:45.008597 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.008971 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:05:45.114371 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:05:45.130113 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.130410 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:05:45.234963 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:05:45.270650 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:05:45.275464 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.275679 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:05:45.387587 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-11-29 02:05:45.388667 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.389126 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:05:45.875351 (Thread-1): SQL status: SUCCESS 0 in 0.49 seconds
2021-11-29 02:05:45.876150 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.876484 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:05:46.065222 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:05:46.084074 (Thread-1): finished collecting timing info
2021-11-29 02:05:46.084429 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:05:46.260914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83b04220>]}
2021-11-29 02:05:46.261843 (Thread-1): 10:05:46 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.04s]
2021-11-29 02:05:46.262275 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:05:46.262689 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.263206 (Thread-1): 10:05:46 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 02:05:46.263806 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:05:46.264078 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.279404 (Thread-1): finished collecting timing info
2021-11-29 02:05:46.280229 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.295257 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd2640>]}
2021-11-29 02:05:46.295748 (Thread-1): 10:05:46 | 2 of 3 ERROR creating table model dbt_dbt_dev.first_model............ [ERROR in 0.03s]
2021-11-29 02:05:46.295982 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.296708 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:05:46.297250 (Thread-1): 10:05:46 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:05:46.297547 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:05:46.299162 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:05:46.299723 (MainThread): 10:05:46 | 
2021-11-29 02:05:46.299985 (MainThread): 10:05:46 | Finished running 1 incremental model, 2 table models in 6.70s.
2021-11-29 02:05:46.300188 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:05:46.300362 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:05:46.305868 (MainThread): 
2021-11-29 02:05:46.306126 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:05:46.306306 (MainThread): 
2021-11-29 02:05:46.306473 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.306626 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:05:46.306772 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:05:46.306914 (MainThread):   
2021-11-29 02:05:46.307053 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.307226 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.307368 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:05:46.307584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8383d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd9d60>]}
2021-11-29 02:05:46.307827 (MainThread): Flushing usage events
2021-11-29 02:07:00.901280 (MainThread): Running with dbt=0.21.0
2021-11-29 02:07:01.740646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:07:01.742384 (MainThread): Tracking: tracking
2021-11-29 02:07:01.742912 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc83acfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf05a60>]}
2021-11-29 02:07:01.754093 (MainThread): Partial parsing not enabled
2021-11-29 02:07:01.763845 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:07:01.767099 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:07:01.802760 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:07:01.806339 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:07:01.810491 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:07:01.811732 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:07:01.814580 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:07:01.822502 (MainThread): Parsing macros/core.sql
2021-11-29 02:07:01.825937 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:07:01.832070 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:07:01.841075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:07:01.843362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:07:01.859337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:07:01.888926 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:07:01.911785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:07:01.913806 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:07:01.923358 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:07:01.941864 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:07:01.954870 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:07:01.962187 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:07:01.968565 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:07:01.971585 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:07:01.972756 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:07:01.973659 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:07:01.975906 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:07:01.982966 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:07:01.984672 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:07:01.986551 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:07:01.987799 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:07:02.038614 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:07:02.040230 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:07:02.041305 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:07:02.042491 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:07:02.253543 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:07:02.264818 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:07:02.267733 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:02.309567 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:07:02.313968 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb009190>]}
2021-11-29 02:07:02.319252 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb0097f0>]}
2021-11-29 02:07:02.319964 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:07:02.321101 (MainThread): 
2021-11-29 02:07:02.321464 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:07:02.322329 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:07:02.333724 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:07:02.333900 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:07:02.334020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:07:03.188641 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.85 seconds
2021-11-29 02:07:03.192000 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:07:03.356977 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:07:03.360822 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:07:03.361132 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:07:03.361401 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 02:07:03.924422 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.56 seconds
2021-11-29 02:07:03.927848 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:07:04.116005 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:07:04.127838 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:07:04.128133 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 02:07:04.128348 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:07:04.876512 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.75 seconds
2021-11-29 02:07:04.879973 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 02:07:05.043839 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:07:05.047402 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:07:05.047707 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:07:05.047951 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:07:05.595201 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.55 seconds
2021-11-29 02:07:05.596445 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:07:05.762143 (MainThread): 10:07:05 | Concurrency: 1 threads (target='dev')
2021-11-29 02:07:05.762657 (MainThread): 10:07:05 | 
2021-11-29 02:07:05.764581 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:07:05.765243 (Thread-1): 10:07:05 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:07:05.765812 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:05.766089 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:07:05.774920 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:07:05.775706 (Thread-1): finished collecting timing info
2021-11-29 02:07:05.819889 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:05.820092 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:07:05.820220 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:07:07.432869 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-11-29 02:07:07.450475 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.450774 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:07:07.562183 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:07:07.571570 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.571867 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:07:07.674667 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:07:07.689043 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.689338 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:07:07.790486 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:07:07.827370 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:07:07.830798 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.830978 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:07:07.972471 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 02:07:07.973539 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.973991 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:07:08.543218 (Thread-1): SQL status: SUCCESS 0 in 0.57 seconds
2021-11-29 02:07:08.543859 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:08.544175 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:07:08.737298 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:07:08.756294 (Thread-1): finished collecting timing info
2021-11-29 02:07:08.756665 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:07:08.931073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb475940>]}
2021-11-29 02:07:08.932432 (Thread-1): 10:07:08 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.17s]
2021-11-29 02:07:08.934617 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:07:08.935510 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.936460 (Thread-1): 10:07:08 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 02:07:08.937541 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:07:08.937955 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.948171 (Thread-1): finished collecting timing info
2021-11-29 02:07:08.949518 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.965102 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb830250>]}
2021-11-29 02:07:08.965835 (Thread-1): 10:07:08 | 2 of 3 ERROR creating table model dbt_dbt_dev.first_model............ [ERROR in 0.03s]
2021-11-29 02:07:08.966176 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.967193 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:07:08.967755 (Thread-1): 10:07:08 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:07:08.968114 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:07:08.969864 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:07:08.970550 (MainThread): 10:07:08 | 
2021-11-29 02:07:08.970817 (MainThread): 10:07:08 | Finished running 1 incremental model, 2 table models in 6.65s.
2021-11-29 02:07:08.971031 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:07:08.971202 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:07:08.978046 (MainThread): 
2021-11-29 02:07:08.978327 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:07:08.978530 (MainThread): 
2021-11-29 02:07:08.978721 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.978894 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:07:08.979055 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:07:08.979211 (MainThread):   
2021-11-29 02:07:08.979506 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.979691 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.979878 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:07:08.980141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb01e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf56220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb52c220>]}
2021-11-29 02:07:08.980444 (MainThread): Flushing usage events
2021-11-29 02:08:14.307842 (MainThread): Running with dbt=0.21.0
2021-11-29 02:08:15.259210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:08:15.260578 (MainThread): Tracking: tracking
2021-11-29 02:08:15.261207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ccebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef049a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef04a30>]}
2021-11-29 02:08:15.274119 (MainThread): Partial parsing not enabled
2021-11-29 02:08:15.285376 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:08:15.289000 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:08:15.326479 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:08:15.330130 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:08:15.334229 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:08:15.335448 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:08:15.338288 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:08:15.346230 (MainThread): Parsing macros/core.sql
2021-11-29 02:08:15.349592 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:08:15.355639 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:08:15.365071 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:08:15.366684 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:08:15.383161 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:08:15.414527 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:08:15.435921 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:08:15.437592 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:08:15.447393 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:08:15.466346 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:08:15.479413 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:08:15.486873 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:08:15.493327 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:08:15.496612 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:08:15.497799 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:08:15.498616 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:08:15.499779 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:08:15.507271 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:08:15.508719 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:08:15.511129 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:08:15.512380 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:08:15.565031 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:08:15.566624 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:08:15.567704 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:08:15.568916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:08:15.804297 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:08:15.816673 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:08:15.820295 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:15.861966 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:08:15.866932 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c6a0>]}
2021-11-29 02:08:15.873042 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c940>]}
2021-11-29 02:08:15.873538 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:08:15.874675 (MainThread): 
2021-11-29 02:08:15.875039 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:08:15.875814 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:08:15.887444 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:08:15.887639 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:08:15.887764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:08:16.768555 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.88 seconds
2021-11-29 02:08:16.770369 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:08:16.933677 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:08:16.940104 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:08:16.940307 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:08:16.940430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:08:17.680501 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.74 seconds
2021-11-29 02:08:17.681788 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:08:17.838154 (MainThread): 10:08:17 | Concurrency: 1 threads (target='dev')
2021-11-29 02:08:17.838386 (MainThread): 10:08:17 | 
2021-11-29 02:08:17.839186 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:08:17.839485 (Thread-1): 10:08:17 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:08:17.839801 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:17.839984 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:08:17.844662 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:08:17.845736 (Thread-1): finished collecting timing info
2021-11-29 02:08:17.882905 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:17.883129 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:08:17.883269 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:08:19.313845 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-11-29 02:08:19.333711 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.334002 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:08:19.459787 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-11-29 02:08:19.469170 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.469477 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:08:19.576728 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:08:19.592894 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.593199 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:08:19.695699 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:08:19.723257 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:08:19.725549 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.725696 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:08:19.851851 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:08:19.852290 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.852449 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:08:20.540793 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-11-29 02:08:20.541042 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:20.541162 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:08:20.724634 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-11-29 02:08:20.733166 (Thread-1): finished collecting timing info
2021-11-29 02:08:20.733391 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:08:20.909814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5fbae1c0>]}
2021-11-29 02:08:20.910236 (Thread-1): 10:08:20 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.07s]
2021-11-29 02:08:20.910414 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:08:20.910574 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.910858 (Thread-1): 10:08:20 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 02:08:20.911128 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:08:20.911258 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.914581 (Thread-1): finished collecting timing info
2021-11-29 02:08:20.914941 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.920683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5fbd3e80>]}
2021-11-29 02:08:20.921030 (Thread-1): 10:08:20 | 2 of 3 ERROR creating table model dbt.first_model.................... [ERROR in 0.01s]
2021-11-29 02:08:20.921193 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.921787 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:08:20.922032 (Thread-1): 10:08:20 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:08:20.922181 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:08:20.922992 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:08:20.923315 (MainThread): 10:08:20 | 
2021-11-29 02:08:20.923460 (MainThread): 10:08:20 | Finished running 1 incremental model, 2 table models in 5.05s.
2021-11-29 02:08:20.923582 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:08:20.923679 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:08:20.927643 (MainThread): 
2021-11-29 02:08:20.927832 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:08:20.927962 (MainThread): 
2021-11-29 02:08:20.928106 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928221 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:08:20.928326 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:08:20.928429 (MainThread):   
2021-11-29 02:08:20.928532 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928635 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928756 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:08:20.928934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef6cbe0>]}
2021-11-29 02:08:20.929144 (MainThread): Flushing usage events
2021-11-29 02:10:20.448691 (MainThread): Running with dbt=0.21.0
2021-11-29 02:10:21.349169 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:10:21.350682 (MainThread): Tracking: tracking
2021-11-29 02:10:21.351310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7774c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77977c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77977c9d0>]}
2021-11-29 02:10:21.362100 (MainThread): Partial parsing not enabled
2021-11-29 02:10:21.371898 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:10:21.375153 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:10:21.409787 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:10:21.413440 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:10:21.417530 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:10:21.418739 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:10:21.421597 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:10:21.429489 (MainThread): Parsing macros/core.sql
2021-11-29 02:10:21.432827 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:10:21.438860 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:10:21.448316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:10:21.450874 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:10:21.466926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:10:21.498660 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:10:21.520286 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:10:21.521923 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:10:21.531174 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:10:21.547597 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:10:21.560598 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:10:21.567116 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:10:21.573266 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:10:21.576520 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:10:21.577754 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:10:21.578538 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:10:21.579767 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:10:21.586915 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:10:21.588400 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:10:21.590438 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:10:21.591760 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:10:21.645010 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:10:21.646602 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:10:21.647668 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:10:21.648847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:10:21.860136 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:10:21.871972 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:10:21.874904 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:21.911010 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:10:21.915132 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d850>]}
2021-11-29 02:10:21.919368 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d9a0>]}
2021-11-29 02:10:21.919640 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:10:21.920542 (MainThread): 
2021-11-29 02:10:21.920974 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:10:21.921810 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:10:21.932892 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:10:21.933077 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:10:21.933202 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:10:22.977316 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.04 seconds
2021-11-29 02:10:22.980770 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:10:23.209531 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:10:23.221335 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:10:23.221642 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:10:23.221871 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:10:24.151068 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.93 seconds
2021-11-29 02:10:24.154160 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:10:24.320054 (MainThread): 10:10:24 | Concurrency: 1 threads (target='dev')
2021-11-29 02:10:24.320579 (MainThread): 10:10:24 | 
2021-11-29 02:10:24.322549 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:10:24.323251 (Thread-1): 10:10:24 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:10:24.323823 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:24.324109 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:10:24.332811 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:10:24.335140 (Thread-1): finished collecting timing info
2021-11-29 02:10:24.389667 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:24.389870 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:10:24.389995 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:10:26.980312 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2021-11-29 02:10:26.997488 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:26.997801 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:10:27.265616 (Thread-1): SQL status: SUCCESS 28 in 0.27 seconds
2021-11-29 02:10:27.279792 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.280367 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:10:27.529959 (Thread-1): SQL status: SUCCESS 28 in 0.25 seconds
2021-11-29 02:10:27.545868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.546194 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:10:27.716939 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-11-29 02:10:27.753391 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:10:27.755957 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.756122 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:10:28.123869 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-11-29 02:10:28.124962 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:28.125359 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:10:28.815934 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-11-29 02:10:28.816474 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:28.816788 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:10:29.018426 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 02:10:29.036435 (Thread-1): finished collecting timing info
2021-11-29 02:10:29.036756 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:10:29.362194 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779bab280>]}
2021-11-29 02:10:29.363118 (Thread-1): 10:10:29 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 5.04s]
2021-11-29 02:10:29.363554 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:10:29.363970 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.364499 (Thread-1): 10:10:29 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 02:10:29.365513 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:10:29.365847 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.373032 (Thread-1): finished collecting timing info
2021-11-29 02:10:29.373902 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.390775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779bab160>]}
2021-11-29 02:10:29.391900 (Thread-1): 10:10:29 | 2 of 3 ERROR creating table model dbt.first_model.................... [ERROR in 0.03s]
2021-11-29 02:10:29.392415 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.393447 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:10:29.394146 (Thread-1): 10:10:29 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:10:29.394551 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:10:29.396515 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:10:29.397187 (MainThread): 10:10:29 | 
2021-11-29 02:10:29.397518 (MainThread): 10:10:29 | Finished running 1 incremental model, 2 table models in 7.48s.
2021-11-29 02:10:29.397786 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:10:29.398005 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:10:29.405099 (MainThread): 
2021-11-29 02:10:29.405428 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:10:29.405674 (MainThread): 
2021-11-29 02:10:29.405901 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.406108 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:10:29.406311 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:10:29.406501 (MainThread):   
2021-11-29 02:10:29.406661 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.406821 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.407004 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:10:29.407267 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779847f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779747cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d700>]}
2021-11-29 02:10:29.407569 (MainThread): Flushing usage events
2021-11-29 02:12:32.033215 (MainThread): Running with dbt=0.21.0
2021-11-29 02:12:32.833229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:12:32.834907 (MainThread): Tracking: tracking
2021-11-29 02:12:32.835435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8abfcebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2600910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26009a0>]}
2021-11-29 02:12:32.846141 (MainThread): Partial parsing not enabled
2021-11-29 02:12:32.855707 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:12:32.858774 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:12:32.891209 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:12:32.894812 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:12:32.898892 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:12:32.900108 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:12:32.902959 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:12:32.910936 (MainThread): Parsing macros/core.sql
2021-11-29 02:12:32.914277 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:12:32.920334 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:12:32.930302 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:12:32.932100 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:12:32.949768 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:12:32.980857 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:12:33.002056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:12:33.003968 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:12:33.013703 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:12:33.031676 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:12:33.043869 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:12:33.050554 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:12:33.056816 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:12:33.060002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:12:33.061230 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:12:33.062007 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:12:33.063241 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:12:33.070458 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:12:33.071935 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:12:33.073906 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:12:33.075441 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:12:33.120638 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:12:33.122040 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:12:33.122954 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:12:33.124475 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:12:33.338274 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:12:33.348760 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:12:33.351749 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:33.386647 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:12:33.390598 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f26d0>]}
2021-11-29 02:12:33.394338 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f2f70>]}
2021-11-29 02:12:33.394667 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:12:33.395608 (MainThread): 
2021-11-29 02:12:33.396095 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:12:33.396930 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:12:33.407757 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:12:33.407932 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:12:33.408046 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:12:34.472390 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.06 seconds
2021-11-29 02:12:34.475746 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:12:34.650605 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:12:34.665845 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:12:34.666204 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:12:34.666469 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:12:35.229284 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-29 02:12:35.232955 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:12:35.398440 (MainThread): 10:12:35 | Concurrency: 1 threads (target='dev')
2021-11-29 02:12:35.399000 (MainThread): 10:12:35 | 
2021-11-29 02:12:35.400979 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:12:35.401577 (Thread-1): 10:12:35 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:12:35.402141 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:35.402420 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:12:35.411101 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:12:35.411913 (Thread-1): finished collecting timing info
2021-11-29 02:12:35.455940 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:35.456146 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:12:35.456272 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:12:38.354189 (Thread-1): SQL status: SUCCESS 1 in 2.90 seconds
2021-11-29 02:12:38.371551 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.371838 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:12:38.474072 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:12:38.480070 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.480361 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:12:38.588065 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:12:38.604008 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.604292 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:12:38.709723 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:12:38.745505 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:12:38.748041 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.748199 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:12:38.865051 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-29 02:12:38.866115 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.866579 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:12:39.276005 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-11-29 02:12:39.276763 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:39.277225 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:12:39.476077 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 02:12:39.494632 (Thread-1): finished collecting timing info
2021-11-29 02:12:39.494940 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:12:39.659244 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bd9820>]}
2021-11-29 02:12:39.660157 (Thread-1): 10:12:39 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.26s]
2021-11-29 02:12:39.660585 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:12:39.660990 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.661496 (Thread-1): 10:12:39 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:12:39.662359 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:12:39.662704 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.668655 (Thread-1): finished collecting timing info
2021-11-29 02:12:39.669215 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.671732 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bd9e20>]}
2021-11-29 02:12:39.672250 (Thread-1): 10:12:39 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:12:39.672517 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.673343 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:12:39.673631 (Thread-1): 10:12:39 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:12:39.673867 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:12:39.675294 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:12:39.675767 (MainThread): 10:12:39 | 
2021-11-29 02:12:39.675985 (MainThread): 10:12:39 | Finished running 1 incremental model, 2 table models in 6.28s.
2021-11-29 02:12:39.676172 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:12:39.676322 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:12:39.681737 (MainThread): 
2021-11-29 02:12:39.681980 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:12:39.682162 (MainThread): 
2021-11-29 02:12:39.682324 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.682474 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:12:39.682617 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:12:39.682780 (MainThread):   
2021-11-29 02:12:39.682918 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.683056 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.683213 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:12:39.683446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2847f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bc85b0>]}
2021-11-29 02:12:39.683708 (MainThread): Flushing usage events
2021-11-29 02:21:41.085128 (MainThread): Running with dbt=0.21.0
2021-11-29 02:21:41.886991 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:21:41.888706 (MainThread): Tracking: tracking
2021-11-29 02:21:41.889236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda44a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda677e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda677e9d0>]}
2021-11-29 02:21:41.900178 (MainThread): Partial parsing not enabled
2021-11-29 02:21:41.909413 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:21:41.912550 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:21:41.947390 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:21:41.950993 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:21:41.955115 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:21:41.956361 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:21:41.959215 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:21:41.967217 (MainThread): Parsing macros/core.sql
2021-11-29 02:21:41.970581 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:21:41.976664 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:21:41.985446 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:21:41.987291 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:21:42.004600 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:21:42.034908 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:21:42.056242 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:21:42.057891 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:21:42.067287 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:21:42.084125 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:21:42.095828 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:21:42.102153 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:21:42.108007 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:21:42.111133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:21:42.112300 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:21:42.113035 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:21:42.114201 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:21:42.120951 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:21:42.122437 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:21:42.124317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:21:42.125686 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:21:42.170159 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:21:42.171484 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:21:42.172427 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:21:42.173472 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:21:42.396242 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:21:42.406977 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:21:42.409802 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:42.444901 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:21:42.448891 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d7c0>]}
2021-11-29 02:21:42.452751 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d9a0>]}
2021-11-29 02:21:42.453076 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:21:42.454025 (MainThread): 
2021-11-29 02:21:42.454443 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:21:42.455276 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:21:42.467223 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:21:42.467401 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:21:42.467512 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:21:43.339647 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.87 seconds
2021-11-29 02:21:43.343007 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:21:43.516836 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:21:43.529004 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:21:43.529333 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:21:43.529570 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:21:44.070598 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.54 seconds
2021-11-29 02:21:44.074122 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:21:44.226759 (MainThread): 10:21:44 | Concurrency: 1 threads (target='dev')
2021-11-29 02:21:44.227311 (MainThread): 10:21:44 | 
2021-11-29 02:21:44.229059 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:21:44.229633 (Thread-1): 10:21:44 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:21:44.230234 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:44.230536 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:21:44.239039 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:21:44.239789 (Thread-1): finished collecting timing info
2021-11-29 02:21:44.283241 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:44.283454 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:21:44.283588 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:21:45.993482 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-11-29 02:21:46.011418 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.011742 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:21:46.144657 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-11-29 02:21:46.154218 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.154547 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:21:46.251982 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:21:46.268059 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.268349 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:21:46.377484 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:21:46.412922 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:21:46.415446 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.415614 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:21:46.544663 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:21:46.545761 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.546220 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:21:47.019594 (Thread-1): SQL status: SUCCESS 0 in 0.47 seconds
2021-11-29 02:21:47.020208 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:47.020997 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:21:47.206992 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:21:47.226178 (Thread-1): finished collecting timing info
2021-11-29 02:21:47.226566 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:21:47.406252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6d539a0>]}
2021-11-29 02:21:47.407576 (Thread-1): 10:21:47 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.18s]
2021-11-29 02:21:47.408232 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:21:47.408875 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.409672 (Thread-1): 10:21:47 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:21:47.411197 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:21:47.411857 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.420272 (Thread-1): finished collecting timing info
2021-11-29 02:21:47.421201 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.424312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6d53dc0>]}
2021-11-29 02:21:47.424950 (Thread-1): 10:21:47 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:21:47.425271 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.426080 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:21:47.426427 (Thread-1): 10:21:47 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:21:47.426713 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:21:47.428221 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:21:47.428759 (MainThread): 10:21:47 | 
2021-11-29 02:21:47.429013 (MainThread): 10:21:47 | Finished running 1 incremental model, 2 table models in 4.97s.
2021-11-29 02:21:47.429234 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:21:47.429414 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:21:47.435315 (MainThread): 
2021-11-29 02:21:47.435592 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:21:47.435798 (MainThread): 
2021-11-29 02:21:47.435991 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.436172 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:21:47.436335 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:21:47.436500 (MainThread):   
2021-11-29 02:21:47.436662 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.436825 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.437008 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:21:47.437271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6847f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda676aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d220>]}
2021-11-29 02:21:47.437573 (MainThread): Flushing usage events
2021-11-29 02:27:06.316279 (MainThread): Running with dbt=0.21.0
2021-11-29 02:27:07.128745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='my_frist_variable: True', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:27:07.130363 (MainThread): Tracking: tracking
2021-11-29 02:27:07.130967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e75ebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f44940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f449d0>]}
2021-11-29 02:27:07.142431 (MainThread): Partial parsing not enabled
2021-11-29 02:27:07.152677 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:27:07.156076 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:27:07.190697 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:27:07.194305 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:27:07.198428 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:27:07.199711 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:27:07.202544 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:27:07.210449 (MainThread): Parsing macros/core.sql
2021-11-29 02:27:07.213782 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:27:07.219465 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:27:07.227282 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:27:07.228814 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:27:07.244351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:27:07.275370 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:27:07.296712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:27:07.298258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:27:07.307005 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:27:07.324106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:27:07.338403 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:27:07.345805 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:27:07.352623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:27:07.356094 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:27:07.357425 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:27:07.358267 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:27:07.359644 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:27:07.367482 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:27:07.369090 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:27:07.371244 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:27:07.372643 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:27:07.418492 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:27:07.419947 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:27:07.420904 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:27:07.421946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:27:07.626287 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:27:07.636853 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:27:07.639632 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:07.674447 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:27:07.678403 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c7c0>]}
2021-11-29 02:27:07.682434 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c9a0>]}
2021-11-29 02:27:07.682935 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:27:07.683887 (MainThread): 
2021-11-29 02:27:07.684305 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:27:07.685271 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:27:07.695726 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:27:07.695897 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:27:07.696004 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:27:08.651909 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.96 seconds
2021-11-29 02:27:08.655278 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:27:08.826480 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:27:08.838287 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:27:08.838597 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:27:08.838820 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:27:09.685723 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.85 seconds
2021-11-29 02:27:09.689183 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:27:09.849649 (MainThread): 10:27:09 | Concurrency: 1 threads (target='dev')
2021-11-29 02:27:09.850174 (MainThread): 10:27:09 | 
2021-11-29 02:27:09.853015 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:27:09.853707 (Thread-1): 10:27:09 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:27:09.854319 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:09.854620 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:27:09.863255 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:27:09.864047 (Thread-1): finished collecting timing info
2021-11-29 02:27:09.907712 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:09.907923 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:27:09.908056 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:27:11.495505 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-11-29 02:27:11.513187 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.513501 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:27:11.626601 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:27:11.635920 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.636225 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:27:11.730758 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 02:27:11.746741 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.747037 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:27:11.840016 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 02:27:11.875690 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:27:11.878494 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.878703 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:27:12.014267 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 02:27:12.015054 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:12.015391 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:27:12.619635 (Thread-1): SQL status: SUCCESS 0 in 0.60 seconds
2021-11-29 02:27:12.620410 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:12.620858 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:27:12.812612 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:27:12.831269 (Thread-1): finished collecting timing info
2021-11-29 02:27:12.831611 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:27:13.015042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea4d9280>]}
2021-11-29 02:27:13.016011 (Thread-1): 10:27:13 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.16s]
2021-11-29 02:27:13.016458 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:27:13.016880 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.017434 (Thread-1): 10:27:13 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:27:13.018440 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:27:13.018776 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.024847 (Thread-1): finished collecting timing info
2021-11-29 02:27:13.025474 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_frist_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_frist_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.028191 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea4d9160>]}
2021-11-29 02:27:13.028764 (Thread-1): 10:27:13 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:27:13.029043 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.029916 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:27:13.030261 (Thread-1): 10:27:13 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:27:13.030537 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:27:13.032017 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:27:13.032502 (MainThread): 10:27:13 | 
2021-11-29 02:27:13.032726 (MainThread): 10:27:13 | Finished running 1 incremental model, 2 table models in 5.35s.
2021-11-29 02:27:13.032916 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:27:13.033071 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:27:13.038385 (MainThread): 
2021-11-29 02:27:13.038628 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:27:13.038808 (MainThread): 
2021-11-29 02:27:13.038981 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.039138 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:27:13.039282 (MainThread):   Vars supplied to my_first_dbt_model = {
2021-11-29 02:27:13.039424 (MainThread):       "my_frist_variable": true
2021-11-29 02:27:13.039566 (MainThread):   }
2021-11-29 02:27:13.039707 (MainThread):   
2021-11-29 02:27:13.039846 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.039988 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.040150 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:27:13.040389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea086f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f895b0>]}
2021-11-29 02:27:13.040662 (MainThread): Flushing usage events
2021-11-29 02:31:26.268312 (MainThread): Running with dbt=0.21.0
2021-11-29 02:31:27.090867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:31:27.092267 (MainThread): Tracking: tracking
2021-11-29 02:31:27.092872 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12bca1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e803a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e803a90>]}
2021-11-29 02:31:27.104978 (MainThread): Partial parsing not enabled
2021-11-29 02:31:27.115114 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:31:27.118568 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:31:27.153620 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:31:27.157271 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:31:27.161434 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:31:27.162676 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:31:27.165696 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:31:27.173666 (MainThread): Parsing macros/core.sql
2021-11-29 02:31:27.177030 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:31:27.183271 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:31:27.192141 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:31:27.194310 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:31:27.210230 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:31:27.241192 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:31:27.263945 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:31:27.265642 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:31:27.275143 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:31:27.293778 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:31:27.306239 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:31:27.313060 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:31:27.319656 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:31:27.323019 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:31:27.324284 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:31:27.325082 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:31:27.326334 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:31:27.334320 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:31:27.335847 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:31:27.338028 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:31:27.339385 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:31:27.387596 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:31:27.389260 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:31:27.390295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:31:27.391417 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:31:27.604397 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:31:27.615429 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:31:27.618543 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:27.654079 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:31:27.658056 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91c940>]}
2021-11-29 02:31:27.662218 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91c880>]}
2021-11-29 02:31:27.662554 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:31:27.663525 (MainThread): 
2021-11-29 02:31:27.663984 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:31:27.665075 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:31:27.675382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:31:27.675542 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:31:27.675649 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:31:28.588446 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.91 seconds
2021-11-29 02:31:28.591883 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:31:28.761103 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:31:28.773494 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:31:28.773821 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:31:28.774039 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:31:29.581525 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.81 seconds
2021-11-29 02:31:29.584982 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:31:29.753718 (MainThread): 10:31:29 | Concurrency: 1 threads (target='dev')
2021-11-29 02:31:29.754261 (MainThread): 10:31:29 | 
2021-11-29 02:31:29.756203 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:31:29.756890 (Thread-1): 10:31:29 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:31:29.757611 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:29.757967 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:31:29.767386 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:31:29.768209 (Thread-1): finished collecting timing info
2021-11-29 02:31:29.813818 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:29.814035 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:31:29.814170 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:31:31.396548 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-11-29 02:31:31.414647 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.415006 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:31:31.538747 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-29 02:31:31.548202 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.548538 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:31:31.655644 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:31:31.671683 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.671981 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:31:31.774877 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:31:31.811270 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:31:31.813826 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.813984 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:31:31.935867 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-29 02:31:31.936954 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.937356 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:31:32.524299 (Thread-1): SQL status: SUCCESS 0 in 0.59 seconds
2021-11-29 02:31:32.525056 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:32.525518 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:31:32.698449 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-29 02:31:32.715941 (Thread-1): finished collecting timing info
2021-11-29 02:31:32.716269 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:31:32.887199 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12ed272b0>]}
2021-11-29 02:31:32.888107 (Thread-1): 10:31:32 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.13s]
2021-11-29 02:31:32.888548 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:31:32.888947 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.889521 (Thread-1): 10:31:32 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:31:32.890549 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:31:32.890964 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.897112 (Thread-1): finished collecting timing info
2021-11-29 02:31:32.897750 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.900379 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12ed27400>]}
2021-11-29 02:31:32.900904 (Thread-1): 10:31:32 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:31:32.901167 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.902152 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:31:32.902481 (Thread-1): 10:31:32 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:31:32.902733 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:31:32.904091 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:31:32.904557 (MainThread): 10:31:32 | 
2021-11-29 02:31:32.904775 (MainThread): 10:31:32 | Finished running 1 incremental model, 2 table models in 5.24s.
2021-11-29 02:31:32.904962 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:31:32.905112 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:31:32.910562 (MainThread): 
2021-11-29 02:31:32.910796 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:31:32.910972 (MainThread): 
2021-11-29 02:31:32.911138 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911288 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:31:32.911426 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:31:32.911563 (MainThread):   
2021-11-29 02:31:32.911701 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911835 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911993 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:31:32.912227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e946f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e848370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91cc10>]}
2021-11-29 02:31:32.912494 (MainThread): Flushing usage events
2021-11-29 02:32:19.135471 (MainThread): Running with dbt=0.21.0
2021-11-29 02:32:19.970111 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:32:19.971462 (MainThread): Tracking: tracking
2021-11-29 02:32:19.972002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc924debb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc926f04a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc926f04ac0>]}
2021-11-29 02:32:19.983675 (MainThread): Partial parsing not enabled
2021-11-29 02:32:19.993788 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:32:19.997234 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:32:20.033810 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:32:20.037470 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:32:20.041657 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:32:20.042899 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:32:20.045887 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:32:20.053972 (MainThread): Parsing macros/core.sql
2021-11-29 02:32:20.057420 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:32:20.063271 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:32:20.072791 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:32:20.074304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:32:20.090198 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:32:20.120817 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:32:20.141702 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:32:20.143670 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:32:20.152508 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:32:20.169139 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:32:20.183872 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:32:20.191453 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:32:20.198302 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:32:20.201832 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:32:20.203220 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:32:20.204065 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:32:20.205407 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:32:20.213278 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:32:20.215433 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:32:20.217788 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:32:20.219258 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:32:20.269351 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:32:20.270808 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:32:20.271778 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:32:20.272812 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:32:20.483037 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:20.494286 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:20.497207 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:20.538594 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92701b0a0>]}
2021-11-29 02:32:20.542707 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92701b040>]}
2021-11-29 02:32:20.542996 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:32:20.543976 (MainThread): 
2021-11-29 02:32:20.544340 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:32:20.545234 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:32:20.556912 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:32:20.557092 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:32:20.557212 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:32:21.373990 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.82 seconds
2021-11-29 02:32:21.377376 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:32:21.553529 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:32:21.565376 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:32:21.565699 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:32:21.565928 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:32:22.125958 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-29 02:32:22.129488 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:32:22.300410 (MainThread): 10:32:22 | Concurrency: 1 threads (target='dev')
2021-11-29 02:32:22.300932 (MainThread): 10:32:22 | 
2021-11-29 02:32:22.302944 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:32:22.303591 (Thread-1): 10:32:22 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:32:22.304154 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:22.304465 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:32:22.313412 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:32:22.314233 (Thread-1): finished collecting timing info
2021-11-29 02:32:22.358148 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:22.358357 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:32:22.358486 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:23.827179 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-11-29 02:32:23.844700 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:23.845041 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:32:24.011093 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-11-29 02:32:24.021003 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.021368 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:32:24.127624 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:32:24.143696 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.143992 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:32:24.240640 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:32:24.276584 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:32:24.279102 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.279266 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:32:24.405631 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:32:24.406757 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.407074 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:32:24.796951 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-11-29 02:32:24.797726 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.798229 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:32:24.975712 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-11-29 02:32:24.994779 (Thread-1): finished collecting timing info
2021-11-29 02:32:24.995135 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:32:25.185170 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9274f4fa0>]}
2021-11-29 02:32:25.186067 (Thread-1): 10:32:25 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.88s]
2021-11-29 02:32:25.186500 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:32:25.186921 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:25.187452 (Thread-1): 10:32:25 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:32:25.188433 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:25.188811 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:25.194060 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 02:32:25.194911 (Thread-1): finished collecting timing info
2021-11-29 02:32:25.207224 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 02:32:25.208482 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:25.208678 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_1  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 02:32:25.208853 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:26.387027 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-11-29 02:32:26.390449 (Thread-1): finished collecting timing info
2021-11-29 02:32:26.390923 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 02:32:26.560029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9274f4df0>]}
2021-11-29 02:32:26.560946 (Thread-1): 10:32:26 | 2 of 3 OK created table model dbt.first_model_1...................... [SUCCESS 1 in 1.37s]
2021-11-29 02:32:26.561373 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:26.562281 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:26.563244 (Thread-1): 10:32:26 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 02:32:26.563991 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:26.564290 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:26.568097 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 02:32:26.570578 (Thread-1): finished collecting timing info
2021-11-29 02:32:26.574799 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 02:32:26.576297 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:26.576586 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_1
where id = 1
      );
2021-11-29 02:32:26.576857 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:27.923300 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-11-29 02:32:27.926686 (Thread-1): finished collecting timing info
2021-11-29 02:32:27.927139 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 02:32:28.096823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275c77c0>]}
2021-11-29 02:32:28.097792 (Thread-1): 10:32:28 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.53s]
2021-11-29 02:32:28.098241 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:28.100502 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:32:28.101153 (MainThread): 10:32:28 | 
2021-11-29 02:32:28.101468 (MainThread): 10:32:28 | Finished running 1 incremental model, 2 table models in 7.56s.
2021-11-29 02:32:28.101738 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:32:28.101955 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 02:32:28.109092 (MainThread): 
2021-11-29 02:32:28.109440 (MainThread): Completed successfully
2021-11-29 02:32:28.109695 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 02:32:28.110023 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc924debb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275cd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275cde80>]}
2021-11-29 02:32:28.110384 (MainThread): Flushing usage events
2021-11-29 03:11:06.942561 (MainThread): Running with dbt=0.21.0
2021-11-29 03:11:08.576963 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['dates'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 03:11:08.579461 (MainThread): Tracking: tracking
2021-11-29 03:11:08.579997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef1e4ceca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20f01b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20f01bb0>]}
2021-11-29 03:11:08.591313 (MainThread): Partial parsing not enabled
2021-11-29 03:11:08.604402 (MainThread): Parsing macros/catalog.sql
2021-11-29 03:11:08.607801 (MainThread): Parsing macros/adapters.sql
2021-11-29 03:11:08.645207 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 03:11:08.648867 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 03:11:08.652996 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 03:11:08.654238 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 03:11:08.657374 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 03:11:08.665416 (MainThread): Parsing macros/core.sql
2021-11-29 03:11:08.668780 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 03:11:08.674987 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 03:11:08.684741 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 03:11:08.686405 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 03:11:08.703045 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 03:11:08.734651 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 03:11:08.756222 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 03:11:08.757732 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 03:11:08.766465 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 03:11:08.784180 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 03:11:08.796302 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 03:11:08.803670 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 03:11:08.810464 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 03:11:08.813939 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 03:11:08.815270 (MainThread): Parsing macros/etc/query.sql
2021-11-29 03:11:08.816117 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 03:11:08.817467 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 03:11:08.825404 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 03:11:08.827007 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 03:11:08.829189 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 03:11:08.830581 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 03:11:08.876472 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 03:11:08.877859 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 03:11:08.878950 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 03:11:08.879987 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 03:11:09.089576 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 03:11:09.100171 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 03:11:09.102951 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:09.144325 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21008b50>]}
2021-11-29 03:11:09.149873 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21008fa0>]}
2021-11-29 03:11:09.150249 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 03:11:09.151165 (MainThread): 
2021-11-29 03:11:09.151816 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 03:11:09.152575 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 03:11:09.163917 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 03:11:09.164100 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 03:11:09.164223 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 03:11:10.078762 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.91 seconds
2021-11-29 03:11:10.082095 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 03:11:10.257161 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 03:11:10.269011 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 03:11:10.269304 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 03:11:10.269527 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 03:11:10.835260 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.57 seconds
2021-11-29 03:11:10.838784 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 03:11:11.012220 (MainThread): 11:11:11 | Concurrency: 1 threads (target='dev')
2021-11-29 03:11:11.012734 (MainThread): 11:11:11 | 
2021-11-29 03:11:11.014673 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 03:11:11.015300 (Thread-1): 11:11:11 | 1 of 1 START incremental model dbt.dates............................. [RUN]
2021-11-29 03:11:11.015877 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:11.016166 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 03:11:11.025632 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 03:11:11.028730 (Thread-1): finished collecting timing info
2021-11-29 03:11:11.080053 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:11.080257 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 03:11:11.080382 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 03:11:14.208994 (Thread-1): SQL status: SUCCESS 1 in 3.13 seconds
2021-11-29 03:11:14.226224 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.226517 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 03:11:14.367951 (Thread-1): SQL status: SUCCESS 28 in 0.14 seconds
2021-11-29 03:11:14.377251 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.377557 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 03:11:14.486038 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 03:11:14.500222 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.500504 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 03:11:14.617349 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-29 03:11:14.653292 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 03:11:14.657515 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.657705 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 03:11:14.800980 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 03:11:14.802090 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.802427 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 03:11:15.234975 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2021-11-29 03:11:15.235737 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:15.236109 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 03:11:15.407348 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-29 03:11:15.426230 (Thread-1): finished collecting timing info
2021-11-29 03:11:15.426605 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 03:11:15.595474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef213a94f0>]}
2021-11-29 03:11:15.596409 (Thread-1): 11:11:15 | 1 of 1 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.58s]
2021-11-29 03:11:15.596853 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 03:11:15.599146 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 03:11:15.599792 (MainThread): 11:11:15 | 
2021-11-29 03:11:15.600105 (MainThread): 11:11:15 | Finished running 1 incremental model in 6.45s.
2021-11-29 03:11:15.600372 (MainThread): Connection 'master' was properly closed.
2021-11-29 03:11:15.600580 (MainThread): Connection 'model.jrtests_learn_dbt1.dates' was properly closed.
2021-11-29 03:11:15.607243 (MainThread): 
2021-11-29 03:11:15.607562 (MainThread): Completed successfully
2021-11-29 03:11:15.607808 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-29 03:11:15.608127 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef213c3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20fa2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21340580>]}
2021-11-29 03:11:15.608490 (MainThread): Flushing usage events
