2021-11-11 04:08:45.260755 (MainThread): Running with dbt=0.21.0
2021-11-11 04:08:46.186715 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:08:46.189337 (MainThread): Tracking: tracking
2021-11-11 04:08:46.190094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b84eba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb005460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb0058e0>]}
2021-11-11 04:08:46.204194 (MainThread): Partial parsing not enabled
2021-11-11 04:08:46.216339 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:08:46.219775 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:08:46.257145 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:08:46.260761 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:08:46.264877 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:08:46.266093 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:08:46.268924 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:08:46.276822 (MainThread): Parsing macros/core.sql
2021-11-11 04:08:46.280147 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:08:46.286185 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:08:46.295772 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:08:46.298249 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:08:46.313490 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:08:46.343551 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:08:46.364597 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:08:46.366212 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:08:46.374826 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:08:46.390729 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:08:46.401902 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:08:46.408758 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:08:46.414621 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:08:46.417694 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:08:46.419081 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:08:46.419810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:08:46.420967 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:08:46.427900 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:08:46.429295 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:08:46.431155 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:08:46.432375 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:08:46.477844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:08:46.479206 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:08:46.480116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:08:46.481134 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:08:46.708572 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:08:46.720640 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:08:46.758206 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00801b58-6181-4eca-8e10-b1ff3fafe549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12fd00>]}
2021-11-11 04:08:46.762367 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00801b58-6181-4eca-8e10-b1ff3fafe549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12feb0>]}
2021-11-11 04:08:46.762893 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:08:46.764530 (MainThread): 
2021-11-11 04:08:46.765091 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:08:46.766171 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:08:46.780392 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:08:46.780601 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:08:46.780904 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:08:47.661723 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.88 seconds
2021-11-11 04:08:47.664758 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:08:47.833599 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.834308 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.834734 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-11-11 04:08:47.843308 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-11-11 04:08:47.843587 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-11-11 04:08:47.843790 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-11 04:08:48.413389 (ThreadPoolExecutor-0_0): Snowflake query id: 01a035b8-3200-8f0f-0000-00008a252179
2021-11-11 04:08:48.413831 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-11-11 04:08:48.414214 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-11-11 04:08:48.414501 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-11-11 04:08:48.414849 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-11-11 04:08:48.583970 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:08:48.584402 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-11-11 04:08:48.584838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ba7ee2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bb12a280>]}
2021-11-11 04:08:48.585362 (MainThread): Flushing usage events
2021-11-11 04:08:49.842421 (MainThread): Encountered an error:
2021-11-11 04:08:49.842936 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-11-11 04:08:49.851836 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    create_future.result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in create_schema
    adapter.create_schema(relation)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-11-11 04:15:21.088696 (MainThread): Running with dbt=0.21.0
2021-11-11 04:15:21.923209 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:15:21.925322 (MainThread): Tracking: tracking
2021-11-11 04:15:21.926506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a194abbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c701a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c701a90>]}
2021-11-11 04:15:21.939104 (MainThread): Partial parsing not enabled
2021-11-11 04:15:21.949156 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:15:21.952658 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:15:21.987974 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:15:21.991568 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:15:21.995641 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:15:21.996859 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:15:21.999675 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:15:22.008614 (MainThread): Parsing macros/core.sql
2021-11-11 04:15:22.012802 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:15:22.019000 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:15:22.028927 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:15:22.030566 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:15:22.047244 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:15:22.078110 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:15:22.098433 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:15:22.099868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:15:22.108221 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:15:22.124624 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:15:22.136573 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:15:22.142927 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:15:22.148947 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:15:22.152566 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:15:22.153874 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:15:22.154606 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:15:22.155761 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:15:22.162630 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:15:22.164011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:15:22.165890 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:15:22.167104 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:15:22.213503 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:15:22.214883 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:15:22.215916 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:15:22.216971 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:15:22.436874 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:22.447629 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:15:22.482372 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c7ec730>]}
2021-11-11 04:15:22.487803 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c7a7ca0>]}
2021-11-11 04:15:22.488213 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:15:22.489610 (MainThread): 
2021-11-11 04:15:22.490053 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:15:22.491106 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:15:22.502443 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:15:22.502606 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:15:22.502720 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:15:23.465515 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.96 seconds
2021-11-11 04:15:23.469387 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:15:23.630811 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.631497 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.631925 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-11-11 04:15:23.640364 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-11-11 04:15:23.640630 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-11-11 04:15:23.640825 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-11 04:15:24.449751 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.81 seconds
2021-11-11 04:15:24.451892 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-11-11 04:15:24.619166 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:15:24.631018 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:15:24.631314 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:15:24.631529 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:15:25.166486 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.53 seconds
2021-11-11 04:15:25.169517 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:15:25.331661 (MainThread): 12:15:25 | Concurrency: 1 threads (target='dev')
2021-11-11 04:15:25.332159 (MainThread): 12:15:25 | 
2021-11-11 04:15:25.334188 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:25.334985 (Thread-1): 12:15:25 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:15:25.335569 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:25.335879 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:25.340332 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:15:25.341546 (Thread-1): finished collecting timing info
2021-11-11 04:15:25.372660 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:15:25.373934 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:15:25.374098 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:15:25.374270 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:15:25.967506 (Thread-1): Snowflake query id: 01a035bf-3200-8f0f-0000-00008a252309
2021-11-11 04:15:25.967931 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:15:25.968369 (Thread-1): finished collecting timing info
2021-11-11 04:15:25.969072 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:15:26.127974 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:15:26.132188 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8938bf0e-3827-4cf8-9799-3456b81f7104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d3ba5e0>]}
2021-11-11 04:15:26.133435 (Thread-1): 12:15:26 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.80s]
2021-11-11 04:15:26.133871 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:15:26.135617 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:15:26.136305 (Thread-1): 12:15:26 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:15:26.136751 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:15:26.138880 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:15:26.139670 (MainThread): 12:15:26 | 
2021-11-11 04:15:26.139963 (MainThread): 12:15:26 | Finished running 1 table model, 1 view model in 3.65s.
2021-11-11 04:15:26.140216 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:15:26.140420 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:15:26.147882 (MainThread): 
2021-11-11 04:15:26.148205 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:15:26.148436 (MainThread): 
2021-11-11 04:15:26.148653 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:15:26.148848 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:15:26.149036 (MainThread):   
2021-11-11 04:15:26.149217 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:15:26.149443 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:15:26.149746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d02c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d30e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d30ea60>]}
2021-11-11 04:15:26.150105 (MainThread): Flushing usage events
2021-11-11 04:17:13.933173 (MainThread): Running with dbt=0.21.0
2021-11-11 04:17:14.769624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:17:14.771223 (MainThread): Tracking: tracking
2021-11-11 04:17:14.771837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e534abee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55f04a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55f04ac0>]}
2021-11-11 04:17:14.783735 (MainThread): Partial parsing not enabled
2021-11-11 04:17:14.793747 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:17:14.797244 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:17:14.832091 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:17:14.835684 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:17:14.839853 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:17:14.841086 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:17:14.843956 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:17:14.852093 (MainThread): Parsing macros/core.sql
2021-11-11 04:17:14.855481 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:17:14.861642 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:17:14.870715 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:17:14.873005 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:17:14.890247 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:17:14.921517 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:17:14.943583 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:17:14.945052 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:17:14.953382 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:17:14.970088 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:17:14.982306 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:17:14.989227 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:17:14.995541 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:17:14.998739 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:17:14.999972 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:17:15.000747 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:17:15.002534 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:17:15.010094 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:17:15.011609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:17:15.014094 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:17:15.016051 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:17:15.072884 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:17:15.074514 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:17:15.075610 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:17:15.076825 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:17:15.296925 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:15.307811 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:17:15.345369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55fec3d0>]}
2021-11-11 04:17:15.349094 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55fa7400>]}
2021-11-11 04:17:15.349356 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:17:15.350201 (MainThread): 
2021-11-11 04:17:15.350622 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:17:15.351306 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:17:15.362706 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:17:15.362881 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:17:15.362989 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:17:16.395130 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.03 seconds
2021-11-11 04:17:16.398482 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:17:16.562166 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:17:16.574147 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:17:16.574453 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:17:16.574663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:17:17.279713 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.70 seconds
2021-11-11 04:17:17.282898 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:17:17.446716 (MainThread): 12:17:17 | Concurrency: 1 threads (target='dev')
2021-11-11 04:17:17.447212 (MainThread): 12:17:17 | 
2021-11-11 04:17:17.449209 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:17.449909 (Thread-1): 12:17:17 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:17:17.450498 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:17.450778 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:17.455157 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:17:17.456018 (Thread-1): finished collecting timing info
2021-11-11 04:17:17.486476 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:17:17.487429 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:17:17.487604 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:17:17.487738 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:17:18.068796 (Thread-1): Snowflake query id: 01a035c1-3200-8f0d-0000-00008a2532d5
2021-11-11 04:17:18.069141 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:17:18.069477 (Thread-1): finished collecting timing info
2021-11-11 04:17:18.069791 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:17:18.224588 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:17:18.231242 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a3f84d-ce3e-4577-bdb6-713e765e96ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e563dea00>]}
2021-11-11 04:17:18.232302 (Thread-1): 12:17:18 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.78s]
2021-11-11 04:17:18.232699 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:17:18.233695 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:17:18.234101 (Thread-1): 12:17:18 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:17:18.234740 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:17:18.237024 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:17:18.237835 (MainThread): 12:17:18 | 
2021-11-11 04:17:18.238193 (MainThread): 12:17:18 | Finished running 1 table model, 1 view model in 2.89s.
2021-11-11 04:17:18.238452 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:17:18.238658 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:17:18.246102 (MainThread): 
2021-11-11 04:17:18.246427 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:17:18.246662 (MainThread): 
2021-11-11 04:17:18.246876 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:17:18.247074 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:17:18.247286 (MainThread):   
2021-11-11 04:17:18.247470 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:17:18.247677 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:17:18.247975 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5612c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e564be880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e564beb20>]}
2021-11-11 04:17:18.248318 (MainThread): Flushing usage events
2021-11-11 04:22:44.872330 (MainThread): Running with dbt=0.21.0
2021-11-11 04:22:45.713139 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:22:45.714927 (MainThread): Tracking: tracking
2021-11-11 04:22:45.715447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0adabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0059a0>]}
2021-11-11 04:22:45.726331 (MainThread): Partial parsing not enabled
2021-11-11 04:22:45.736394 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:22:45.739628 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:22:45.774003 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:22:45.777621 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:22:45.781743 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:22:45.783146 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:22:45.786036 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:22:45.793719 (MainThread): Parsing macros/core.sql
2021-11-11 04:22:45.796776 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:22:45.802419 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:22:45.810641 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:22:45.812029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:22:45.828337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:22:45.861077 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:22:45.882415 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:22:45.884031 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:22:45.893680 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:22:45.912007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:22:45.923876 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:22:45.930277 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:22:45.936513 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:22:45.940070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:22:45.941354 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:22:45.942111 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:22:45.943280 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:22:45.950224 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:22:45.952094 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:22:45.954094 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:22:45.955410 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:22:46.002959 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:22:46.004416 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:22:46.005379 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:22:46.006426 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:22:46.223304 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:46.234254 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:22:46.274309 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0a7df0>]}
2021-11-11 04:22:46.278472 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d0a7be0>]}
2021-11-11 04:22:46.278800 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:22:46.279799 (MainThread): 
2021-11-11 04:22:46.280337 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:22:46.281184 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:22:46.291839 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:22:46.292006 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:22:46.292112 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:22:47.106757 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.81 seconds
2021-11-11 04:22:47.110729 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:22:47.269280 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:22:47.281284 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:22:47.281584 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:22:47.281795 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:22:47.963769 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.68 seconds
2021-11-11 04:22:47.966907 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:22:48.138663 (MainThread): 12:22:48 | Concurrency: 1 threads (target='dev')
2021-11-11 04:22:48.139171 (MainThread): 12:22:48 | 
2021-11-11 04:22:48.141171 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.141864 (Thread-1): 12:22:48 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:22:48.142426 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:48.142698 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.147140 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:22:48.148007 (Thread-1): finished collecting timing info
2021-11-11 04:22:48.178088 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:22:48.179021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:22:48.179149 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:22:48.179251 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:22:48.746311 (Thread-1): Snowflake query id: 01a035c6-3200-8f0d-0000-00008a2532f9
2021-11-11 04:22:48.746656 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-11-11 04:22:48.746998 (Thread-1): finished collecting timing info
2021-11-11 04:22:48.747318 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:22:48.905569 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:22:48.909073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ae734-44c5-460d-8fd6-812b8c9eb8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d41d040>]}
2021-11-11 04:22:48.909926 (Thread-1): 12:22:48 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 0.77s]
2021-11-11 04:22:48.910327 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:22:48.911674 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:22:48.912176 (Thread-1): 12:22:48 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-11 04:22:48.912728 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:22:48.914924 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:22:48.915529 (MainThread): 12:22:48 | 
2021-11-11 04:22:48.915853 (MainThread): 12:22:48 | Finished running 1 table model, 1 view model in 2.64s.
2021-11-11 04:22:48.916109 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:22:48.916315 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-11 04:22:48.923442 (MainThread): 
2021-11-11 04:22:48.923769 (MainThread): Completed with 1 error and 0 warnings:
2021-11-11 04:22:48.923996 (MainThread): 
2021-11-11 04:22:48.924207 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-11 04:22:48.924435 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-11-11 04:22:48.924623 (MainThread):   
2021-11-11 04:22:48.924804 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/my_first_dbt_model.sql
2021-11-11 04:22:48.925012 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-11-11 04:22:48.925309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d12d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d3db4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d3db760>]}
2021-11-11 04:22:48.925659 (MainThread): Flushing usage events
2021-11-11 04:24:11.575235 (MainThread): Running with dbt=0.21.0
2021-11-11 04:24:12.386921 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-11 04:24:12.388686 (MainThread): Tracking: tracking
2021-11-11 04:24:12.389299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7aaebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf0a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf0a9a0>]}
2021-11-11 04:24:12.401082 (MainThread): Partial parsing not enabled
2021-11-11 04:24:12.411152 (MainThread): Parsing macros/catalog.sql
2021-11-11 04:24:12.414496 (MainThread): Parsing macros/adapters.sql
2021-11-11 04:24:12.449205 (MainThread): Parsing macros/materializations/merge.sql
2021-11-11 04:24:12.452823 (MainThread): Parsing macros/materializations/seed.sql
2021-11-11 04:24:12.457175 (MainThread): Parsing macros/materializations/view.sql
2021-11-11 04:24:12.458459 (MainThread): Parsing macros/materializations/table.sql
2021-11-11 04:24:12.461300 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-11 04:24:12.469308 (MainThread): Parsing macros/core.sql
2021-11-11 04:24:12.472540 (MainThread): Parsing macros/materializations/test.sql
2021-11-11 04:24:12.478074 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-11 04:24:12.486399 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-11 04:24:12.488087 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-11 04:24:12.503397 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-11 04:24:12.535230 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-11 04:24:12.556120 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-11 04:24:12.557648 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-11 04:24:12.566440 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-11 04:24:12.583134 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-11 04:24:12.594394 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-11 04:24:12.601629 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-11 04:24:12.607528 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-11 04:24:12.610773 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-11 04:24:12.611935 (MainThread): Parsing macros/etc/query.sql
2021-11-11 04:24:12.612672 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-11 04:24:12.613980 (MainThread): Parsing macros/etc/datetime.sql
2021-11-11 04:24:12.620758 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-11 04:24:12.622125 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-11 04:24:12.624020 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-11 04:24:12.625214 (MainThread): Parsing macros/adapters/common.sql
2021-11-11 04:24:12.674953 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-11 04:24:12.676563 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-11 04:24:12.677642 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-11 04:24:12.678844 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-11 04:24:12.892305 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:12.903090 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:12.939032 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb6a0>]}
2021-11-11 04:24:12.943362 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb670>]}
2021-11-11 04:24:12.943708 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-11 04:24:12.944622 (MainThread): 
2021-11-11 04:24:12.945029 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:24:12.945828 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-11 04:24:12.957438 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-11 04:24:12.957610 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-11 04:24:12.957725 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-11 04:24:13.804237 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2021-11-11 04:24:13.807558 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-11 04:24:13.967109 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-11 04:24:13.978939 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-11 04:24:13.979228 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-11 04:24:13.979438 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-11 04:24:14.720982 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.74 seconds
2021-11-11 04:24:14.724050 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-11 04:24:14.887542 (MainThread): 12:24:14 | Concurrency: 1 threads (target='dev')
2021-11-11 04:24:14.888056 (MainThread): 12:24:14 | 
2021-11-11 04:24:14.890125 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:14.890757 (Thread-1): 12:24:14 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-11 04:24:14.891531 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:14.891871 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:14.896308 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:24:14.897066 (Thread-1): finished collecting timing info
2021-11-11 04:24:14.927276 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-11 04:24:14.928234 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-11 04:24:14.928371 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-11 04:24:14.928486 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:24:16.427323 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-11-11 04:24:16.446090 (Thread-1): finished collecting timing info
2021-11-11 04:24:16.446446 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-11 04:24:16.610747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7dc86af0>]}
2021-11-11 04:24:16.611659 (Thread-1): 12:24:16 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.72s]
2021-11-11 04:24:16.612081 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-11 04:24:16.613223 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:16.613795 (Thread-1): 12:24:16 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-11-11 04:24:16.614620 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:16.614933 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:16.619148 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-11 04:24:16.619992 (Thread-1): finished collecting timing info
2021-11-11 04:24:16.641225 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-11 04:24:16.642168 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-11 04:24:16.642366 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-11-11 04:24:16.642488 (Thread-1): Opening a new connection, currently in state closed
2021-11-11 04:24:17.264527 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-11-11 04:24:17.267975 (Thread-1): finished collecting timing info
2021-11-11 04:24:17.268410 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-11 04:24:17.430129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07f1d84-666c-4cb0-a502-8b02c855d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7dc86970>]}
2021-11-11 04:24:17.431029 (Thread-1): 12:24:17 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 0.82s]
2021-11-11 04:24:17.431460 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-11 04:24:17.433716 (MainThread): Acquiring new snowflake connection "master".
2021-11-11 04:24:17.434470 (MainThread): 12:24:17 | 
2021-11-11 04:24:17.434767 (MainThread): 12:24:17 | Finished running 1 table model, 1 view model in 4.49s.
2021-11-11 04:24:17.435021 (MainThread): Connection 'master' was properly closed.
2021-11-11 04:24:17.435248 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-11 04:24:17.442258 (MainThread): 
2021-11-11 04:24:17.442570 (MainThread): Completed successfully
2021-11-11 04:24:17.442821 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-11 04:24:17.443141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cfeb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7cf406a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc7d92ac70>]}
2021-11-11 04:24:17.443493 (MainThread): Flushing usage events
2021-11-24 03:42:47.593555 (MainThread): Running with dbt=0.21.0
2021-11-24 03:42:49.604085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:42:49.606233 (MainThread): Tracking: tracking
2021-11-24 03:42:49.606759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f9cebfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fce07af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fce07b80>]}
2021-11-24 03:42:49.618729 (MainThread): Partial parsing not enabled
2021-11-24 03:42:49.640530 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:42:49.643853 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:42:49.698159 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:42:49.702473 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:42:49.707699 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:42:49.709112 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:42:49.712780 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:42:49.720994 (MainThread): Parsing macros/core.sql
2021-11-24 03:42:49.724399 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:42:49.730668 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:42:49.739611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:42:49.741187 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:42:49.757005 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:42:49.785896 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:42:49.805731 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:42:49.807415 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:42:49.816203 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:42:49.832755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:42:49.843993 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:42:49.850334 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:42:49.856228 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:42:49.859293 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:42:49.860612 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:42:49.861347 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:42:49.862515 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:42:49.869540 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:42:49.870948 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:42:49.872833 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:42:49.874072 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:42:49.919455 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:42:49.920797 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:42:49.921738 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:42:49.922785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:42:50.137158 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:50.148040 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:50.185507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd82b6a0>]}
2021-11-24 03:42:50.189914 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd82b1c0>]}
2021-11-24 03:42:50.190223 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:42:50.191139 (MainThread): 
2021-11-24 03:42:50.191502 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:42:50.192258 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:42:50.203868 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:42:50.204048 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:42:50.204168 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:42:51.260810 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.06 seconds
2021-11-24 03:42:51.264266 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:42:51.443601 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:42:51.456638 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:42:51.457040 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:42:51.457270 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:42:52.300275 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.84 seconds
2021-11-24 03:42:52.303837 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:42:52.468778 (MainThread): 11:42:52 | Concurrency: 1 threads (target='dev')
2021-11-24 03:42:52.469277 (MainThread): 11:42:52 | 
2021-11-24 03:42:52.471368 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:52.472050 (Thread-1): 11:42:52 | 1 of 2 START view model dbt.my_first_dbt_model....................... [RUN]
2021-11-24 03:42:52.472618 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:52.472949 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:52.477270 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:42:52.480177 (Thread-1): finished collecting timing info
2021-11-24 03:42:52.515152 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" because it is of type table
2021-11-24 03:42:52.519536 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:52.519713 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */
drop table if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-11-24 03:42:52.519829 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:42:53.097036 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-11-24 03:42:53.109792 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:42:53.111599 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:42:53.111833 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */

  create or replace  view analytics.dbt.my_first_dbt_model  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-24 03:42:53.318153 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-11-24 03:42:53.332024 (Thread-1): finished collecting timing info
2021-11-24 03:42:53.332364 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:42:53.507077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb98a30>]}
2021-11-24 03:42:53.507994 (Thread-1): 11:42:53 | 1 of 2 OK created view model dbt.my_first_dbt_model.................. [SUCCESS 1 in 1.03s]
2021-11-24 03:42:53.508427 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:42:53.509314 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:53.509865 (Thread-1): 11:42:53 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-11-24 03:42:53.510468 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:53.510729 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:53.515948 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:42:53.516843 (Thread-1): finished collecting timing info
2021-11-24 03:42:53.519586 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:42:53.521716 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:42:53.522039 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-11-24 03:42:53.522252 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:42:54.311133 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-11-24 03:42:54.314643 (Thread-1): finished collecting timing info
2021-11-24 03:42:54.315088 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:42:54.488554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '446a8a02-9b59-4559-90b8-b996d96d9739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb9c4f0>]}
2021-11-24 03:42:54.489464 (Thread-1): 11:42:54 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 0.98s]
2021-11-24 03:42:54.489875 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:42:54.492271 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:42:54.492940 (MainThread): 11:42:54 | 
2021-11-24 03:42:54.493241 (MainThread): 11:42:54 | Finished running 2 view models in 4.30s.
2021-11-24 03:42:54.493496 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:42:54.493699 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:42:54.500985 (MainThread): 
2021-11-24 03:42:54.501301 (MainThread): Completed successfully
2021-11-24 03:42:54.501565 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:42:54.501996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd8767c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f9cb1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fdb59a60>]}
2021-11-24 03:42:54.502365 (MainThread): Flushing usage events
2021-11-24 03:44:32.314060 (MainThread): Running with dbt=0.21.0
2021-11-24 03:44:33.157256 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:44:33.158550 (MainThread): Tracking: tracking
2021-11-24 03:44:33.159080 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0064bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008605970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008605a30>]}
2021-11-24 03:44:33.169798 (MainThread): Partial parsing not enabled
2021-11-24 03:44:33.179097 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:44:33.182397 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:44:33.217008 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:44:33.220693 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:44:33.224973 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:44:33.226204 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:44:33.229092 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:44:33.237069 (MainThread): Parsing macros/core.sql
2021-11-24 03:44:33.240430 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:44:33.246507 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:44:33.255405 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:44:33.257099 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:44:33.274434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:44:33.305841 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:44:33.326958 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:44:33.328577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:44:33.338115 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:44:33.355812 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:44:33.367811 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:44:33.401583 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:44:33.412285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:44:33.416941 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:44:33.418570 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:44:33.419618 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:44:33.421177 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:44:33.429372 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:44:33.430977 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:44:33.433245 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:44:33.434648 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:44:33.486252 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:44:33.487842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:44:33.488906 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:44:33.490403 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:44:33.702353 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:33.712436 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:33.747208 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0064b8490>]}
2021-11-24 03:44:33.750801 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0086cdfa0>]}
2021-11-24 03:44:33.751126 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:44:33.752208 (MainThread): 
2021-11-24 03:44:33.752699 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:44:33.753534 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:44:33.765051 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:44:33.765230 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:44:33.765337 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:44:34.622051 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-11-24 03:44:34.625404 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:44:34.780041 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:44:34.791931 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:44:34.792224 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:44:34.792435 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:44:35.539559 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.75 seconds
2021-11-24 03:44:35.543057 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:44:35.716545 (MainThread): 11:44:35 | Concurrency: 1 threads (target='dev')
2021-11-24 03:44:35.717063 (MainThread): 11:44:35 | 
2021-11-24 03:44:35.719221 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:35.719821 (Thread-1): 11:44:35 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:44:35.720413 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:35.720703 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:35.723295 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:44:35.724126 (Thread-1): finished collecting timing info
2021-11-24 03:44:35.745433 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" because it is of type view
2021-11-24 03:44:35.751534 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:35.751789 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-11-24 03:44:35.751958 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:44:36.311020 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-11-24 03:44:36.331461 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:44:36.332839 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:44:36.333046 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:44:37.530651 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-11-24 03:44:37.552034 (Thread-1): finished collecting timing info
2021-11-24 03:44:37.552362 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:44:37.711716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008bac8b0>]}
2021-11-24 03:44:37.712620 (Thread-1): 11:44:37 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.99s]
2021-11-24 03:44:37.713055 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:44:37.713945 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:37.714784 (Thread-1): 11:44:37 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:44:37.715835 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:37.716158 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:37.719871 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:44:37.720680 (Thread-1): finished collecting timing info
2021-11-24 03:44:37.723193 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" because it is of type view
2021-11-24 03:44:37.725371 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:37.725605 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" cascade
2021-11-24 03:44:37.725802 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:44:38.305972 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-11-24 03:44:38.309096 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:44:38.310891 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:44:38.311218 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:44:39.169135 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-11-24 03:44:39.172536 (Thread-1): finished collecting timing info
2021-11-24 03:44:39.172984 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:44:39.332051 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5ab3577-4952-4fee-af54-d1a10d43cbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008bac3d0>]}
2021-11-24 03:44:39.332972 (Thread-1): 11:44:39 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.62s]
2021-11-24 03:44:39.333403 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:44:39.335581 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:44:39.336282 (MainThread): 11:44:39 | 
2021-11-24 03:44:39.336586 (MainThread): 11:44:39 | Finished running 2 table models in 5.58s.
2021-11-24 03:44:39.336846 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:44:39.337058 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:44:39.344363 (MainThread): 
2021-11-24 03:44:39.344685 (MainThread): Completed successfully
2021-11-24 03:44:39.344967 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:44:39.345305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0086ec340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008621910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008650820>]}
2021-11-24 03:44:39.345671 (MainThread): Flushing usage events
2021-11-24 03:54:35.795684 (MainThread): Running with dbt=0.21.0
2021-11-24 03:54:36.599745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:54:36.601182 (MainThread): Tracking: tracking
2021-11-24 03:54:36.601739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f9cabf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbf05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbf059d0>]}
2021-11-24 03:54:36.612884 (MainThread): Partial parsing not enabled
2021-11-24 03:54:36.622836 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:54:36.626124 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:54:36.661185 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:54:36.664860 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:54:36.668990 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:54:36.670218 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:54:36.673072 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:54:36.681259 (MainThread): Parsing macros/core.sql
2021-11-24 03:54:36.684635 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:54:36.690937 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:54:36.700183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:54:36.702359 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:54:36.719070 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:54:36.750238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:54:36.770849 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:54:36.772398 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:54:36.780548 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:54:36.797385 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:54:36.809012 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:54:36.815387 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:54:36.821687 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:54:36.824880 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:54:36.826046 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:54:36.826789 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:54:36.827954 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:54:36.834740 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:54:36.836119 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:54:36.838200 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:54:36.839534 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:54:36.889546 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:54:36.891141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:54:36.892397 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:54:36.893631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:54:37.109321 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:37.118824 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:37.121619 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:37.162652 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc8199a0>]}
2021-11-24 03:54:37.166541 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc8199d0>]}
2021-11-24 03:54:37.166873 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:54:37.167880 (MainThread): 
2021-11-24 03:54:37.168235 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:54:37.168970 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:54:37.180187 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:54:37.180367 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:54:37.180480 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:54:38.159330 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.98 seconds
2021-11-24 03:54:38.162582 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:54:38.325465 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:54:38.338124 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:54:38.338436 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:54:38.338654 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:54:38.889415 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.55 seconds
2021-11-24 03:54:38.893217 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:54:39.053930 (MainThread): 11:54:39 | Concurrency: 1 threads (target='dev')
2021-11-24 03:54:39.054451 (MainThread): 11:54:39 | 
2021-11-24 03:54:39.057129 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:54:39.057777 (Thread-1): 11:54:39 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:54:39.058391 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:39.058707 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:54:39.064087 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:54:39.064826 (Thread-1): finished collecting timing info
2021-11-24 03:54:39.111371 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:54:39.112227 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:54:39.112368 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */


      create or replace transient table analytics.dbt.dates  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


      );
2021-11-24 03:54:39.112479 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:41.506324 (Thread-1): SQL status: SUCCESS 1 in 2.39 seconds
2021-11-24 03:54:41.525708 (Thread-1): finished collecting timing info
2021-11-24 03:54:41.526026 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:54:41.686096 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcbbb220>]}
2021-11-24 03:54:41.687001 (Thread-1): 11:54:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.63s]
2021-11-24 03:54:41.687432 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:54:41.687843 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:41.688359 (Thread-1): 11:54:41 | 2 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:54:41.689264 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:41.689622 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:41.692327 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:54:41.693173 (Thread-1): finished collecting timing info
2021-11-24 03:54:41.706171 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:54:41.707537 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:54:41.707746 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:54:41.707946 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:43.759666 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2021-11-24 03:54:43.763130 (Thread-1): finished collecting timing info
2021-11-24 03:54:43.763595 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:54:43.923228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcbedac0>]}
2021-11-24 03:54:43.924145 (Thread-1): 11:54:43 | 2 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.23s]
2021-11-24 03:54:43.924571 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:54:43.925470 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:43.926029 (Thread-1): 11:54:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:54:43.927006 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:43.927339 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:43.931071 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:54:43.932156 (Thread-1): finished collecting timing info
2021-11-24 03:54:43.935370 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:54:43.936570 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:54:43.936797 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:54:43.937000 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:54:45.295460 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-11-24 03:54:45.298917 (Thread-1): finished collecting timing info
2021-11-24 03:54:45.299381 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:54:45.469998 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86623d71-efd8-410a-bf3b-b761c202d048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcc1da00>]}
2021-11-24 03:54:45.470917 (Thread-1): 11:54:45 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.54s]
2021-11-24 03:54:45.471352 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:54:45.473400 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:54:45.474074 (MainThread): 11:54:45 | 
2021-11-24 03:54:45.474386 (MainThread): 11:54:45 | Finished running 1 incremental model, 2 table models in 8.31s.
2021-11-24 03:54:45.474647 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:54:45.474855 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:54:45.481645 (MainThread): 
2021-11-24 03:54:45.481949 (MainThread): Completed successfully
2021-11-24 03:54:45.482197 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-24 03:54:45.482510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fc819b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fbfcc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4fcb46910>]}
2021-11-24 03:54:45.482863 (MainThread): Flushing usage events
2021-11-24 03:55:36.060045 (MainThread): Running with dbt=0.21.0
2021-11-24 03:55:36.852645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:55:36.854288 (MainThread): Tracking: tracking
2021-11-24 03:55:36.854769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb134cee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15809a60>]}
2021-11-24 03:55:36.865400 (MainThread): Partial parsing not enabled
2021-11-24 03:55:36.874594 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:55:36.877703 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:55:36.912889 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:55:36.916540 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:55:36.920687 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:55:36.922010 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:55:36.924914 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:55:36.932905 (MainThread): Parsing macros/core.sql
2021-11-24 03:55:36.936317 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:55:36.942471 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:55:36.951473 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:55:36.953985 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:55:36.972002 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:55:37.004628 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:55:37.026878 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:55:37.028539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:55:37.038169 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:55:37.055729 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:55:37.067644 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:55:37.074100 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:55:37.079936 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:55:37.082956 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:55:37.084106 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:55:37.084851 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:55:37.086029 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:55:37.093411 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:55:37.094839 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:55:37.096733 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:55:37.097970 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:55:37.145307 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:55:37.146746 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:55:37.147696 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:55:37.148741 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:55:37.356825 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:37.366379 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:37.369229 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:37.409477 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15827970>]}
2021-11-24 03:55:37.413173 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158279d0>]}
2021-11-24 03:55:37.413671 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:55:37.414913 (MainThread): 
2021-11-24 03:55:37.415335 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:55:37.416231 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:55:37.427155 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:55:37.427327 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:55:37.427436 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:55:38.347682 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.92 seconds
2021-11-24 03:55:38.350992 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:55:38.514644 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:55:38.526415 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:55:38.526710 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:55:38.526925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:55:39.096996 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.57 seconds
2021-11-24 03:55:39.100602 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:55:39.271250 (MainThread): 11:55:39 | Concurrency: 1 threads (target='dev')
2021-11-24 03:55:39.271794 (MainThread): 11:55:39 | 
2021-11-24 03:55:39.273772 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:55:39.274502 (Thread-1): 11:55:39 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:55:39.275074 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:39.275357 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:55:39.284314 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:55:39.285125 (Thread-1): finished collecting timing info
2021-11-24 03:55:39.328702 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:39.328912 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 03:55:39.329036 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:40.431184 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-11-24 03:55:40.448709 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.448987 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 03:55:40.572750 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-24 03:55:40.581893 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.582203 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 03:55:40.689889 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:55:40.705601 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.705883 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 03:55:40.817789 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:55:40.854081 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:55:40.856599 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.856767 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 03:55:40.991512 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-24 03:55:40.992248 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:40.992513 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 03:55:41.511082 (Thread-1): SQL status: SUCCESS 0 in 0.52 seconds
2021-11-24 03:55:41.511605 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:55:41.511916 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 03:55:41.679693 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-24 03:55:41.698699 (Thread-1): finished collecting timing info
2021-11-24 03:55:41.699076 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:55:41.868771 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15bae550>]}
2021-11-24 03:55:41.869690 (Thread-1): 11:55:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.59s]
2021-11-24 03:55:41.870120 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:55:41.870528 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:41.871048 (Thread-1): 11:55:41 | 2 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-24 03:55:41.871757 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:41.872095 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:41.874646 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:55:41.875635 (Thread-1): finished collecting timing info
2021-11-24 03:55:41.889632 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:55:41.891031 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:55:41.891269 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-24 03:55:41.891451 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:43.150812 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-11-24 03:55:43.154192 (Thread-1): finished collecting timing info
2021-11-24 03:55:43.154646 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-24 03:55:43.332259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15bae520>]}
2021-11-24 03:55:43.333179 (Thread-1): 11:55:43 | 2 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 1.46s]
2021-11-24 03:55:43.333597 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:55:43.334484 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:43.335040 (Thread-1): 11:55:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:55:43.336018 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:43.336490 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:43.340403 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:55:43.341257 (Thread-1): finished collecting timing info
2021-11-24 03:55:43.344567 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:55:43.345805 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:55:43.346031 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-11-24 03:55:43.346230 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:55:44.892307 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-11-24 03:55:44.895788 (Thread-1): finished collecting timing info
2021-11-24 03:55:44.896234 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:55:45.069944 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce32a277-c883-4e49-87df-5063b6e5bb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15cbcc10>]}
2021-11-24 03:55:45.070889 (Thread-1): 11:55:45 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.73s]
2021-11-24 03:55:45.071318 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:55:45.073561 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:55:45.074229 (MainThread): 11:55:45 | 
2021-11-24 03:55:45.074533 (MainThread): 11:55:45 | Finished running 1 incremental model, 2 table models in 7.66s.
2021-11-24 03:55:45.074790 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:55:45.074998 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:55:45.081884 (MainThread): 
2021-11-24 03:55:45.082195 (MainThread): Completed successfully
2021-11-24 03:55:45.082445 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-24 03:55:45.082753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1593a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb158a4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb15cc8f10>]}
2021-11-24 03:55:45.083107 (MainThread): Flushing usage events
2021-11-24 03:59:05.303603 (MainThread): Running with dbt=0.21.0
2021-11-24 03:59:06.121363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 03:59:06.122567 (MainThread): Tracking: tracking
2021-11-24 03:59:06.123143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfacebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfcf07970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfcf07a00>]}
2021-11-24 03:59:06.134262 (MainThread): Partial parsing not enabled
2021-11-24 03:59:06.143353 (MainThread): Parsing macros/catalog.sql
2021-11-24 03:59:06.146377 (MainThread): Parsing macros/adapters.sql
2021-11-24 03:59:06.180227 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 03:59:06.183825 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 03:59:06.187900 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 03:59:06.189114 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 03:59:06.191934 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 03:59:06.199977 (MainThread): Parsing macros/core.sql
2021-11-24 03:59:06.202886 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 03:59:06.208102 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 03:59:06.215642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 03:59:06.216933 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 03:59:06.232377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 03:59:06.264377 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 03:59:06.285129 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 03:59:06.286544 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 03:59:06.297375 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 03:59:06.316704 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 03:59:06.329550 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 03:59:06.336897 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 03:59:06.343675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 03:59:06.347111 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 03:59:06.348449 (MainThread): Parsing macros/etc/query.sql
2021-11-24 03:59:06.349289 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 03:59:06.350622 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 03:59:06.358368 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 03:59:06.359754 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 03:59:06.361618 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 03:59:06.362851 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 03:59:06.410444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 03:59:06.411827 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 03:59:06.412757 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 03:59:06.413785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 03:59:06.621277 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:59:06.632889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:06.636097 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:06.679902 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd1051c0>]}
2021-11-24 03:59:06.683545 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd1054f0>]}
2021-11-24 03:59:06.683870 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 03:59:06.684825 (MainThread): 
2021-11-24 03:59:06.685236 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:59:06.686033 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 03:59:06.696739 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 03:59:06.696912 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 03:59:06.697015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 03:59:07.549585 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2021-11-24 03:59:07.552942 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 03:59:07.713771 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 03:59:07.725683 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 03:59:07.725984 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 03:59:07.726204 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 03:59:08.496978 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.77 seconds
2021-11-24 03:59:08.500463 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 03:59:08.665020 (MainThread): 11:59:08 | Concurrency: 1 threads (target='dev')
2021-11-24 03:59:08.665530 (MainThread): 11:59:08 | 
2021-11-24 03:59:08.667498 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 03:59:08.668157 (Thread-1): 11:59:08 | 1 of 2 START incremental model dbt.dates............................. [RUN]
2021-11-24 03:59:08.668734 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:08.669024 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 03:59:08.677886 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:59:08.678682 (Thread-1): finished collecting timing info
2021-11-24 03:59:08.722000 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:08.722290 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 03:59:08.722438 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:59:10.817280 (Thread-1): SQL status: SUCCESS 1 in 2.09 seconds
2021-11-24 03:59:10.834899 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:10.835197 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 03:59:10.946225 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-24 03:59:10.955586 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:10.955884 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 03:59:11.055844 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-24 03:59:11.071527 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.071807 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 03:59:11.165764 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-24 03:59:11.201814 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 03:59:11.204539 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.204722 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 03:59:11.331356 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-24 03:59:11.332436 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.332881 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 03:59:11.718460 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-11-24 03:59:11.719193 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 03:59:11.719636 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 03:59:11.905867 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-24 03:59:11.924644 (Thread-1): finished collecting timing info
2021-11-24 03:59:11.925008 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 03:59:12.096672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd3b1610>]}
2021-11-24 03:59:12.097558 (Thread-1): 11:59:12 | 1 of 2 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.43s]
2021-11-24 03:59:12.097964 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 03:59:12.098350 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.099012 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 03:59:12.099348 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.103593 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 03:59:12.104479 (Thread-1): finished collecting timing info
2021-11-24 03:59:12.105119 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 03:59:12.106000 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:12.106616 (Thread-1): 11:59:12 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 03:59:12.107099 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:12.107323 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:12.119449 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:59:12.120038 (Thread-1): finished collecting timing info
2021-11-24 03:59:12.129299 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 03:59:12.130517 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 03:59:12.130685 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models

select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-11-24 03:59:12.130814 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 03:59:13.282227 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-11-24 03:59:13.284712 (Thread-1): finished collecting timing info
2021-11-24 03:59:13.285076 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 03:59:13.458823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e2d5a-ef38-46b9-aff1-c84900f39417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd3df760>]}
2021-11-24 03:59:13.459713 (Thread-1): 11:59:13 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.35s]
2021-11-24 03:59:13.460137 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 03:59:13.462381 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 03:59:13.462986 (MainThread): 11:59:13 | 
2021-11-24 03:59:13.463280 (MainThread): 11:59:13 | Finished running 1 incremental model, 1 table model in 6.78s.
2021-11-24 03:59:13.463533 (MainThread): Connection 'master' was properly closed.
2021-11-24 03:59:13.463732 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 03:59:13.472020 (MainThread): 
2021-11-24 03:59:13.472340 (MainThread): Completed successfully
2021-11-24 03:59:13.472589 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 03:59:13.473012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd34e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd662880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd662940>]}
2021-11-24 03:59:13.473386 (MainThread): Flushing usage events
2021-11-24 04:00:15.435926 (MainThread): Running with dbt=0.21.0
2021-11-24 04:00:16.241283 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-24 04:00:16.242538 (MainThread): Tracking: tracking
2021-11-24 04:00:16.243069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ceba1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1703940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d17039d0>]}
2021-11-24 04:00:16.254129 (MainThread): Partial parsing not enabled
2021-11-24 04:00:16.263359 (MainThread): Parsing macros/catalog.sql
2021-11-24 04:00:16.266432 (MainThread): Parsing macros/adapters.sql
2021-11-24 04:00:16.300927 (MainThread): Parsing macros/materializations/merge.sql
2021-11-24 04:00:16.304500 (MainThread): Parsing macros/materializations/seed.sql
2021-11-24 04:00:16.308585 (MainThread): Parsing macros/materializations/view.sql
2021-11-24 04:00:16.309802 (MainThread): Parsing macros/materializations/table.sql
2021-11-24 04:00:16.312663 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-24 04:00:16.319979 (MainThread): Parsing macros/core.sql
2021-11-24 04:00:16.322896 (MainThread): Parsing macros/materializations/test.sql
2021-11-24 04:00:16.328134 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-24 04:00:16.336344 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-24 04:00:16.337658 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-24 04:00:16.353712 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-24 04:00:16.385038 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-24 04:00:16.404902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-24 04:00:16.406776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-24 04:00:16.414961 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-24 04:00:16.431081 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-24 04:00:16.442193 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-24 04:00:16.448556 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-24 04:00:16.454443 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-24 04:00:16.457436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-24 04:00:16.458580 (MainThread): Parsing macros/etc/query.sql
2021-11-24 04:00:16.459307 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-24 04:00:16.460489 (MainThread): Parsing macros/etc/datetime.sql
2021-11-24 04:00:16.467225 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-24 04:00:16.468626 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-24 04:00:16.470489 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-24 04:00:16.471722 (MainThread): Parsing macros/adapters/common.sql
2021-11-24 04:00:16.525348 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-24 04:00:16.526933 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-24 04:00:16.528038 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-24 04:00:16.529240 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-24 04:00:16.740288 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 04:00:16.752009 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:16.755278 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:16.794184 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d191b7c0>]}
2021-11-24 04:00:16.798220 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d191b9a0>]}
2021-11-24 04:00:16.798549 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-24 04:00:16.799499 (MainThread): 
2021-11-24 04:00:16.799922 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 04:00:16.800921 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-24 04:00:16.813808 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-24 04:00:16.813978 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-24 04:00:16.814086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-24 04:00:17.675898 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-11-24 04:00:17.680738 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-24 04:00:17.856503 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-24 04:00:17.868216 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-24 04:00:17.868512 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-24 04:00:17.868736 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-24 04:00:18.426581 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-24 04:00:18.430099 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-24 04:00:18.604933 (MainThread): 12:00:18 | Concurrency: 1 threads (target='dev')
2021-11-24 04:00:18.605456 (MainThread): 12:00:18 | 
2021-11-24 04:00:18.607420 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-24 04:00:18.608110 (Thread-1): 12:00:18 | 1 of 2 START incremental model dbt.dates............................. [RUN]
2021-11-24 04:00:18.608680 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:18.608967 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-24 04:00:18.617694 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 04:00:18.618486 (Thread-1): finished collecting timing info
2021-11-24 04:00:18.662298 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:18.662507 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-24 04:00:18.662630 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 04:00:20.448809 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-11-24 04:00:20.468751 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.469056 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-24 04:00:20.584624 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-24 04:00:20.593512 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.593896 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-24 04:00:20.685366 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-24 04:00:20.700734 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.701014 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-24 04:00:20.802308 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-24 04:00:20.837111 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-24 04:00:20.839384 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.839530 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-24 04:00:20.954764 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-24 04:00:20.955846 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:20.956302 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-24 04:00:21.472914 (Thread-1): SQL status: SUCCESS 0 in 0.52 seconds
2021-11-24 04:00:21.473685 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-24 04:00:21.474134 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-24 04:00:21.719339 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-11-24 04:00:21.738055 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.738416 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-24 04:00:21.916734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1d2a160>]}
2021-11-24 04:00:21.917641 (Thread-1): 12:00:21 | 1 of 2 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.31s]
2021-11-24 04:00:21.918069 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-24 04:00:21.918481 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.919152 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-24 04:00:21.919491 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.923711 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-24 04:00:21.924568 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.925182 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-24 04:00:21.926075 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:21.926696 (Thread-1): 12:00:21 | 2 of 2 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-24 04:00:21.927193 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:21.927421 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:21.939415 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 04:00:21.940005 (Thread-1): finished collecting timing info
2021-11-24 04:00:21.949318 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-24 04:00:21.950461 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-24 04:00:21.950615 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models

select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-11-24 04:00:21.950745 (Thread-1): Opening a new connection, currently in state closed
2021-11-24 04:00:23.213560 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-11-24 04:00:23.216977 (Thread-1): finished collecting timing info
2021-11-24 04:00:23.217421 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-24 04:00:23.387752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2f9625-7ac6-4fe5-b981-58bf3b9cbb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1d2a4c0>]}
2021-11-24 04:00:23.388683 (Thread-1): 12:00:23 | 2 of 2 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.46s]
2021-11-24 04:00:23.389117 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-24 04:00:23.391328 (MainThread): Acquiring new snowflake connection "master".
2021-11-24 04:00:23.391964 (MainThread): 12:00:23 | 
2021-11-24 04:00:23.392266 (MainThread): 12:00:23 | Finished running 1 incremental model, 1 table model in 6.59s.
2021-11-24 04:00:23.392527 (MainThread): Connection 'master' was properly closed.
2021-11-24 04:00:23.392736 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-24 04:00:23.400929 (MainThread): 
2021-11-24 04:00:23.401251 (MainThread): Completed successfully
2021-11-24 04:00:23.401495 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-24 04:00:23.401803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d1ea64c0>]}
2021-11-24 04:00:23.402148 (MainThread): Flushing usage events
2021-11-29 01:57:50.677170 (MainThread): Running with dbt=0.21.0
2021-11-29 01:57:53.089867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 01:57:53.092176 (MainThread): Tracking: tracking
2021-11-29 01:57:53.092782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1bcabb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e602970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e602a00>]}
2021-11-29 01:57:53.105896 (MainThread): Partial parsing not enabled
2021-11-29 01:57:53.130760 (MainThread): Parsing macros/catalog.sql
2021-11-29 01:57:53.134524 (MainThread): Parsing macros/adapters.sql
2021-11-29 01:57:53.173498 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 01:57:53.177119 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 01:57:53.181278 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 01:57:53.182506 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 01:57:53.185347 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 01:57:53.195075 (MainThread): Parsing macros/core.sql
2021-11-29 01:57:53.199106 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 01:57:53.206134 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 01:57:53.216546 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 01:57:53.218162 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 01:57:53.235926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 01:57:53.268708 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 01:57:53.292144 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 01:57:53.293932 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 01:57:53.304911 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 01:57:53.324682 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 01:57:53.339714 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 01:57:53.347845 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 01:57:53.355020 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 01:57:53.358670 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 01:57:53.360816 (MainThread): Parsing macros/etc/query.sql
2021-11-29 01:57:53.361770 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 01:57:53.363144 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 01:57:53.372045 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 01:57:53.373928 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 01:57:53.376190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 01:57:53.377625 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 01:57:53.433673 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 01:57:53.435309 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 01:57:53.436849 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 01:57:53.438747 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 01:57:53.651473 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:57:53.661725 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:57:53.664524 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:53.704534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e8095e0>]}
2021-11-29 01:57:53.708983 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e809610>]}
2021-11-29 01:57:53.709327 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 01:57:53.710292 (MainThread): 
2021-11-29 01:57:53.710710 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:57:53.711680 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:57:53.721880 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:57:53.722038 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:57:53.722142 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 01:57:55.008904 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.29 seconds
2021-11-29 01:57:55.012243 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:57:55.180653 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 01:57:55.191906 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 01:57:55.192185 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 01:57:55.192474 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:57:55.956083 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.76 seconds
2021-11-29 01:57:55.960074 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 01:57:56.129027 (MainThread): 09:57:56 | Concurrency: 1 threads (target='dev')
2021-11-29 01:57:56.129557 (MainThread): 09:57:56 | 
2021-11-29 01:57:56.132059 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 01:57:56.132788 (Thread-1): 09:57:56 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 01:57:56.133533 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:56.133893 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 01:57:56.143349 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:57:56.146622 (Thread-1): finished collecting timing info
2021-11-29 01:57:56.201172 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:56.201400 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 01:57:56.201570 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:57:58.453786 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2021-11-29 01:57:58.471324 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.471610 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 01:57:58.578174 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:57:58.587440 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.587756 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 01:57:58.686093 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 01:57:58.693540 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.693754 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 01:57:58.786867 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 01:57:58.816312 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:57:58.818812 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.818978 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 01:57:58.982473 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-11-29 01:57:58.983554 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:58.984023 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 01:57:59.938989 (Thread-1): SQL status: SUCCESS 5 in 0.95 seconds
2021-11-29 01:57:59.939731 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:57:59.940042 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 01:58:00.257146 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-11-29 01:58:00.283044 (Thread-1): finished collecting timing info
2021-11-29 01:58:00.283366 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 01:58:00.459539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1edf3370>]}
2021-11-29 01:58:00.460301 (Thread-1): 09:58:00 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.33s]
2021-11-29 01:58:00.460732 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 01:58:00.461343 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:00.462453 (Thread-1): 09:58:00 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 01:58:00.463467 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:58:00.464011 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:00.470054 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:58:00.471209 (Thread-1): finished collecting timing info
2021-11-29 01:58:00.485424 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:58:00.486824 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:58:00.487033 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 01:58:00.487214 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:58:01.627666 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-11-29 01:58:01.631387 (Thread-1): finished collecting timing info
2021-11-29 01:58:01.631908 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 01:58:01.801494 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ee59c70>]}
2021-11-29 01:58:01.802419 (Thread-1): 09:58:01 | 2 of 3 OK created table model dbt.first_model........................ [SUCCESS 1 in 1.34s]
2021-11-29 01:58:01.802855 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:58:01.804645 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:01.805472 (Thread-1): 09:58:01 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 01:58:01.806130 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:58:01.806427 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:01.810707 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:58:01.811664 (Thread-1): finished collecting timing info
2021-11-29 01:58:01.814815 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:58:01.816174 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:58:01.816409 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model
where id = 1
      );
2021-11-29 01:58:01.816621 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:58:03.472868 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-11-29 01:58:03.476273 (Thread-1): finished collecting timing info
2021-11-29 01:58:03.476751 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 01:58:03.864584 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d54fbf0-af3d-4530-8f8e-df0f05d50903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ef9bd00>]}
2021-11-29 01:58:03.865558 (Thread-1): 09:58:03 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.06s]
2021-11-29 01:58:03.866000 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:58:03.868171 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:58:03.868871 (MainThread): 09:58:03 | 
2021-11-29 01:58:03.869221 (MainThread): 09:58:03 | Finished running 1 incremental model, 2 table models in 10.16s.
2021-11-29 01:58:03.869503 (MainThread): Connection 'master' was properly closed.
2021-11-29 01:58:03.869730 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 01:58:03.877260 (MainThread): 
2021-11-29 01:58:03.877622 (MainThread): Completed successfully
2021-11-29 01:58:03.877895 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 01:58:03.878237 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e618820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e846250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ef9bd60>]}
2021-11-29 01:58:03.878619 (MainThread): Flushing usage events
2021-11-29 01:59:31.947508 (MainThread): Running with dbt=0.21.0
2021-11-29 01:59:33.083278 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 01:59:33.084729 (MainThread): Tracking: tracking
2021-11-29 01:59:33.085268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ce4a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d07029a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0702a30>]}
2021-11-29 01:59:33.097855 (MainThread): Partial parsing not enabled
2021-11-29 01:59:33.109032 (MainThread): Parsing macros/catalog.sql
2021-11-29 01:59:33.112484 (MainThread): Parsing macros/adapters.sql
2021-11-29 01:59:33.149208 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 01:59:33.153325 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 01:59:33.158370 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 01:59:33.159828 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 01:59:33.163118 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 01:59:33.171664 (MainThread): Parsing macros/core.sql
2021-11-29 01:59:33.176114 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 01:59:33.183558 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 01:59:33.193644 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 01:59:33.195261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 01:59:33.212913 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 01:59:33.245814 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 01:59:33.267284 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 01:59:33.268976 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 01:59:33.279867 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 01:59:33.299114 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 01:59:33.312185 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 01:59:33.319813 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 01:59:33.326656 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 01:59:33.330185 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 01:59:33.331571 (MainThread): Parsing macros/etc/query.sql
2021-11-29 01:59:33.332386 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 01:59:33.333565 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 01:59:33.343726 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 01:59:33.345551 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 01:59:33.347484 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 01:59:33.348715 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 01:59:33.399518 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 01:59:33.401271 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 01:59:33.402582 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 01:59:33.404268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 01:59:33.642889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:33.656093 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:33.660680 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:33.705250 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d760>]}
2021-11-29 01:59:33.709540 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d9a0>]}
2021-11-29 01:59:33.709826 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 01:59:33.710854 (MainThread): 
2021-11-29 01:59:33.711401 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:59:33.712329 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:59:33.726200 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:59:33.726397 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:59:33.726582 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 01:59:34.662444 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2021-11-29 01:59:34.665151 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:59:34.845467 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 01:59:34.849364 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 01:59:34.849685 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 01:59:34.849944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 01:59:35.554034 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.70 seconds
2021-11-29 01:59:35.557430 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 01:59:35.729879 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.730472 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.730840 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_dbt_dev"
2021-11-29 01:59:35.738056 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_dbt_dev".
2021-11-29 01:59:35.738316 (ThreadPoolExecutor-0_0): On create_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt_dbt_dev"} */
create schema if not exists analytics.dbt_dbt_dev
2021-11-29 01:59:35.738539 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 01:59:36.323908 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.59 seconds
2021-11-29 01:59:36.325785 (ThreadPoolExecutor-0_0): On create_analytics_dbt_dbt_dev: Close
2021-11-29 01:59:36.511049 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 01:59:36.523296 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 01:59:36.523754 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 01:59:36.524270 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:59:37.071214 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.55 seconds
2021-11-29 01:59:37.073905 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 01:59:37.234502 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 01:59:37.237561 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 01:59:37.237872 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 01:59:37.238126 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 01:59:37.792977 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.55 seconds
2021-11-29 01:59:37.809373 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 01:59:37.977333 (MainThread): 09:59:37 | Concurrency: 1 threads (target='dev')
2021-11-29 01:59:37.977764 (MainThread): 09:59:37 | 
2021-11-29 01:59:37.979215 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 01:59:37.979682 (Thread-1): 09:59:37 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 01:59:37.980161 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:37.980401 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 01:59:37.988587 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:59:37.989358 (Thread-1): finished collecting timing info
2021-11-29 01:59:38.034302 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:38.034510 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 01:59:38.034640 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:40.241111 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2021-11-29 01:59:40.259256 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.259646 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 01:59:40.370722 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:59:40.378780 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.379052 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 01:59:40.486859 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 01:59:40.500353 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.500612 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 01:59:40.604279 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 01:59:40.640284 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 01:59:40.642869 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.643030 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 01:59:40.780336 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 01:59:40.781098 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:40.781424 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 01:59:41.424816 (Thread-1): SQL status: SUCCESS 0 in 0.64 seconds
2021-11-29 01:59:41.425353 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 01:59:41.425663 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 01:59:41.623238 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 01:59:41.641506 (Thread-1): finished collecting timing info
2021-11-29 01:59:41.642008 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 01:59:41.822579 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c1cdf0>]}
2021-11-29 01:59:41.823456 (Thread-1): 09:59:41 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.84s]
2021-11-29 01:59:41.823776 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 01:59:41.824063 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:41.824419 (Thread-1): 09:59:41 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 01:59:41.824890 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:41.825120 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:41.828752 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:59:41.829602 (Thread-1): finished collecting timing info
2021-11-29 01:59:41.841598 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 01:59:41.842741 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 01:59:41.842922 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_dbt_dev.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 01:59:41.843067 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:43.016768 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-11-29 01:59:43.020411 (Thread-1): finished collecting timing info
2021-11-29 01:59:43.021382 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 01:59:43.185436 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c59fa0>]}
2021-11-29 01:59:43.185969 (Thread-1): 09:59:43 | 2 of 3 OK created table model dbt_dbt_dev.first_model................ [SUCCESS 1 in 1.36s]
2021-11-29 01:59:43.186193 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 01:59:43.186969 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:43.187283 (Thread-1): 09:59:43 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 01:59:43.187618 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:43.187779 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:43.190058 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:59:43.190739 (Thread-1): finished collecting timing info
2021-11-29 01:59:43.192655 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 01:59:43.193434 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 01:59:43.193561 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt_dbt_dev.first_model
where id = 1
      );
2021-11-29 01:59:43.193673 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 01:59:44.410816 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-11-29 01:59:44.413966 (Thread-1): finished collecting timing info
2021-11-29 01:59:44.414374 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 01:59:44.570669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07f3294-0be9-4887-b7e9-96ad6256f77c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c59ac0>]}
2021-11-29 01:59:44.571341 (Thread-1): 09:59:44 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.38s]
2021-11-29 01:59:44.571658 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 01:59:44.573274 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 01:59:44.573899 (MainThread): 09:59:44 | 
2021-11-29 01:59:44.574182 (MainThread): 09:59:44 | Finished running 1 incremental model, 2 table models in 10.86s.
2021-11-29 01:59:44.574458 (MainThread): Connection 'master' was properly closed.
2021-11-29 01:59:44.574826 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 01:59:44.581670 (MainThread): 
2021-11-29 01:59:44.582051 (MainThread): Completed successfully
2021-11-29 01:59:44.582380 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 01:59:44.582842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d0c0c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d081d1c0>]}
2021-11-29 01:59:44.583494 (MainThread): Flushing usage events
2021-11-29 02:05:37.484301 (MainThread): Running with dbt=0.21.0
2021-11-29 02:05:38.936691 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:05:38.938850 (MainThread): Tracking: tracking
2021-11-29 02:05:38.939678 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec804acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83701a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83701af0>]}
2021-11-29 02:05:38.952754 (MainThread): Partial parsing not enabled
2021-11-29 02:05:38.966394 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:05:38.969793 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:05:39.009347 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:05:39.013007 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:05:39.018467 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:05:39.019854 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:05:39.022751 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:05:39.031705 (MainThread): Parsing macros/core.sql
2021-11-29 02:05:39.035233 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:05:39.042532 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:05:39.053054 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:05:39.054745 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:05:39.071609 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:05:39.104537 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:05:39.127047 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:05:39.129458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:05:39.139142 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:05:39.160070 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:05:39.174786 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:05:39.182206 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:05:39.189545 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:05:39.193139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:05:39.194484 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:05:39.195561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:05:39.197441 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:05:39.205348 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:05:39.207282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:05:39.210030 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:05:39.211489 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:05:39.268807 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:05:39.270711 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:05:39.271860 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:05:39.273090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:05:39.520846 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:05:39.534688 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:05:39.538321 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:39.583247 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:05:39.587588 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec838057c0>]}
2021-11-29 02:05:39.593467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83805a90>]}
2021-11-29 02:05:39.594041 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:05:39.595266 (MainThread): 
2021-11-29 02:05:39.595639 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:05:39.596444 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:05:39.609032 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:05:39.609236 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:05:39.609366 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:05:40.594233 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.98 seconds
2021-11-29 02:05:40.598639 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:05:40.767506 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:05:40.770850 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:05:40.771216 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:05:40.771643 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 02:05:41.522989 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.75 seconds
2021-11-29 02:05:41.526469 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:05:41.725300 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:05:41.737069 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:05:41.737375 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:05:41.737592 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:05:42.298424 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.56 seconds
2021-11-29 02:05:42.302063 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:05:42.489842 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:05:42.493413 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:05:42.493724 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 02:05:42.493978 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:05:43.038753 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.54 seconds
2021-11-29 02:05:43.042098 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 02:05:43.214844 (MainThread): 10:05:43 | Concurrency: 1 threads (target='dev')
2021-11-29 02:05:43.215274 (MainThread): 10:05:43 | 
2021-11-29 02:05:43.216872 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:05:43.217437 (Thread-1): 10:05:43 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:05:43.218014 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:43.218306 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:05:43.226651 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:05:43.227369 (Thread-1): finished collecting timing info
2021-11-29 02:05:43.270218 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:43.270425 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:05:43.270555 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:05:44.870554 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-11-29 02:05:44.887817 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:44.888109 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:05:44.998876 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:05:45.008597 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.008971 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:05:45.114371 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:05:45.130113 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.130410 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:05:45.234963 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:05:45.270650 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:05:45.275464 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.275679 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:05:45.387587 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-11-29 02:05:45.388667 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.389126 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:05:45.875351 (Thread-1): SQL status: SUCCESS 0 in 0.49 seconds
2021-11-29 02:05:45.876150 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:05:45.876484 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:05:46.065222 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:05:46.084074 (Thread-1): finished collecting timing info
2021-11-29 02:05:46.084429 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:05:46.260914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83b04220>]}
2021-11-29 02:05:46.261843 (Thread-1): 10:05:46 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.04s]
2021-11-29 02:05:46.262275 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:05:46.262689 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.263206 (Thread-1): 10:05:46 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 02:05:46.263806 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:05:46.264078 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.279404 (Thread-1): finished collecting timing info
2021-11-29 02:05:46.280229 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.295257 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024dc0d1-ca72-40ba-a506-f03188fa60a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd2640>]}
2021-11-29 02:05:46.295748 (Thread-1): 10:05:46 | 2 of 3 ERROR creating table model dbt_dbt_dev.first_model............ [ERROR in 0.03s]
2021-11-29 02:05:46.295982 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:05:46.296708 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:05:46.297250 (Thread-1): 10:05:46 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:05:46.297547 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:05:46.299162 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:05:46.299723 (MainThread): 10:05:46 | 
2021-11-29 02:05:46.299985 (MainThread): 10:05:46 | Finished running 1 incremental model, 2 table models in 6.70s.
2021-11-29 02:05:46.300188 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:05:46.300362 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:05:46.305868 (MainThread): 
2021-11-29 02:05:46.306126 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:05:46.306306 (MainThread): 
2021-11-29 02:05:46.306473 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.306626 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:05:46.306772 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:05:46.306914 (MainThread):   
2021-11-29 02:05:46.307053 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.307226 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:05:46.307368 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:05:46.307584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8383d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec83cd9d60>]}
2021-11-29 02:05:46.307827 (MainThread): Flushing usage events
2021-11-29 02:07:00.901280 (MainThread): Running with dbt=0.21.0
2021-11-29 02:07:01.740646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:07:01.742384 (MainThread): Tracking: tracking
2021-11-29 02:07:01.742912 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc83acfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf05a60>]}
2021-11-29 02:07:01.754093 (MainThread): Partial parsing not enabled
2021-11-29 02:07:01.763845 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:07:01.767099 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:07:01.802760 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:07:01.806339 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:07:01.810491 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:07:01.811732 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:07:01.814580 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:07:01.822502 (MainThread): Parsing macros/core.sql
2021-11-29 02:07:01.825937 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:07:01.832070 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:07:01.841075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:07:01.843362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:07:01.859337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:07:01.888926 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:07:01.911785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:07:01.913806 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:07:01.923358 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:07:01.941864 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:07:01.954870 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:07:01.962187 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:07:01.968565 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:07:01.971585 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:07:01.972756 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:07:01.973659 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:07:01.975906 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:07:01.982966 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:07:01.984672 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:07:01.986551 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:07:01.987799 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:07:02.038614 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:07:02.040230 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:07:02.041305 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:07:02.042491 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:07:02.253543 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:07:02.264818 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:07:02.267733 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:02.309567 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:07:02.313968 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb009190>]}
2021-11-29 02:07:02.319252 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb0097f0>]}
2021-11-29 02:07:02.319964 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:07:02.321101 (MainThread): 
2021-11-29 02:07:02.321464 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:07:02.322329 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:07:02.333724 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:07:02.333900 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:07:02.334020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:07:03.188641 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.85 seconds
2021-11-29 02:07:03.192000 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:07:03.356977 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:07:03.360822 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:07:03.361132 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:07:03.361401 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-11-29 02:07:03.924422 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.56 seconds
2021-11-29 02:07:03.927848 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:07:04.116005 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:07:04.127838 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_dbt_dev".
2021-11-29 02:07:04.128133 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt_dbt_dev"} */

    show terse objects in analytics.dbt_dbt_dev
2021-11-29 02:07:04.128348 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:07:04.876512 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.75 seconds
2021-11-29 02:07:04.879973 (ThreadPoolExecutor-1_0): On list_analytics_dbt_dbt_dev: Close
2021-11-29 02:07:05.043839 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:07:05.047402 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:07:05.047707 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:07:05.047951 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:07:05.595201 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.55 seconds
2021-11-29 02:07:05.596445 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:07:05.762143 (MainThread): 10:07:05 | Concurrency: 1 threads (target='dev')
2021-11-29 02:07:05.762657 (MainThread): 10:07:05 | 
2021-11-29 02:07:05.764581 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:07:05.765243 (Thread-1): 10:07:05 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:07:05.765812 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:05.766089 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:07:05.774920 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:07:05.775706 (Thread-1): finished collecting timing info
2021-11-29 02:07:05.819889 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:05.820092 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:07:05.820220 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:07:07.432869 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-11-29 02:07:07.450475 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.450774 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:07:07.562183 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:07:07.571570 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.571867 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:07:07.674667 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:07:07.689043 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.689338 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:07:07.790486 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:07:07.827370 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:07:07.830798 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.830978 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:07:07.972471 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 02:07:07.973539 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:07.973991 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:07:08.543218 (Thread-1): SQL status: SUCCESS 0 in 0.57 seconds
2021-11-29 02:07:08.543859 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:07:08.544175 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:07:08.737298 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:07:08.756294 (Thread-1): finished collecting timing info
2021-11-29 02:07:08.756665 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:07:08.931073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb475940>]}
2021-11-29 02:07:08.932432 (Thread-1): 10:07:08 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.17s]
2021-11-29 02:07:08.934617 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:07:08.935510 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.936460 (Thread-1): 10:07:08 | 2 of 3 START table model dbt_dbt_dev.first_model..................... [RUN]
2021-11-29 02:07:08.937541 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:07:08.937955 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.948171 (Thread-1): finished collecting timing info
2021-11-29 02:07:08.949518 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.965102 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a966fb-54ac-4361-86a6-ad3838c1ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb830250>]}
2021-11-29 02:07:08.965835 (Thread-1): 10:07:08 | 2 of 3 ERROR creating table model dbt_dbt_dev.first_model............ [ERROR in 0.03s]
2021-11-29 02:07:08.966176 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:07:08.967193 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:07:08.967755 (Thread-1): 10:07:08 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:07:08.968114 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:07:08.969864 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:07:08.970550 (MainThread): 10:07:08 | 
2021-11-29 02:07:08.970817 (MainThread): 10:07:08 | Finished running 1 incremental model, 2 table models in 6.65s.
2021-11-29 02:07:08.971031 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:07:08.971202 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:07:08.978046 (MainThread): 
2021-11-29 02:07:08.978327 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:07:08.978530 (MainThread): 
2021-11-29 02:07:08.978721 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.978894 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:07:08.979055 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:07:08.979211 (MainThread):   
2021-11-29 02:07:08.979506 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.979691 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:07:08.979878 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:07:08.980141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb01e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcaf56220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dcb52c220>]}
2021-11-29 02:07:08.980444 (MainThread): Flushing usage events
2021-11-29 02:08:14.307842 (MainThread): Running with dbt=0.21.0
2021-11-29 02:08:15.259210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:08:15.260578 (MainThread): Tracking: tracking
2021-11-29 02:08:15.261207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ccebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef049a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef04a30>]}
2021-11-29 02:08:15.274119 (MainThread): Partial parsing not enabled
2021-11-29 02:08:15.285376 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:08:15.289000 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:08:15.326479 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:08:15.330130 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:08:15.334229 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:08:15.335448 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:08:15.338288 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:08:15.346230 (MainThread): Parsing macros/core.sql
2021-11-29 02:08:15.349592 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:08:15.355639 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:08:15.365071 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:08:15.366684 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:08:15.383161 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:08:15.414527 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:08:15.435921 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:08:15.437592 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:08:15.447393 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:08:15.466346 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:08:15.479413 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:08:15.486873 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:08:15.493327 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:08:15.496612 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:08:15.497799 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:08:15.498616 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:08:15.499779 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:08:15.507271 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:08:15.508719 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:08:15.511129 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:08:15.512380 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:08:15.565031 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:08:15.566624 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:08:15.567704 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:08:15.568916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:08:15.804297 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:08:15.816673 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:08:15.820295 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:15.861966 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:08:15.866932 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c6a0>]}
2021-11-29 02:08:15.873042 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c940>]}
2021-11-29 02:08:15.873538 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:08:15.874675 (MainThread): 
2021-11-29 02:08:15.875039 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:08:15.875814 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:08:15.887444 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:08:15.887639 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:08:15.887764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:08:16.768555 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.88 seconds
2021-11-29 02:08:16.770369 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:08:16.933677 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:08:16.940104 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:08:16.940307 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:08:16.940430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:08:17.680501 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.74 seconds
2021-11-29 02:08:17.681788 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:08:17.838154 (MainThread): 10:08:17 | Concurrency: 1 threads (target='dev')
2021-11-29 02:08:17.838386 (MainThread): 10:08:17 | 
2021-11-29 02:08:17.839186 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:08:17.839485 (Thread-1): 10:08:17 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:08:17.839801 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:17.839984 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:08:17.844662 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:08:17.845736 (Thread-1): finished collecting timing info
2021-11-29 02:08:17.882905 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:17.883129 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:08:17.883269 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:08:19.313845 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-11-29 02:08:19.333711 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.334002 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:08:19.459787 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-11-29 02:08:19.469170 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.469477 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:08:19.576728 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:08:19.592894 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.593199 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:08:19.695699 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:08:19.723257 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:08:19.725549 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.725696 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:08:19.851851 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:08:19.852290 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:19.852449 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:08:20.540793 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-11-29 02:08:20.541042 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:08:20.541162 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:08:20.724634 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-11-29 02:08:20.733166 (Thread-1): finished collecting timing info
2021-11-29 02:08:20.733391 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:08:20.909814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5fbae1c0>]}
2021-11-29 02:08:20.910236 (Thread-1): 10:08:20 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.07s]
2021-11-29 02:08:20.910414 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:08:20.910574 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.910858 (Thread-1): 10:08:20 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 02:08:20.911128 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:08:20.911258 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.914581 (Thread-1): finished collecting timing info
2021-11-29 02:08:20.914941 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.920683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdf1202-1707-4474-bc4c-be9af5e4ddd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5fbd3e80>]}
2021-11-29 02:08:20.921030 (Thread-1): 10:08:20 | 2 of 3 ERROR creating table model dbt.first_model.................... [ERROR in 0.01s]
2021-11-29 02:08:20.921193 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:08:20.921787 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:08:20.922032 (Thread-1): 10:08:20 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:08:20.922181 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:08:20.922992 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:08:20.923315 (MainThread): 10:08:20 | 
2021-11-29 02:08:20.923460 (MainThread): 10:08:20 | Finished running 1 incremental model, 2 table models in 5.05s.
2021-11-29 02:08:20.923582 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:08:20.923679 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:08:20.927643 (MainThread): 
2021-11-29 02:08:20.927832 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:08:20.927962 (MainThread): 
2021-11-29 02:08:20.928106 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928221 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:08:20.928326 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:08:20.928429 (MainThread):   
2021-11-29 02:08:20.928532 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928635 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:08:20.928756 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:08:20.928934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5f91c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ef6cbe0>]}
2021-11-29 02:08:20.929144 (MainThread): Flushing usage events
2021-11-29 02:10:20.448691 (MainThread): Running with dbt=0.21.0
2021-11-29 02:10:21.349169 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:10:21.350682 (MainThread): Tracking: tracking
2021-11-29 02:10:21.351310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7774c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77977c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77977c9d0>]}
2021-11-29 02:10:21.362100 (MainThread): Partial parsing not enabled
2021-11-29 02:10:21.371898 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:10:21.375153 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:10:21.409787 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:10:21.413440 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:10:21.417530 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:10:21.418739 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:10:21.421597 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:10:21.429489 (MainThread): Parsing macros/core.sql
2021-11-29 02:10:21.432827 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:10:21.438860 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:10:21.448316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:10:21.450874 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:10:21.466926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:10:21.498660 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:10:21.520286 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:10:21.521923 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:10:21.531174 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:10:21.547597 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:10:21.560598 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:10:21.567116 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:10:21.573266 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:10:21.576520 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:10:21.577754 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:10:21.578538 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:10:21.579767 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:10:21.586915 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:10:21.588400 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:10:21.590438 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:10:21.591760 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:10:21.645010 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:10:21.646602 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:10:21.647668 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:10:21.648847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:10:21.860136 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:10:21.871972 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:10:21.874904 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:21.911010 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:10:21.915132 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d850>]}
2021-11-29 02:10:21.919368 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d9a0>]}
2021-11-29 02:10:21.919640 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:10:21.920542 (MainThread): 
2021-11-29 02:10:21.920974 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:10:21.921810 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:10:21.932892 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:10:21.933077 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:10:21.933202 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:10:22.977316 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.04 seconds
2021-11-29 02:10:22.980770 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:10:23.209531 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:10:23.221335 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:10:23.221642 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:10:23.221871 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:10:24.151068 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.93 seconds
2021-11-29 02:10:24.154160 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:10:24.320054 (MainThread): 10:10:24 | Concurrency: 1 threads (target='dev')
2021-11-29 02:10:24.320579 (MainThread): 10:10:24 | 
2021-11-29 02:10:24.322549 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:10:24.323251 (Thread-1): 10:10:24 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:10:24.323823 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:24.324109 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:10:24.332811 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:10:24.335140 (Thread-1): finished collecting timing info
2021-11-29 02:10:24.389667 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:24.389870 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:10:24.389995 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:10:26.980312 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2021-11-29 02:10:26.997488 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:26.997801 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:10:27.265616 (Thread-1): SQL status: SUCCESS 28 in 0.27 seconds
2021-11-29 02:10:27.279792 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.280367 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:10:27.529959 (Thread-1): SQL status: SUCCESS 28 in 0.25 seconds
2021-11-29 02:10:27.545868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.546194 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:10:27.716939 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-11-29 02:10:27.753391 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:10:27.755957 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:27.756122 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:10:28.123869 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-11-29 02:10:28.124962 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:28.125359 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:10:28.815934 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-11-29 02:10:28.816474 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:10:28.816788 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:10:29.018426 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 02:10:29.036435 (Thread-1): finished collecting timing info
2021-11-29 02:10:29.036756 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:10:29.362194 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779bab280>]}
2021-11-29 02:10:29.363118 (Thread-1): 10:10:29 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 5.04s]
2021-11-29 02:10:29.363554 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:10:29.363970 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.364499 (Thread-1): 10:10:29 | 2 of 3 START table model dbt.first_model............................. [RUN]
2021-11-29 02:10:29.365513 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:10:29.365847 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.373032 (Thread-1): finished collecting timing info
2021-11-29 02:10:29.373902 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.390775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748bd4ea-878e-4b31-9dc0-4d69e4cb30da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779bab160>]}
2021-11-29 02:10:29.391900 (Thread-1): 10:10:29 | 2 of 3 ERROR creating table model dbt.first_model.................... [ERROR in 0.03s]
2021-11-29 02:10:29.392415 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:10:29.393447 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:10:29.394146 (Thread-1): 10:10:29 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:10:29.394551 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:10:29.396515 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:10:29.397187 (MainThread): 10:10:29 | 
2021-11-29 02:10:29.397518 (MainThread): 10:10:29 | Finished running 1 incremental model, 2 table models in 7.48s.
2021-11-29 02:10:29.397786 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:10:29.398005 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:10:29.405099 (MainThread): 
2021-11-29 02:10:29.405428 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:10:29.405674 (MainThread): 
2021-11-29 02:10:29.405901 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.406108 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:10:29.406311 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:10:29.406501 (MainThread):   
2021-11-29 02:10:29.406661 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.406821 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:10:29.407004 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:10:29.407267 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779847f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa779747cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77981d700>]}
2021-11-29 02:10:29.407569 (MainThread): Flushing usage events
2021-11-29 02:12:32.033215 (MainThread): Running with dbt=0.21.0
2021-11-29 02:12:32.833229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:12:32.834907 (MainThread): Tracking: tracking
2021-11-29 02:12:32.835435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8abfcebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2600910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26009a0>]}
2021-11-29 02:12:32.846141 (MainThread): Partial parsing not enabled
2021-11-29 02:12:32.855707 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:12:32.858774 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:12:32.891209 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:12:32.894812 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:12:32.898892 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:12:32.900108 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:12:32.902959 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:12:32.910936 (MainThread): Parsing macros/core.sql
2021-11-29 02:12:32.914277 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:12:32.920334 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:12:32.930302 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:12:32.932100 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:12:32.949768 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:12:32.980857 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:12:33.002056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:12:33.003968 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:12:33.013703 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:12:33.031676 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:12:33.043869 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:12:33.050554 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:12:33.056816 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:12:33.060002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:12:33.061230 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:12:33.062007 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:12:33.063241 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:12:33.070458 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:12:33.071935 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:12:33.073906 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:12:33.075441 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:12:33.120638 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:12:33.122040 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:12:33.122954 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:12:33.124475 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:12:33.338274 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:12:33.348760 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:12:33.351749 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:33.386647 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:12:33.390598 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f26d0>]}
2021-11-29 02:12:33.394338 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f2f70>]}
2021-11-29 02:12:33.394667 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:12:33.395608 (MainThread): 
2021-11-29 02:12:33.396095 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:12:33.396930 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:12:33.407757 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:12:33.407932 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:12:33.408046 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:12:34.472390 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.06 seconds
2021-11-29 02:12:34.475746 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:12:34.650605 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:12:34.665845 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:12:34.666204 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:12:34.666469 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:12:35.229284 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-29 02:12:35.232955 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:12:35.398440 (MainThread): 10:12:35 | Concurrency: 1 threads (target='dev')
2021-11-29 02:12:35.399000 (MainThread): 10:12:35 | 
2021-11-29 02:12:35.400979 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:12:35.401577 (Thread-1): 10:12:35 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:12:35.402141 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:35.402420 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:12:35.411101 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:12:35.411913 (Thread-1): finished collecting timing info
2021-11-29 02:12:35.455940 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:35.456146 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:12:35.456272 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:12:38.354189 (Thread-1): SQL status: SUCCESS 1 in 2.90 seconds
2021-11-29 02:12:38.371551 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.371838 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:12:38.474072 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:12:38.480070 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.480361 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:12:38.588065 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:12:38.604008 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.604292 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:12:38.709723 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:12:38.745505 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:12:38.748041 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.748199 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:12:38.865051 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-29 02:12:38.866115 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:38.866579 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:12:39.276005 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-11-29 02:12:39.276763 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:12:39.277225 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:12:39.476077 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-11-29 02:12:39.494632 (Thread-1): finished collecting timing info
2021-11-29 02:12:39.494940 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:12:39.659244 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bd9820>]}
2021-11-29 02:12:39.660157 (Thread-1): 10:12:39 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.26s]
2021-11-29 02:12:39.660585 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:12:39.660990 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.661496 (Thread-1): 10:12:39 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:12:39.662359 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:12:39.662704 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.668655 (Thread-1): finished collecting timing info
2021-11-29 02:12:39.669215 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.671732 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f35ac69-0138-440f-a0a5-09602ce3179a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bd9e20>]}
2021-11-29 02:12:39.672250 (Thread-1): 10:12:39 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:12:39.672517 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:12:39.673343 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:12:39.673631 (Thread-1): 10:12:39 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:12:39.673867 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:12:39.675294 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:12:39.675767 (MainThread): 10:12:39 | 
2021-11-29 02:12:39.675985 (MainThread): 10:12:39 | Finished running 1 incremental model, 2 table models in 6.28s.
2021-11-29 02:12:39.676172 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:12:39.676322 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:12:39.681737 (MainThread): 
2021-11-29 02:12:39.681980 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:12:39.682162 (MainThread): 
2021-11-29 02:12:39.682324 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.682474 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:12:39.682617 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:12:39.682780 (MainThread):   
2021-11-29 02:12:39.682918 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.683056 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:12:39.683213 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:12:39.683446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac26f2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2847f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2bc85b0>]}
2021-11-29 02:12:39.683708 (MainThread): Flushing usage events
2021-11-29 02:21:41.085128 (MainThread): Running with dbt=0.21.0
2021-11-29 02:21:41.886991 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:21:41.888706 (MainThread): Tracking: tracking
2021-11-29 02:21:41.889236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda44a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda677e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda677e9d0>]}
2021-11-29 02:21:41.900178 (MainThread): Partial parsing not enabled
2021-11-29 02:21:41.909413 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:21:41.912550 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:21:41.947390 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:21:41.950993 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:21:41.955115 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:21:41.956361 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:21:41.959215 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:21:41.967217 (MainThread): Parsing macros/core.sql
2021-11-29 02:21:41.970581 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:21:41.976664 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:21:41.985446 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:21:41.987291 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:21:42.004600 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:21:42.034908 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:21:42.056242 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:21:42.057891 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:21:42.067287 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:21:42.084125 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:21:42.095828 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:21:42.102153 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:21:42.108007 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:21:42.111133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:21:42.112300 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:21:42.113035 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:21:42.114201 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:21:42.120951 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:21:42.122437 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:21:42.124317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:21:42.125686 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:21:42.170159 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:21:42.171484 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:21:42.172427 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:21:42.173472 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:21:42.396242 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:21:42.406977 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:21:42.409802 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:42.444901 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:21:42.448891 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d7c0>]}
2021-11-29 02:21:42.452751 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d9a0>]}
2021-11-29 02:21:42.453076 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:21:42.454025 (MainThread): 
2021-11-29 02:21:42.454443 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:21:42.455276 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:21:42.467223 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:21:42.467401 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:21:42.467512 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:21:43.339647 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.87 seconds
2021-11-29 02:21:43.343007 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:21:43.516836 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:21:43.529004 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:21:43.529333 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:21:43.529570 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:21:44.070598 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.54 seconds
2021-11-29 02:21:44.074122 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:21:44.226759 (MainThread): 10:21:44 | Concurrency: 1 threads (target='dev')
2021-11-29 02:21:44.227311 (MainThread): 10:21:44 | 
2021-11-29 02:21:44.229059 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:21:44.229633 (Thread-1): 10:21:44 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:21:44.230234 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:44.230536 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:21:44.239039 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:21:44.239789 (Thread-1): finished collecting timing info
2021-11-29 02:21:44.283241 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:44.283454 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:21:44.283588 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:21:45.993482 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-11-29 02:21:46.011418 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.011742 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:21:46.144657 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-11-29 02:21:46.154218 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.154547 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:21:46.251982 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:21:46.268059 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.268349 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:21:46.377484 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:21:46.412922 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:21:46.415446 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.415614 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:21:46.544663 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:21:46.545761 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:46.546220 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:21:47.019594 (Thread-1): SQL status: SUCCESS 0 in 0.47 seconds
2021-11-29 02:21:47.020208 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:21:47.020997 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:21:47.206992 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:21:47.226178 (Thread-1): finished collecting timing info
2021-11-29 02:21:47.226566 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:21:47.406252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6d539a0>]}
2021-11-29 02:21:47.407576 (Thread-1): 10:21:47 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.18s]
2021-11-29 02:21:47.408232 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:21:47.408875 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.409672 (Thread-1): 10:21:47 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:21:47.411197 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:21:47.411857 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.420272 (Thread-1): finished collecting timing info
2021-11-29 02:21:47.421201 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.424312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0e4f56-72ea-44ff-94fa-8bc2a8cb5dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6d53dc0>]}
2021-11-29 02:21:47.424950 (Thread-1): 10:21:47 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:21:47.425271 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:21:47.426080 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:21:47.426427 (Thread-1): 10:21:47 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:21:47.426713 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:21:47.428221 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:21:47.428759 (MainThread): 10:21:47 | 
2021-11-29 02:21:47.429013 (MainThread): 10:21:47 | Finished running 1 incremental model, 2 table models in 4.97s.
2021-11-29 02:21:47.429234 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:21:47.429414 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:21:47.435315 (MainThread): 
2021-11-29 02:21:47.435592 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:21:47.435798 (MainThread): 
2021-11-29 02:21:47.435991 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.436172 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:21:47.436335 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:21:47.436500 (MainThread):   
2021-11-29 02:21:47.436662 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.436825 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:21:47.437008 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:21:47.437271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda6847f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda676aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda681d220>]}
2021-11-29 02:21:47.437573 (MainThread): Flushing usage events
2021-11-29 02:27:06.316279 (MainThread): Running with dbt=0.21.0
2021-11-29 02:27:07.128745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='my_frist_variable: True', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:27:07.130363 (MainThread): Tracking: tracking
2021-11-29 02:27:07.130967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e75ebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f44940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f449d0>]}
2021-11-29 02:27:07.142431 (MainThread): Partial parsing not enabled
2021-11-29 02:27:07.152677 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:27:07.156076 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:27:07.190697 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:27:07.194305 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:27:07.198428 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:27:07.199711 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:27:07.202544 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:27:07.210449 (MainThread): Parsing macros/core.sql
2021-11-29 02:27:07.213782 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:27:07.219465 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:27:07.227282 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:27:07.228814 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:27:07.244351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:27:07.275370 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:27:07.296712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:27:07.298258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:27:07.307005 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:27:07.324106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:27:07.338403 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:27:07.345805 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:27:07.352623 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:27:07.356094 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:27:07.357425 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:27:07.358267 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:27:07.359644 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:27:07.367482 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:27:07.369090 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:27:07.371244 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:27:07.372643 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:27:07.418492 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:27:07.419947 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:27:07.420904 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:27:07.421946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:27:07.626287 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:27:07.636853 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:27:07.639632 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:07.674447 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:27:07.678403 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c7c0>]}
2021-11-29 02:27:07.682434 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c9a0>]}
2021-11-29 02:27:07.682935 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:27:07.683887 (MainThread): 
2021-11-29 02:27:07.684305 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:27:07.685271 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:27:07.695726 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:27:07.695897 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:27:07.696004 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:27:08.651909 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.96 seconds
2021-11-29 02:27:08.655278 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:27:08.826480 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:27:08.838287 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:27:08.838597 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:27:08.838820 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:27:09.685723 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.85 seconds
2021-11-29 02:27:09.689183 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:27:09.849649 (MainThread): 10:27:09 | Concurrency: 1 threads (target='dev')
2021-11-29 02:27:09.850174 (MainThread): 10:27:09 | 
2021-11-29 02:27:09.853015 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:27:09.853707 (Thread-1): 10:27:09 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:27:09.854319 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:09.854620 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:27:09.863255 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:27:09.864047 (Thread-1): finished collecting timing info
2021-11-29 02:27:09.907712 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:09.907923 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:27:09.908056 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:27:11.495505 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-11-29 02:27:11.513187 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.513501 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:27:11.626601 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:27:11.635920 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.636225 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:27:11.730758 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 02:27:11.746741 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.747037 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:27:11.840016 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-11-29 02:27:11.875690 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:27:11.878494 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:11.878703 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:27:12.014267 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 02:27:12.015054 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:12.015391 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:27:12.619635 (Thread-1): SQL status: SUCCESS 0 in 0.60 seconds
2021-11-29 02:27:12.620410 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:27:12.620858 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:27:12.812612 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-11-29 02:27:12.831269 (Thread-1): finished collecting timing info
2021-11-29 02:27:12.831611 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:27:13.015042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea4d9280>]}
2021-11-29 02:27:13.016011 (Thread-1): 10:27:13 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.16s]
2021-11-29 02:27:13.016458 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:27:13.016880 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.017434 (Thread-1): 10:27:13 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:27:13.018440 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:27:13.018776 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.024847 (Thread-1): finished collecting timing info
2021-11-29 02:27:13.025474 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_frist_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_frist_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.028191 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c495c2-8b0a-426b-8b1a-8913f6c054ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea4d9160>]}
2021-11-29 02:27:13.028764 (Thread-1): 10:27:13 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:27:13.029043 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:27:13.029916 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:27:13.030261 (Thread-1): 10:27:13 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:27:13.030537 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:27:13.032017 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:27:13.032502 (MainThread): 10:27:13 | 
2021-11-29 02:27:13.032726 (MainThread): 10:27:13 | Finished running 1 incremental model, 2 table models in 5.35s.
2021-11-29 02:27:13.032916 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:27:13.033071 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:27:13.038385 (MainThread): 
2021-11-29 02:27:13.038628 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:27:13.038808 (MainThread): 
2021-11-29 02:27:13.038981 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.039138 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:27:13.039282 (MainThread):   Vars supplied to my_first_dbt_model = {
2021-11-29 02:27:13.039424 (MainThread):       "my_frist_variable": true
2021-11-29 02:27:13.039566 (MainThread):   }
2021-11-29 02:27:13.039707 (MainThread):   
2021-11-29 02:27:13.039846 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.039988 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:27:13.040150 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:27:13.040389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea086f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea05c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9f895b0>]}
2021-11-29 02:27:13.040662 (MainThread): Flushing usage events
2021-11-29 02:31:26.268312 (MainThread): Running with dbt=0.21.0
2021-11-29 02:31:27.090867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:31:27.092267 (MainThread): Tracking: tracking
2021-11-29 02:31:27.092872 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12bca1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e803a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e803a90>]}
2021-11-29 02:31:27.104978 (MainThread): Partial parsing not enabled
2021-11-29 02:31:27.115114 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:31:27.118568 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:31:27.153620 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:31:27.157271 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:31:27.161434 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:31:27.162676 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:31:27.165696 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:31:27.173666 (MainThread): Parsing macros/core.sql
2021-11-29 02:31:27.177030 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:31:27.183271 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:31:27.192141 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:31:27.194310 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:31:27.210230 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:31:27.241192 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:31:27.263945 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:31:27.265642 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:31:27.275143 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:31:27.293778 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:31:27.306239 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:31:27.313060 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:31:27.319656 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:31:27.323019 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:31:27.324284 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:31:27.325082 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:31:27.326334 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:31:27.334320 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:31:27.335847 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:31:27.338028 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:31:27.339385 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:31:27.387596 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:31:27.389260 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:31:27.390295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:31:27.391417 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:31:27.604397 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:31:27.615429 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:31:27.618543 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:27.654079 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt1.example.vars

2021-11-29 02:31:27.658056 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91c940>]}
2021-11-29 02:31:27.662218 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91c880>]}
2021-11-29 02:31:27.662554 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:31:27.663525 (MainThread): 
2021-11-29 02:31:27.663984 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:31:27.665075 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:31:27.675382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:31:27.675542 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:31:27.675649 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:31:28.588446 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.91 seconds
2021-11-29 02:31:28.591883 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:31:28.761103 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:31:28.773494 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:31:28.773821 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:31:28.774039 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:31:29.581525 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.81 seconds
2021-11-29 02:31:29.584982 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:31:29.753718 (MainThread): 10:31:29 | Concurrency: 1 threads (target='dev')
2021-11-29 02:31:29.754261 (MainThread): 10:31:29 | 
2021-11-29 02:31:29.756203 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:31:29.756890 (Thread-1): 10:31:29 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:31:29.757611 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:29.757967 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:31:29.767386 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:31:29.768209 (Thread-1): finished collecting timing info
2021-11-29 02:31:29.813818 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:29.814035 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:31:29.814170 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:31:31.396548 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-11-29 02:31:31.414647 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.415006 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:31:31.538747 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-29 02:31:31.548202 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.548538 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:31:31.655644 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:31:31.671683 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.671981 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:31:31.774877 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:31:31.811270 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:31:31.813826 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.813984 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:31:31.935867 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-11-29 02:31:31.936954 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:31.937356 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:31:32.524299 (Thread-1): SQL status: SUCCESS 0 in 0.59 seconds
2021-11-29 02:31:32.525056 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:31:32.525518 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:31:32.698449 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-29 02:31:32.715941 (Thread-1): finished collecting timing info
2021-11-29 02:31:32.716269 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:31:32.887199 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12ed272b0>]}
2021-11-29 02:31:32.888107 (Thread-1): 10:31:32 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.13s]
2021-11-29 02:31:32.888548 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:31:32.888947 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.889521 (Thread-1): 10:31:32 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:31:32.890549 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:31:32.890964 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.897112 (Thread-1): finished collecting timing info
2021-11-29 02:31:32.897750 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.900379 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1125705b-9cdc-4c1b-b04c-d12bed17dc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12ed27400>]}
2021-11-29 02:31:32.900904 (Thread-1): 10:31:32 | 2 of 3 ERROR creating table model dbt.first_model_1.................. [ERROR in 0.01s]
2021-11-29 02:31:32.901167 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:31:32.902152 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:31:32.902481 (Thread-1): 10:31:32 | 3 of 3 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-11-29 02:31:32.902733 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:31:32.904091 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:31:32.904557 (MainThread): 10:31:32 | 
2021-11-29 02:31:32.904775 (MainThread): 10:31:32 | Finished running 1 incremental model, 2 table models in 5.24s.
2021-11-29 02:31:32.904962 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:31:32.905112 (MainThread): Connection 'model.jrtests_learn_dbt1.my_first_dbt_model' was properly closed.
2021-11-29 02:31:32.910562 (MainThread): 
2021-11-29 02:31:32.910796 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 02:31:32.910972 (MainThread): 
2021-11-29 02:31:32.911138 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911288 (MainThread):   Required var 'my_first_variable' not found in config:
2021-11-29 02:31:32.911426 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-11-29 02:31:32.911563 (MainThread):   
2021-11-29 02:31:32.911701 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911835 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-11-29 02:31:32.911993 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 02:31:32.912227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e946f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e848370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e91cc10>]}
2021-11-29 02:31:32.912494 (MainThread): Flushing usage events
2021-11-29 02:32:19.135471 (MainThread): Running with dbt=0.21.0
2021-11-29 02:32:19.970111 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 02:32:19.971462 (MainThread): Tracking: tracking
2021-11-29 02:32:19.972002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc924debb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc926f04a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc926f04ac0>]}
2021-11-29 02:32:19.983675 (MainThread): Partial parsing not enabled
2021-11-29 02:32:19.993788 (MainThread): Parsing macros/catalog.sql
2021-11-29 02:32:19.997234 (MainThread): Parsing macros/adapters.sql
2021-11-29 02:32:20.033810 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 02:32:20.037470 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 02:32:20.041657 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 02:32:20.042899 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 02:32:20.045887 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 02:32:20.053972 (MainThread): Parsing macros/core.sql
2021-11-29 02:32:20.057420 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 02:32:20.063271 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 02:32:20.072791 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 02:32:20.074304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 02:32:20.090198 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 02:32:20.120817 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 02:32:20.141702 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 02:32:20.143670 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 02:32:20.152508 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 02:32:20.169139 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 02:32:20.183872 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 02:32:20.191453 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 02:32:20.198302 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 02:32:20.201832 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 02:32:20.203220 (MainThread): Parsing macros/etc/query.sql
2021-11-29 02:32:20.204065 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 02:32:20.205407 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 02:32:20.213278 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 02:32:20.215433 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 02:32:20.217788 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 02:32:20.219258 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 02:32:20.269351 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 02:32:20.270808 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 02:32:20.271778 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 02:32:20.272812 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 02:32:20.483037 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:20.494286 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:20.497207 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:20.538594 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92701b0a0>]}
2021-11-29 02:32:20.542707 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92701b040>]}
2021-11-29 02:32:20.542996 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 02:32:20.543976 (MainThread): 
2021-11-29 02:32:20.544340 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:32:20.545234 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 02:32:20.556912 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 02:32:20.557092 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 02:32:20.557212 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 02:32:21.373990 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.82 seconds
2021-11-29 02:32:21.377376 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 02:32:21.553529 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 02:32:21.565376 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 02:32:21.565699 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 02:32:21.565928 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 02:32:22.125958 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2021-11-29 02:32:22.129488 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 02:32:22.300410 (MainThread): 10:32:22 | Concurrency: 1 threads (target='dev')
2021-11-29 02:32:22.300932 (MainThread): 10:32:22 | 
2021-11-29 02:32:22.302944 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 02:32:22.303591 (Thread-1): 10:32:22 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-11-29 02:32:22.304154 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:22.304465 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 02:32:22.313412 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:32:22.314233 (Thread-1): finished collecting timing info
2021-11-29 02:32:22.358148 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:22.358357 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 02:32:22.358486 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:23.827179 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-11-29 02:32:23.844700 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:23.845041 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 02:32:24.011093 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-11-29 02:32:24.021003 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.021368 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 02:32:24.127624 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 02:32:24.143696 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.143992 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 02:32:24.240640 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-11-29 02:32:24.276584 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 02:32:24.279102 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.279266 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 02:32:24.405631 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-11-29 02:32:24.406757 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.407074 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 02:32:24.796951 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-11-29 02:32:24.797726 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 02:32:24.798229 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 02:32:24.975712 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-11-29 02:32:24.994779 (Thread-1): finished collecting timing info
2021-11-29 02:32:24.995135 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 02:32:25.185170 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9274f4fa0>]}
2021-11-29 02:32:25.186067 (Thread-1): 10:32:25 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.88s]
2021-11-29 02:32:25.186500 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 02:32:25.186921 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:25.187452 (Thread-1): 10:32:25 | 2 of 3 START table model dbt.first_model_1........................... [RUN]
2021-11-29 02:32:25.188433 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:25.188811 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:25.194060 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 02:32:25.194911 (Thread-1): finished collecting timing info
2021-11-29 02:32:25.207224 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-11-29 02:32:25.208482 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 02:32:25.208678 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_1  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-11-29 02:32:25.208853 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:26.387027 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-11-29 02:32:26.390449 (Thread-1): finished collecting timing info
2021-11-29 02:32:26.390923 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-11-29 02:32:26.560029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9274f4df0>]}
2021-11-29 02:32:26.560946 (Thread-1): 10:32:26 | 2 of 3 OK created table model dbt.first_model_1...................... [SUCCESS 1 in 1.37s]
2021-11-29 02:32:26.561373 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-11-29 02:32:26.562281 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:26.563244 (Thread-1): 10:32:26 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-11-29 02:32:26.563991 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:26.564290 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:26.568097 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 02:32:26.570578 (Thread-1): finished collecting timing info
2021-11-29 02:32:26.574799 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-11-29 02:32:26.576297 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 02:32:26.576586 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_1
where id = 1
      );
2021-11-29 02:32:26.576857 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 02:32:27.923300 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-11-29 02:32:27.926686 (Thread-1): finished collecting timing info
2021-11-29 02:32:27.927139 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-11-29 02:32:28.096823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a5a06c-c6aa-47d0-8cab-23fbf3ae1e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275c77c0>]}
2021-11-29 02:32:28.097792 (Thread-1): 10:32:28 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.53s]
2021-11-29 02:32:28.098241 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-11-29 02:32:28.100502 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 02:32:28.101153 (MainThread): 10:32:28 | 
2021-11-29 02:32:28.101468 (MainThread): 10:32:28 | Finished running 1 incremental model, 2 table models in 7.56s.
2021-11-29 02:32:28.101738 (MainThread): Connection 'master' was properly closed.
2021-11-29 02:32:28.101955 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-11-29 02:32:28.109092 (MainThread): 
2021-11-29 02:32:28.109440 (MainThread): Completed successfully
2021-11-29 02:32:28.109695 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-29 02:32:28.110023 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc924debb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275cd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9275cde80>]}
2021-11-29 02:32:28.110384 (MainThread): Flushing usage events
2021-11-29 03:11:06.942561 (MainThread): Running with dbt=0.21.0
2021-11-29 03:11:08.576963 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['dates'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 03:11:08.579461 (MainThread): Tracking: tracking
2021-11-29 03:11:08.579997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef1e4ceca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20f01b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20f01bb0>]}
2021-11-29 03:11:08.591313 (MainThread): Partial parsing not enabled
2021-11-29 03:11:08.604402 (MainThread): Parsing macros/catalog.sql
2021-11-29 03:11:08.607801 (MainThread): Parsing macros/adapters.sql
2021-11-29 03:11:08.645207 (MainThread): Parsing macros/materializations/merge.sql
2021-11-29 03:11:08.648867 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 03:11:08.652996 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 03:11:08.654238 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 03:11:08.657374 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 03:11:08.665416 (MainThread): Parsing macros/core.sql
2021-11-29 03:11:08.668780 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 03:11:08.674987 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 03:11:08.684741 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 03:11:08.686405 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 03:11:08.703045 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 03:11:08.734651 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 03:11:08.756222 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 03:11:08.757732 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 03:11:08.766465 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 03:11:08.784180 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 03:11:08.796302 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 03:11:08.803670 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 03:11:08.810464 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 03:11:08.813939 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 03:11:08.815270 (MainThread): Parsing macros/etc/query.sql
2021-11-29 03:11:08.816117 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 03:11:08.817467 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 03:11:08.825404 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 03:11:08.827007 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 03:11:08.829189 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 03:11:08.830581 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 03:11:08.876472 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 03:11:08.877859 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 03:11:08.878950 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 03:11:08.879987 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 03:11:09.089576 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-11-29 03:11:09.100171 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-11-29 03:11:09.102951 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:09.144325 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21008b50>]}
2021-11-29 03:11:09.149873 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21008fa0>]}
2021-11-29 03:11:09.150249 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-29 03:11:09.151165 (MainThread): 
2021-11-29 03:11:09.151816 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 03:11:09.152575 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-11-29 03:11:09.163917 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-11-29 03:11:09.164100 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-11-29 03:11:09.164223 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 03:11:10.078762 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.91 seconds
2021-11-29 03:11:10.082095 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-11-29 03:11:10.257161 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-11-29 03:11:10.269011 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-11-29 03:11:10.269304 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-11-29 03:11:10.269527 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-29 03:11:10.835260 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.57 seconds
2021-11-29 03:11:10.838784 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-11-29 03:11:11.012220 (MainThread): 11:11:11 | Concurrency: 1 threads (target='dev')
2021-11-29 03:11:11.012734 (MainThread): 11:11:11 | 
2021-11-29 03:11:11.014673 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-11-29 03:11:11.015300 (Thread-1): 11:11:11 | 1 of 1 START incremental model dbt.dates............................. [RUN]
2021-11-29 03:11:11.015877 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:11.016166 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-11-29 03:11:11.025632 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 03:11:11.028730 (Thread-1): finished collecting timing info
2021-11-29 03:11:11.080053 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:11.080257 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-11-29 03:11:11.080382 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 03:11:14.208994 (Thread-1): SQL status: SUCCESS 1 in 3.13 seconds
2021-11-29 03:11:14.226224 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.226517 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-11-29 03:11:14.367951 (Thread-1): SQL status: SUCCESS 28 in 0.14 seconds
2021-11-29 03:11:14.377251 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.377557 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-11-29 03:11:14.486038 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-11-29 03:11:14.500222 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.500504 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-11-29 03:11:14.617349 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-11-29 03:11:14.653292 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-11-29 03:11:14.657515 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.657705 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-11-29 03:11:14.800980 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-11-29 03:11:14.802090 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:14.802427 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-11-29 03:11:15.234975 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2021-11-29 03:11:15.235737 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-11-29 03:11:15.236109 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-11-29 03:11:15.407348 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-11-29 03:11:15.426230 (Thread-1): finished collecting timing info
2021-11-29 03:11:15.426605 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-11-29 03:11:15.595474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af45215-d7a4-4641-9ddd-68ae3b901551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef213a94f0>]}
2021-11-29 03:11:15.596409 (Thread-1): 11:11:15 | 1 of 1 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.58s]
2021-11-29 03:11:15.596853 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-11-29 03:11:15.599146 (MainThread): Acquiring new snowflake connection "master".
2021-11-29 03:11:15.599792 (MainThread): 11:11:15 | 
2021-11-29 03:11:15.600105 (MainThread): 11:11:15 | Finished running 1 incremental model in 6.45s.
2021-11-29 03:11:15.600372 (MainThread): Connection 'master' was properly closed.
2021-11-29 03:11:15.600580 (MainThread): Connection 'model.jrtests_learn_dbt1.dates' was properly closed.
2021-11-29 03:11:15.607243 (MainThread): 
2021-11-29 03:11:15.607562 (MainThread): Completed successfully
2021-11-29 03:11:15.607808 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-29 03:11:15.608127 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef213c3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef20fa2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef21340580>]}
2021-11-29 03:11:15.608490 (MainThread): Flushing usage events
2021-12-16 23:22:02.160282 (MainThread): Running with dbt=0.21.0
2021-12-16 23:22:04.185393 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-16 23:22:04.187420 (MainThread): Tracking: tracking
2021-12-16 23:22:04.187949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb403cabf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406703910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4067039a0>]}
2021-12-16 23:22:04.200451 (MainThread): Partial parsing not enabled
2021-12-16 23:22:04.224952 (MainThread): Parsing macros/catalog.sql
2021-12-16 23:22:04.228602 (MainThread): Parsing macros/adapters.sql
2021-12-16 23:22:04.269133 (MainThread): Parsing macros/materializations/merge.sql
2021-12-16 23:22:04.273634 (MainThread): Parsing macros/materializations/seed.sql
2021-12-16 23:22:04.277983 (MainThread): Parsing macros/materializations/view.sql
2021-12-16 23:22:04.279290 (MainThread): Parsing macros/materializations/table.sql
2021-12-16 23:22:04.283864 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-16 23:22:04.293343 (MainThread): Parsing macros/core.sql
2021-12-16 23:22:04.297078 (MainThread): Parsing macros/materializations/test.sql
2021-12-16 23:22:04.303977 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-16 23:22:04.313363 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-16 23:22:04.315635 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-16 23:22:04.333672 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-16 23:22:04.366718 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-16 23:22:04.389583 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-16 23:22:04.391283 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-16 23:22:04.401089 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-16 23:22:04.420372 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-16 23:22:04.434107 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-16 23:22:04.441734 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-16 23:22:04.448533 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-16 23:22:04.452007 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-16 23:22:04.453319 (MainThread): Parsing macros/etc/query.sql
2021-12-16 23:22:04.454189 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-16 23:22:04.455530 (MainThread): Parsing macros/etc/datetime.sql
2021-12-16 23:22:04.463432 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-16 23:22:04.465036 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-16 23:22:04.467249 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-16 23:22:04.468654 (MainThread): Parsing macros/adapters/common.sql
2021-12-16 23:22:04.518379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-16 23:22:04.519857 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-16 23:22:04.520851 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-16 23:22:04.521946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-16 23:22:04.762354 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:22:04.778295 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:22:04.782951 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:04.839703 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb3aaf0-1fda-4c29-994e-64a2dc0f5f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4067f0220>]}
2021-12-16 23:22:04.845215 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb3aaf0-1fda-4c29-994e-64a2dc0f5f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406846160>]}
2021-12-16 23:22:04.845610 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-16 23:22:04.846810 (MainThread): 
2021-12-16 23:22:04.847353 (MainThread): Acquiring new snowflake connection "master".
2021-12-16 23:22:04.848469 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-16 23:22:04.862763 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-16 23:22:04.862965 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-16 23:22:04.863082 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-16 23:22:06.542236 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.68 seconds
2021-12-16 23:22:06.546031 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-16 23:22:06.822649 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-16 23:22:06.837828 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-16 23:22:06.838179 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-16 23:22:06.838426 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-16 23:22:07.689816 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.85 seconds
2021-12-16 23:22:07.692271 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-16 23:22:07.855255 (MainThread): 07:22:07 | Concurrency: 1 threads (target='dev')
2021-12-16 23:22:07.855577 (MainThread): 07:22:07 | 
2021-12-16 23:22:07.856729 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-16 23:22:07.857091 (Thread-1): 07:22:07 | 1 of 3 START incremental model dbt.dates............................. [RUN]
2021-12-16 23:22:07.857464 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:07.857641 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-16 23:22:07.864474 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-16 23:22:07.865178 (Thread-1): finished collecting timing info
2021-12-16 23:22:07.905792 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:07.905999 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-16 23:22:07.906123 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:22:10.429968 (Thread-1): SQL status: SUCCESS 1 in 2.52 seconds
2021-12-16 23:22:10.448215 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:10.448493 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-16 23:22:10.580925 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-12-16 23:22:10.590663 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:10.591008 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-16 23:22:10.700777 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-16 23:22:10.716730 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:10.717037 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-16 23:22:10.819964 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-16 23:22:10.857060 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-16 23:22:10.859570 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:10.859710 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-16 23:22:10.989114 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-12-16 23:22:10.990176 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:10.990578 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-16 23:22:12.171338 (Thread-1): SQL status: SUCCESS 18 in 1.18 seconds
2021-12-16 23:22:12.172093 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:22:12.172506 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-16 23:22:12.478310 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-12-16 23:22:12.497311 (Thread-1): finished collecting timing info
2021-12-16 23:22:12.497671 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-16 23:22:12.699069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb3aaf0-1fda-4c29-994e-64a2dc0f5f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406dbd7f0>]}
2021-12-16 23:22:12.699838 (Thread-1): 07:22:12 | 1 of 3 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.84s]
2021-12-16 23:22:12.700135 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-16 23:22:12.700455 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:22:12.700973 (Thread-1): 07:22:12 | 2 of 3 START table model dbt.first_model_2........................... [RUN]
2021-12-16 23:22:12.701539 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:22:12.701807 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:22:12.706282 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-16 23:22:12.707046 (Thread-1): finished collecting timing info
2021-12-16 23:22:12.717611 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-16 23:22:12.718921 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:22:12.719090 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-16 23:22:12.719232 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:22:14.014871 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-12-16 23:22:14.018930 (Thread-1): finished collecting timing info
2021-12-16 23:22:14.019456 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-16 23:22:14.182681 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb3aaf0-1fda-4c29-994e-64a2dc0f5f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406dcdfd0>]}
2021-12-16 23:22:14.183574 (Thread-1): 07:22:14 | 2 of 3 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.48s]
2021-12-16 23:22:14.183993 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:22:14.184881 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:22:14.185425 (Thread-1): 07:22:14 | 3 of 3 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-16 23:22:14.186414 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:22:14.186733 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:22:14.190459 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-16 23:22:14.191511 (Thread-1): finished collecting timing info
2021-12-16 23:22:14.195097 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-16 23:22:14.196513 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:22:14.196819 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-16 23:22:14.197013 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:22:15.550541 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-12-16 23:22:15.554560 (Thread-1): finished collecting timing info
2021-12-16 23:22:15.555150 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-16 23:22:15.710789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb3aaf0-1fda-4c29-994e-64a2dc0f5f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406ef8b50>]}
2021-12-16 23:22:15.711554 (Thread-1): 07:22:15 | 3 of 3 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.52s]
2021-12-16 23:22:15.712125 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:22:15.713691 (MainThread): Acquiring new snowflake connection "master".
2021-12-16 23:22:15.714182 (MainThread): 07:22:15 | 
2021-12-16 23:22:15.714427 (MainThread): 07:22:15 | Finished running 1 incremental model, 2 table models in 10.87s.
2021-12-16 23:22:15.714755 (MainThread): Connection 'master' was properly closed.
2021-12-16 23:22:15.714927 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-16 23:22:15.719229 (MainThread): 
2021-12-16 23:22:15.719498 (MainThread): Completed successfully
2021-12-16 23:22:15.719759 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-16 23:22:15.720009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4067c2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406edea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb406ede550>]}
2021-12-16 23:22:15.720370 (MainThread): Flushing usage events
2021-12-16 23:40:58.953730 (MainThread): Running with dbt=0.21.0
2021-12-16 23:40:59.868157 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-16 23:40:59.869627 (MainThread): Tracking: tracking
2021-12-16 23:40:59.870167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88ccebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88f701a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88f701af0>]}
2021-12-16 23:40:59.881572 (MainThread): Partial parsing not enabled
2021-12-16 23:40:59.891387 (MainThread): Parsing macros/catalog.sql
2021-12-16 23:40:59.894850 (MainThread): Parsing macros/adapters.sql
2021-12-16 23:40:59.929637 (MainThread): Parsing macros/materializations/merge.sql
2021-12-16 23:40:59.933194 (MainThread): Parsing macros/materializations/seed.sql
2021-12-16 23:40:59.937370 (MainThread): Parsing macros/materializations/view.sql
2021-12-16 23:40:59.938622 (MainThread): Parsing macros/materializations/table.sql
2021-12-16 23:40:59.941509 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-16 23:40:59.949527 (MainThread): Parsing macros/core.sql
2021-12-16 23:40:59.952882 (MainThread): Parsing macros/materializations/test.sql
2021-12-16 23:40:59.958737 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-16 23:40:59.966333 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-16 23:40:59.967813 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-16 23:40:59.984657 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-16 23:41:00.018120 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-16 23:41:00.040712 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-16 23:41:00.042372 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-16 23:41:00.051877 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-16 23:41:00.072326 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-16 23:41:00.085567 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-16 23:41:00.092933 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-16 23:41:00.099740 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-16 23:41:00.103544 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-16 23:41:00.104885 (MainThread): Parsing macros/etc/query.sql
2021-12-16 23:41:00.105763 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-16 23:41:00.107119 (MainThread): Parsing macros/etc/datetime.sql
2021-12-16 23:41:00.115045 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-16 23:41:00.116643 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-16 23:41:00.118836 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-16 23:41:00.120229 (MainThread): Parsing macros/adapters/common.sql
2021-12-16 23:41:00.169600 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-16 23:41:00.170965 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-16 23:41:00.171915 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-16 23:41:00.172965 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-16 23:41:00.386843 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:41:00.398034 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:41:00.400882 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:00.408850 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-16 23:41:00.450181 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88f732730>]}
2021-12-16 23:41:00.455140 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88f827970>]}
2021-12-16 23:41:00.455438 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-16 23:41:00.456669 (MainThread): 
2021-12-16 23:41:00.457126 (MainThread): Acquiring new snowflake connection "master".
2021-12-16 23:41:00.458135 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-16 23:41:00.470099 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-16 23:41:00.470365 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-16 23:41:00.470518 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-16 23:41:01.436783 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.97 seconds
2021-12-16 23:41:01.440145 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-16 23:41:01.605845 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-16 23:41:01.617552 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-16 23:41:01.617869 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-16 23:41:01.618093 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-16 23:41:02.365367 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.75 seconds
2021-12-16 23:41:02.369072 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-16 23:41:02.544099 (MainThread): 07:41:02 | Concurrency: 1 threads (target='dev')
2021-12-16 23:41:02.544636 (MainThread): 07:41:02 | 
2021-12-16 23:41:02.546727 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-16 23:41:02.547428 (Thread-1): 07:41:02 | 1 of 4 START incremental model dbt.dates............................. [RUN]
2021-12-16 23:41:02.548010 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:02.548295 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-16 23:41:02.557006 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-16 23:41:02.557774 (Thread-1): finished collecting timing info
2021-12-16 23:41:02.606055 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:02.606272 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-16 23:41:02.606406 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:41:04.700267 (Thread-1): SQL status: SUCCESS 1 in 2.09 seconds
2021-12-16 23:41:04.717686 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:04.718013 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-16 23:41:04.826589 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-16 23:41:04.834602 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:04.834886 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-16 23:41:04.943486 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-16 23:41:04.959547 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:04.959856 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-16 23:41:05.060066 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-16 23:41:05.095853 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-16 23:41:05.098396 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:05.098574 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-16 23:41:05.214746 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-16 23:41:05.215889 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:05.216357 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-16 23:41:06.133239 (Thread-1): SQL status: SUCCESS 0 in 0.92 seconds
2021-12-16 23:41:06.134004 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-16 23:41:06.134467 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-16 23:41:06.315004 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-16 23:41:06.335079 (Thread-1): finished collecting timing info
2021-12-16 23:41:06.335430 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-16 23:41:06.515012 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88fcdb1c0>]}
2021-12-16 23:41:06.515930 (Thread-1): 07:41:06 | 1 of 4 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.97s]
2021-12-16 23:41:06.516385 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-16 23:41:06.516797 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:41:06.517316 (Thread-1): 07:41:06 | 2 of 4 START table model dbt.first_model_2........................... [RUN]
2021-12-16 23:41:06.517979 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:41:06.518349 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:41:06.523567 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-16 23:41:06.524889 (Thread-1): finished collecting timing info
2021-12-16 23:41:06.537071 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-16 23:41:06.538316 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-16 23:41:06.538499 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-16 23:41:06.538658 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:41:07.771728 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-12-16 23:41:07.775123 (Thread-1): finished collecting timing info
2021-12-16 23:41:07.775588 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-16 23:41:07.941461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88fcacf40>]}
2021-12-16 23:41:07.942379 (Thread-1): 07:41:07 | 2 of 4 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.42s]
2021-12-16 23:41:07.942827 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-16 23:41:07.943277 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-16 23:41:07.943804 (Thread-1): 07:41:07 | 3 of 4 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-16 23:41:07.944485 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-16 23:41:07.944826 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-16 23:41:07.948636 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-16 23:41:07.949908 (Thread-1): finished collecting timing info
2021-12-16 23:41:07.954358 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-16 23:41:07.955929 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-16 23:41:07.956155 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-16 23:41:07.956361 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:41:09.819843 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-12-16 23:41:09.823319 (Thread-1): finished collecting timing info
2021-12-16 23:41:09.823772 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-16 23:41:10.000213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88fd858e0>]}
2021-12-16 23:41:10.001150 (Thread-1): 07:41:10 | 3 of 4 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.06s]
2021-12-16 23:41:10.001597 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-16 23:41:10.002034 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:41:10.002611 (Thread-1): 07:41:10 | 4 of 4 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-16 23:41:10.003701 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:41:10.004212 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:41:10.008114 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-16 23:41:10.009637 (Thread-1): finished collecting timing info
2021-12-16 23:41:10.012873 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-16 23:41:10.014095 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-16 23:41:10.014327 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-16 23:41:10.014533 (Thread-1): Opening a new connection, currently in state closed
2021-12-16 23:41:11.355673 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-12-16 23:41:11.359398 (Thread-1): finished collecting timing info
2021-12-16 23:41:11.359924 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-16 23:41:11.541016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcf8233-880a-4597-89a1-461d3de254c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88fca3c10>]}
2021-12-16 23:41:11.541950 (Thread-1): 07:41:11 | 4 of 4 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.54s]
2021-12-16 23:41:11.542388 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-16 23:41:11.544896 (MainThread): Acquiring new snowflake connection "master".
2021-12-16 23:41:11.545592 (MainThread): 07:41:11 | 
2021-12-16 23:41:11.545909 (MainThread): 07:41:11 | Finished running 1 incremental model, 3 table models in 11.09s.
2021-12-16 23:41:11.546207 (MainThread): Connection 'master' was properly closed.
2021-12-16 23:41:11.546576 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-16 23:41:11.554081 (MainThread): 
2021-12-16 23:41:11.554424 (MainThread): Completed successfully
2021-12-16 23:41:11.554679 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-12-16 23:41:11.555145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88f7172e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88fe25490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88cceba60>]}
2021-12-16 23:41:11.555570 (MainThread): Flushing usage events
2021-12-17 01:51:15.898673 (MainThread): Running with dbt=0.21.0
2021-12-17 01:51:16.734183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 01:51:16.735692 (MainThread): Tracking: tracking
2021-12-17 01:51:16.736258 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ccaba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ef028e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ef02970>]}
2021-12-17 01:51:16.746962 (MainThread): Partial parsing not enabled
2021-12-17 01:51:16.756428 (MainThread): Parsing macros/catalog.sql
2021-12-17 01:51:16.759634 (MainThread): Parsing macros/adapters.sql
2021-12-17 01:51:16.794153 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 01:51:16.797764 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 01:51:16.801852 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 01:51:16.803059 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 01:51:16.805802 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 01:51:16.813044 (MainThread): Parsing macros/core.sql
2021-12-17 01:51:16.816088 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 01:51:16.821657 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 01:51:16.830521 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 01:51:16.831948 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 01:51:16.850891 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 01:51:16.882101 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 01:51:16.903303 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 01:51:16.904920 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 01:51:16.914392 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 01:51:16.931941 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 01:51:16.943156 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 01:51:16.949661 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 01:51:16.956000 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 01:51:16.959199 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 01:51:16.960347 (MainThread): Parsing macros/etc/query.sql
2021-12-17 01:51:16.961091 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 01:51:16.962262 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 01:51:16.969536 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 01:51:16.970941 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 01:51:16.973312 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 01:51:16.975134 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 01:51:17.024774 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 01:51:17.026448 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 01:51:17.027535 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 01:51:17.028774 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 01:51:17.240353 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:51:17.251634 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:51:17.254745 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:17.261091 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:51:17.263850 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:51:17.303353 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ef4b1c0>]}
2021-12-17 01:51:17.308577 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ef20820>]}
2021-12-17 01:51:17.308924 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 01:51:17.310021 (MainThread): 
2021-12-17 01:51:17.310489 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 01:51:17.311673 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 01:51:17.321733 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 01:51:17.321893 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 01:51:17.322002 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 01:51:18.327876 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.01 seconds
2021-12-17 01:51:18.331255 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 01:51:18.509027 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 01:51:18.520803 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 01:51:18.521112 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 01:51:18.521340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 01:51:19.366995 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.85 seconds
2021-12-17 01:51:19.369378 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 01:51:19.548575 (MainThread): 09:51:19 | Concurrency: 1 threads (target='dev')
2021-12-17 01:51:19.549097 (MainThread): 09:51:19 | 
2021-12-17 01:51:19.551453 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 01:51:19.552058 (Thread-1): 09:51:19 | 1 of 5 START incremental model dbt.dates............................. [RUN]
2021-12-17 01:51:19.552643 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:19.552929 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 01:51:19.563013 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 01:51:19.563834 (Thread-1): finished collecting timing info
2021-12-17 01:51:19.610689 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:19.610903 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 01:51:19.611033 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:51:21.483167 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-12-17 01:51:21.499626 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:21.499925 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 01:51:21.620385 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 01:51:21.629718 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:21.630026 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 01:51:21.741791 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 01:51:21.757752 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:21.758051 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 01:51:21.857105 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 01:51:21.893139 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 01:51:21.895664 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:21.895827 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 01:51:22.010752 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-12-17 01:51:22.011817 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:22.012169 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 01:51:22.658697 (Thread-1): SQL status: SUCCESS 0 in 0.65 seconds
2021-12-17 01:51:22.659304 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:51:22.659613 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 01:51:22.913691 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-12-17 01:51:22.932520 (Thread-1): finished collecting timing info
2021-12-17 01:51:22.932891 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 01:51:23.110113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f6edd30>]}
2021-12-17 01:51:23.111024 (Thread-1): 09:51:23 | 1 of 5 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.56s]
2021-12-17 01:51:23.111459 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 01:51:23.111872 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:51:23.112389 (Thread-1): 09:51:23 | 2 of 5 START table model dbt.first_model_2........................... [RUN]
2021-12-17 01:51:23.113348 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:51:23.113805 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:51:23.119051 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 01:51:23.119889 (Thread-1): finished collecting timing info
2021-12-17 01:51:23.132017 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 01:51:23.133256 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:51:23.133448 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 01:51:23.133605 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:51:24.351086 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-12-17 01:51:24.354523 (Thread-1): finished collecting timing info
2021-12-17 01:51:24.354984 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 01:51:24.550550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f78c790>]}
2021-12-17 01:51:24.551471 (Thread-1): 09:51:24 | 2 of 5 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.44s]
2021-12-17 01:51:24.551902 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:51:24.552318 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 01:51:24.552831 (Thread-1): 09:51:24 | 3 of 5 START view model dbt.raw_data................................. [RUN]
2021-12-17 01:51:24.553507 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:51:24.553854 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 01:51:24.557494 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 01:51:24.558837 (Thread-1): finished collecting timing info
2021-12-17 01:51:24.579387 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 01:51:24.580301 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:51:24.580471 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 01:51:24.580610 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:51:25.252315 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 01:51:25.255815 (Thread-1): finished collecting timing info
2021-12-17 01:51:25.256289 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 01:51:25.420037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f773b80>]}
2021-12-17 01:51:25.421083 (Thread-1): 09:51:25 | 3 of 5 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.87s]
2021-12-17 01:51:25.421571 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 01:51:25.421992 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:51:25.422468 (Thread-1): 09:51:25 | 4 of 5 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 01:51:25.423203 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:51:25.423527 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:51:25.427211 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 01:51:25.428093 (Thread-1): finished collecting timing info
2021-12-17 01:51:25.431177 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 01:51:25.432704 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:51:25.432966 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 01:51:25.433171 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:51:27.320794 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-12-17 01:51:27.324155 (Thread-1): finished collecting timing info
2021-12-17 01:51:27.324604 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 01:51:27.490608 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f42db20>]}
2021-12-17 01:51:27.491529 (Thread-1): 09:51:27 | 4 of 5 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.07s]
2021-12-17 01:51:27.491965 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:51:27.492374 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:51:27.492885 (Thread-1): 09:51:27 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 01:51:27.493797 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:51:27.494204 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:51:27.497915 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 01:51:27.498735 (Thread-1): finished collecting timing info
2021-12-17 01:51:27.501978 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 01:51:27.503159 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:51:27.503415 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 01:51:27.503615 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:51:28.765940 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-12-17 01:51:28.769292 (Thread-1): finished collecting timing info
2021-12-17 01:51:28.769743 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 01:51:28.933130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993066ce-2f93-4e06-9c52-69f7f9062853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f75b6a0>]}
2021-12-17 01:51:28.934083 (Thread-1): 09:51:28 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.44s]
2021-12-17 01:51:28.934533 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:51:28.936482 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 01:51:28.937187 (MainThread): 09:51:28 | 
2021-12-17 01:51:28.937504 (MainThread): 09:51:28 | Finished running 1 incremental model, 3 table models, 1 view model in 11.63s.
2021-12-17 01:51:28.937776 (MainThread): Connection 'master' was properly closed.
2021-12-17 01:51:28.937991 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-17 01:51:28.945405 (MainThread): 
2021-12-17 01:51:28.945716 (MainThread): Completed successfully
2021-12-17 01:51:28.945984 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-17 01:51:28.946306 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08ef20250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08efe2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f14a7f0>]}
2021-12-17 01:51:28.946662 (MainThread): Flushing usage events
2021-12-17 01:57:28.951038 (MainThread): Running with dbt=0.21.0
2021-12-17 01:57:29.778438 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 01:57:29.780021 (MainThread): Tracking: tracking
2021-12-17 01:57:29.780637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81574a1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159705880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159705940>]}
2021-12-17 01:57:29.791848 (MainThread): Partial parsing not enabled
2021-12-17 01:57:29.801776 (MainThread): Parsing macros/catalog.sql
2021-12-17 01:57:29.805218 (MainThread): Parsing macros/adapters.sql
2021-12-17 01:57:29.839600 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 01:57:29.843103 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 01:57:29.847021 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 01:57:29.848231 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 01:57:29.851074 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 01:57:29.858350 (MainThread): Parsing macros/core.sql
2021-12-17 01:57:29.861432 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 01:57:29.867005 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 01:57:29.875346 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 01:57:29.876766 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 01:57:29.894361 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 01:57:29.925254 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 01:57:29.944799 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 01:57:29.946284 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 01:57:29.955185 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 01:57:29.971625 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 01:57:29.983303 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 01:57:29.989993 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 01:57:29.995887 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 01:57:29.998900 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 01:57:30.000033 (MainThread): Parsing macros/etc/query.sql
2021-12-17 01:57:30.000787 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 01:57:30.002935 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 01:57:30.010181 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 01:57:30.011611 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 01:57:30.013510 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 01:57:30.014739 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 01:57:30.065182 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 01:57:30.066782 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 01:57:30.067928 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 01:57:30.069119 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 01:57:30.295081 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:57:30.306097 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:57:30.308920 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:30.314889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:57:30.317624 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:57:30.320630 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 01:57:30.359523 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159816190>]}
2021-12-17 01:57:30.364422 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81598392e0>]}
2021-12-17 01:57:30.364763 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 01:57:30.365912 (MainThread): 
2021-12-17 01:57:30.366335 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 01:57:30.367465 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 01:57:30.379636 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 01:57:30.379852 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 01:57:30.380003 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 01:57:31.269330 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.89 seconds
2021-12-17 01:57:31.274392 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 01:57:31.442793 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 01:57:31.454406 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 01:57:31.454708 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 01:57:31.454925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 01:57:32.257649 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.80 seconds
2021-12-17 01:57:32.261389 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 01:57:32.437574 (MainThread): 09:57:32 | Concurrency: 1 threads (target='dev')
2021-12-17 01:57:32.438151 (MainThread): 09:57:32 | 
2021-12-17 01:57:32.440283 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 01:57:32.440832 (Thread-1): 09:57:32 | 1 of 6 START incremental model dbt.dates............................. [RUN]
2021-12-17 01:57:32.441413 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:32.441700 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 01:57:32.451673 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 01:57:32.452456 (Thread-1): finished collecting timing info
2021-12-17 01:57:32.495614 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:32.495818 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 01:57:32.495944 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:34.633626 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-12-17 01:57:34.645440 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:34.645684 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 01:57:34.765407 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 01:57:34.774795 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:34.775097 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 01:57:34.878668 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 01:57:34.894639 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:34.894913 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 01:57:34.992921 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 01:57:35.030944 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 01:57:35.033692 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:35.033980 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 01:57:35.151251 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 01:57:35.151988 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:35.152308 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 01:57:35.558216 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-12-17 01:57:35.558961 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 01:57:35.559381 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 01:57:35.795140 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-12-17 01:57:35.814280 (Thread-1): finished collecting timing info
2021-12-17 01:57:35.814653 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 01:57:35.989002 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159cec760>]}
2021-12-17 01:57:35.989910 (Thread-1): 09:57:35 | 1 of 6 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.55s]
2021-12-17 01:57:35.990337 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 01:57:35.990736 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:57:35.991240 (Thread-1): 09:57:35 | 2 of 6 START table model dbt.first_model_2........................... [RUN]
2021-12-17 01:57:35.992193 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:57:35.992584 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:57:35.997792 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 01:57:35.998617 (Thread-1): finished collecting timing info
2021-12-17 01:57:36.011262 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 01:57:36.012523 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 01:57:36.012709 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 01:57:36.012864 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:37.400652 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-12-17 01:57:37.404122 (Thread-1): finished collecting timing info
2021-12-17 01:57:37.404579 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 01:57:37.575953 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159cfbb50>]}
2021-12-17 01:57:37.576689 (Thread-1): 09:57:37 | 2 of 6 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.58s]
2021-12-17 01:57:37.577036 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 01:57:37.577363 (Thread-1): Began running node model.jrtests_learn_dbt1.orders
2021-12-17 01:57:37.578155 (Thread-1): 09:57:37 | 3 of 6 START view model dbt.orders................................... [RUN]
2021-12-17 01:57:37.578830 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 01:57:37.579139 (Thread-1): Compiling model.jrtests_learn_dbt1.orders
2021-12-17 01:57:37.582394 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders"
2021-12-17 01:57:37.583246 (Thread-1): finished collecting timing info
2021-12-17 01:57:37.602212 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders"
2021-12-17 01:57:37.603054 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 01:57:37.603210 (Thread-1): On model.jrtests_learn_dbt1.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders"} */

  create or replace  view analytics.dbt.orders  as (
    
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 01:57:37.603334 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:38.544043 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-12-17 01:57:38.547453 (Thread-1): finished collecting timing info
2021-12-17 01:57:38.547895 (Thread-1): On model.jrtests_learn_dbt1.orders: Close
2021-12-17 01:57:38.712579 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159e828b0>]}
2021-12-17 01:57:38.713478 (Thread-1): 09:57:38 | 3 of 6 OK created view model dbt.orders.............................. [SUCCESS 1 in 1.13s]
2021-12-17 01:57:38.713920 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders
2021-12-17 01:57:38.714332 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 01:57:38.714847 (Thread-1): 09:57:38 | 4 of 6 START view model dbt.raw_data................................. [RUN]
2021-12-17 01:57:38.715821 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:57:38.716258 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 01:57:38.719859 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 01:57:38.720686 (Thread-1): finished collecting timing info
2021-12-17 01:57:38.724079 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 01:57:38.725074 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 01:57:38.725293 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 01:57:38.725501 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:39.428597 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-12-17 01:57:39.432060 (Thread-1): finished collecting timing info
2021-12-17 01:57:39.432509 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 01:57:39.652589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159d47220>]}
2021-12-17 01:57:39.653721 (Thread-1): 09:57:39 | 4 of 6 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.94s]
2021-12-17 01:57:39.654335 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 01:57:39.654969 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:57:39.656014 (Thread-1): 09:57:39 | 5 of 6 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 01:57:39.656774 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:57:39.657076 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:57:39.661192 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 01:57:39.662143 (Thread-1): finished collecting timing info
2021-12-17 01:57:39.665372 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 01:57:39.667136 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 01:57:39.667425 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 01:57:39.667690 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:41.324533 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-17 01:57:41.327696 (Thread-1): finished collecting timing info
2021-12-17 01:57:41.328155 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 01:57:41.491280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159e3a310>]}
2021-12-17 01:57:41.504169 (Thread-1): 09:57:41 | 5 of 6 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.83s]
2021-12-17 01:57:41.506583 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 01:57:41.508718 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:57:41.510979 (Thread-1): 09:57:41 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 01:57:41.511785 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:57:41.512143 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:57:41.516735 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 01:57:41.517721 (Thread-1): finished collecting timing info
2021-12-17 01:57:41.521412 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 01:57:41.522743 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 01:57:41.522964 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 01:57:41.523160 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 01:57:42.929979 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-12-17 01:57:42.933381 (Thread-1): finished collecting timing info
2021-12-17 01:57:42.933844 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 01:57:43.094636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a5e622-28dd-4eb0-8d79-e57e77824414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159cfefa0>]}
2021-12-17 01:57:43.095567 (Thread-1): 09:57:43 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.58s]
2021-12-17 01:57:43.096015 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 01:57:43.098204 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 01:57:43.098940 (MainThread): 09:57:43 | 
2021-12-17 01:57:43.099253 (MainThread): 09:57:43 | Finished running 1 incremental model, 3 table models, 2 view models in 12.73s.
2021-12-17 01:57:43.099523 (MainThread): Connection 'master' was properly closed.
2021-12-17 01:57:43.099738 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-17 01:57:43.107284 (MainThread): 
2021-12-17 01:57:43.107615 (MainThread): Completed successfully
2021-12-17 01:57:43.107873 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-17 01:57:43.108187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815985b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8159c4ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81574a1a60>]}
2021-12-17 01:57:43.108537 (MainThread): Flushing usage events
2021-12-17 01:58:40.026841 (MainThread): Running with dbt=0.21.0
2021-12-17 01:58:41.037423 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 01:58:41.039172 (MainThread): Tracking: tracking
2021-12-17 01:58:41.039863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b8b92ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88baf05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88baf059d0>]}
2021-12-17 01:58:41.053438 (MainThread): Partial parsing not enabled
2021-12-17 01:58:41.057152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88baf199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88baf273d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88baf274f0>]}
2021-12-17 01:58:41.057463 (MainThread): Flushing usage events
2021-12-17 01:58:42.327223 (MainThread): Encountered an error:
2021-12-17 01:58:42.346893 (MainThread): Compilation Error
  The schema file at models/example/join_data/schema.yml is invalid because version 3 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2021-12-17 01:58:42.356391 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 50, in validate_yaml
    check_format_version(file_path, dct)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 545, in check_format_version
    raise_invalid_schema_yml_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 904, in raise_invalid_schema_yml_version
    raise_compiler_error(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/example/join_data/schema.yml is invalid because version 3 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2021-12-17 02:00:06.595570 (MainThread): Running with dbt=0.21.0
2021-12-17 02:00:07.445781 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 02:00:07.447167 (MainThread): Tracking: tracking
2021-12-17 02:00:07.447776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0623c8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064703970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064703a00>]}
2021-12-17 02:00:07.459890 (MainThread): Partial parsing not enabled
2021-12-17 02:00:07.470423 (MainThread): Parsing macros/catalog.sql
2021-12-17 02:00:07.473896 (MainThread): Parsing macros/adapters.sql
2021-12-17 02:00:07.509222 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 02:00:07.512899 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 02:00:07.517081 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 02:00:07.518847 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 02:00:07.522580 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 02:00:07.530564 (MainThread): Parsing macros/core.sql
2021-12-17 02:00:07.533924 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 02:00:07.539984 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 02:00:07.549538 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 02:00:07.551132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 02:00:07.568610 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 02:00:07.599634 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 02:00:07.620509 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 02:00:07.622559 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 02:00:07.630741 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 02:00:07.647940 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 02:00:07.659187 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 02:00:07.666059 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 02:00:07.672160 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 02:00:07.675198 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 02:00:07.676352 (MainThread): Parsing macros/etc/query.sql
2021-12-17 02:00:07.677086 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 02:00:07.678273 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 02:00:07.685038 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 02:00:07.686499 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 02:00:07.688842 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 02:00:07.690228 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 02:00:07.734302 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 02:00:07.735610 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 02:00:07.736530 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 02:00:07.737559 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 02:00:07.960263 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:00:07.970955 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:00:07.973902 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:07.979861 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064784070>]}
2021-12-17 02:00:07.981183 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:00:07.985096 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:00:07.988109 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 02:00:08.034548 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06487f490>]}
2021-12-17 02:00:08.039696 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064845e20>]}
2021-12-17 02:00:08.039991 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 02:00:08.041402 (MainThread): 
2021-12-17 02:00:08.041867 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:00:08.042958 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 02:00:08.054457 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 02:00:08.054641 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 02:00:08.054767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 02:00:09.042666 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.99 seconds
2021-12-17 02:00:09.045506 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 02:00:09.211454 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 02:00:09.223144 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 02:00:09.223456 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 02:00:09.223682 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 02:00:09.979377 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.76 seconds
2021-12-17 02:00:09.983298 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 02:00:10.154736 (MainThread): 10:00:10 | Concurrency: 1 threads (target='dev')
2021-12-17 02:00:10.155260 (MainThread): 10:00:10 | 
2021-12-17 02:00:10.157313 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 02:00:10.157874 (Thread-1): 10:00:10 | 1 of 6 START incremental model dbt.dates............................. [RUN]
2021-12-17 02:00:10.158476 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:10.158766 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 02:00:10.168438 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:00:10.169221 (Thread-1): finished collecting timing info
2021-12-17 02:00:10.216512 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:10.216724 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 02:00:10.216856 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:11.798203 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-12-17 02:00:11.813129 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:11.813410 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 02:00:11.946865 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-12-17 02:00:11.956191 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:11.956499 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 02:00:12.056500 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:00:12.072409 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:12.072707 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 02:00:12.170465 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:00:12.207776 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:00:12.210383 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:12.210546 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 02:00:12.337769 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-12-17 02:00:12.338877 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:12.339272 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 02:00:12.720063 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-12-17 02:00:12.720768 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:00:12.721078 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 02:00:12.910594 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-12-17 02:00:12.929590 (Thread-1): finished collecting timing info
2021-12-17 02:00:12.929981 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 02:00:13.106365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064b849a0>]}
2021-12-17 02:00:13.107293 (Thread-1): 10:00:13 | 1 of 6 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.95s]
2021-12-17 02:00:13.107731 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 02:00:13.108184 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:00:13.108728 (Thread-1): 10:00:13 | 2 of 6 START table model dbt.first_model_2........................... [RUN]
2021-12-17 02:00:13.109877 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:00:13.110174 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:00:13.115498 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:00:13.116285 (Thread-1): finished collecting timing info
2021-12-17 02:00:13.128772 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:00:13.130040 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:00:13.130238 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 02:00:13.130398 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:14.562799 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-12-17 02:00:14.566258 (Thread-1): finished collecting timing info
2021-12-17 02:00:14.566717 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 02:00:14.749064 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064e5c280>]}
2021-12-17 02:00:14.749963 (Thread-1): 10:00:14 | 2 of 6 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.64s]
2021-12-17 02:00:14.750386 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:00:14.750803 (Thread-1): Began running node model.jrtests_learn_dbt1.orders
2021-12-17 02:00:14.751318 (Thread-1): 10:00:14 | 3 of 6 START view model dbt.orders................................... [RUN]
2021-12-17 02:00:14.751973 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 02:00:14.752301 (Thread-1): Compiling model.jrtests_learn_dbt1.orders
2021-12-17 02:00:14.756028 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders"
2021-12-17 02:00:14.757151 (Thread-1): finished collecting timing info
2021-12-17 02:00:14.777761 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders"
2021-12-17 02:00:14.778655 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders".
2021-12-17 02:00:14.778871 (Thread-1): On model.jrtests_learn_dbt1.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders"} */

  create or replace  view analytics.dbt.orders  as (
    
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 02:00:14.779034 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:15.450134 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 02:00:15.453534 (Thread-1): finished collecting timing info
2021-12-17 02:00:15.454002 (Thread-1): On model.jrtests_learn_dbt1.orders: Close
2021-12-17 02:00:15.625806 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064b946a0>]}
2021-12-17 02:00:15.626727 (Thread-1): 10:00:15 | 3 of 6 OK created view model dbt.orders.............................. [SUCCESS 1 in 0.87s]
2021-12-17 02:00:15.627158 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders
2021-12-17 02:00:15.627580 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:00:15.628129 (Thread-1): 10:00:15 | 4 of 6 START view model dbt.raw_data................................. [RUN]
2021-12-17 02:00:15.628818 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:00:15.629163 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 02:00:15.632914 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:00:15.633941 (Thread-1): finished collecting timing info
2021-12-17 02:00:15.637422 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:00:15.638414 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:00:15.638636 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 02:00:15.638837 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:16.358256 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-12-17 02:00:16.361715 (Thread-1): finished collecting timing info
2021-12-17 02:00:16.362166 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 02:00:16.539767 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064b7e0d0>]}
2021-12-17 02:00:16.540662 (Thread-1): 10:00:16 | 4 of 6 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.91s]
2021-12-17 02:00:16.541118 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:00:16.541526 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:00:16.542043 (Thread-1): 10:00:16 | 5 of 6 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 02:00:16.542728 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:00:16.543066 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:00:16.547024 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:00:16.547907 (Thread-1): finished collecting timing info
2021-12-17 02:00:16.551316 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:00:16.552897 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:00:16.553128 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 02:00:16.553343 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:18.351006 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-12-17 02:00:18.354407 (Thread-1): finished collecting timing info
2021-12-17 02:00:18.354865 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 02:00:18.523645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064e2d9a0>]}
2021-12-17 02:00:18.524588 (Thread-1): 10:00:18 | 5 of 6 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.98s]
2021-12-17 02:00:18.525019 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:00:18.525430 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:00:18.525955 (Thread-1): 10:00:18 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 02:00:18.526634 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:00:18.526970 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:00:18.530668 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:00:18.531521 (Thread-1): finished collecting timing info
2021-12-17 02:00:18.534865 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:00:18.536040 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:00:18.536263 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 02:00:18.536467 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:00:19.885226 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-12-17 02:00:19.888590 (Thread-1): finished collecting timing info
2021-12-17 02:00:19.889048 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 02:00:20.071392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228efaae-dc3d-434c-90ae-8083eccfa3ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064b7e490>]}
2021-12-17 02:00:20.072320 (Thread-1): 10:00:20 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.54s]
2021-12-17 02:00:20.072751 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:00:20.075148 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:00:20.075859 (MainThread): 10:00:20 | 
2021-12-17 02:00:20.076186 (MainThread): 10:00:20 | Finished running 1 incremental model, 3 table models, 2 view models in 12.03s.
2021-12-17 02:00:20.076455 (MainThread): Connection 'master' was properly closed.
2021-12-17 02:00:20.076669 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-17 02:00:20.084173 (MainThread): 
2021-12-17 02:00:20.084500 (MainThread): Completed successfully
2021-12-17 02:00:20.084760 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-17 02:00:20.085076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06484ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb064b12d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0623c8f10>]}
2021-12-17 02:00:20.085441 (MainThread): Flushing usage events
2021-12-17 02:02:47.232173 (MainThread): Running with dbt=0.21.0
2021-12-17 02:02:48.117678 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example', 'join_data'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 02:02:48.119327 (MainThread): Tracking: tracking
2021-12-17 02:02:48.119898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fd5ebb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff603a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff603a90>]}
2021-12-17 02:02:48.131053 (MainThread): Partial parsing not enabled
2021-12-17 02:02:48.141196 (MainThread): Parsing macros/catalog.sql
2021-12-17 02:02:48.144298 (MainThread): Parsing macros/adapters.sql
2021-12-17 02:02:48.178347 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 02:02:48.182013 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 02:02:48.186147 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 02:02:48.187399 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 02:02:48.190454 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 02:02:48.198842 (MainThread): Parsing macros/core.sql
2021-12-17 02:02:48.202259 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 02:02:48.208423 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 02:02:48.217325 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 02:02:48.219193 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 02:02:48.236644 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 02:02:48.268097 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 02:02:48.289051 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 02:02:48.290762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 02:02:48.299915 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 02:02:48.317719 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 02:02:48.331065 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 02:02:48.337678 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 02:02:48.343746 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 02:02:48.347370 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 02:02:48.348547 (MainThread): Parsing macros/etc/query.sql
2021-12-17 02:02:48.349389 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 02:02:48.350576 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 02:02:48.357410 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 02:02:48.358823 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 02:02:48.360829 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 02:02:48.362133 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 02:02:48.409082 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 02:02:48.410574 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 02:02:48.411540 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 02:02:48.412591 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 02:02:48.631975 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:02:48.642981 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:02:48.645792 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:48.652074 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:02:48.654912 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:02:48.657621 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:02:48.697896 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff8085e0>]}
2021-12-17 02:02:48.702850 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff82f940>]}
2021-12-17 02:02:48.703201 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 02:02:48.703974 (MainThread): The selection criterion 'join_data' does not match any nodes
2021-12-17 02:02:48.704919 (MainThread): 
2021-12-17 02:02:48.705430 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:02:48.706543 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 02:02:48.716777 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 02:02:48.716935 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 02:02:48.717043 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 02:02:49.696748 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.98 seconds
2021-12-17 02:02:49.700076 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 02:02:49.883202 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 02:02:49.894850 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 02:02:49.895182 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 02:02:49.895408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 02:02:50.633823 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.74 seconds
2021-12-17 02:02:50.637600 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 02:02:50.848661 (MainThread): 10:02:50 | Concurrency: 1 threads (target='dev')
2021-12-17 02:02:50.849188 (MainThread): 10:02:50 | 
2021-12-17 02:02:50.851285 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 02:02:50.851840 (Thread-1): 10:02:50 | 1 of 6 START incremental model dbt.dates............................. [RUN]
2021-12-17 02:02:50.852435 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:50.852727 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 02:02:50.862365 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:02:50.863075 (Thread-1): finished collecting timing info
2021-12-17 02:02:50.908890 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:50.909103 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 02:02:50.909236 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:02:52.660334 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-12-17 02:02:52.677941 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:52.678235 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 02:02:52.789144 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 02:02:52.798505 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:52.798827 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 02:02:52.908099 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 02:02:52.923983 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:52.924294 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 02:02:53.046547 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 02:02:53.084098 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:02:53.086586 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:53.086737 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 02:02:53.204941 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 02:02:53.205987 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:53.206296 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 02:02:53.684147 (Thread-1): SQL status: SUCCESS 0 in 0.48 seconds
2021-12-17 02:02:53.684907 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:02:53.685201 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 02:02:53.889478 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-12-17 02:02:53.909754 (Thread-1): finished collecting timing info
2021-12-17 02:02:53.910082 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 02:02:54.089178 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffba4f10>]}
2021-12-17 02:02:54.090018 (Thread-1): 10:02:54 | 1 of 6 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.24s]
2021-12-17 02:02:54.090329 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 02:02:54.090606 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:02:54.091252 (Thread-1): 10:02:54 | 2 of 6 START table model dbt.first_model_2........................... [RUN]
2021-12-17 02:02:54.091783 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:02:54.092018 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:02:54.096319 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:02:54.096989 (Thread-1): finished collecting timing info
2021-12-17 02:02:54.107370 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:02:54.108738 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:02:54.108936 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 02:02:54.109083 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:02:55.425800 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-12-17 02:02:55.429157 (Thread-1): finished collecting timing info
2021-12-17 02:02:55.429614 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 02:02:55.597908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffd19520>]}
2021-12-17 02:02:55.598989 (Thread-1): 10:02:55 | 2 of 6 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.51s]
2021-12-17 02:02:55.599486 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:02:55.599930 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:02:55.600899 (Thread-1): 10:02:55 | 3 of 6 START view model dbt.orders_data.............................. [RUN]
2021-12-17 02:02:55.601798 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:02:55.602118 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 02:02:55.605716 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:02:55.606560 (Thread-1): finished collecting timing info
2021-12-17 02:02:55.626998 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:02:55.627831 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:02:55.627996 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 02:02:55.628129 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:02:56.448963 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-12-17 02:02:56.452459 (Thread-1): finished collecting timing info
2021-12-17 02:02:56.452914 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 02:02:56.617678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffd19d60>]}
2021-12-17 02:02:56.618432 (Thread-1): 10:02:56 | 3 of 6 OK created view model dbt.orders_data......................... [SUCCESS 1 in 1.02s]
2021-12-17 02:02:56.618782 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:02:56.619105 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:02:56.619531 (Thread-1): 10:02:56 | 4 of 6 START view model dbt.raw_data................................. [RUN]
2021-12-17 02:02:56.620364 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:02:56.620694 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 02:02:56.624247 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:02:56.624986 (Thread-1): finished collecting timing info
2021-12-17 02:02:56.628016 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:02:56.629043 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:02:56.629266 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 02:02:56.629469 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:02:57.284615 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-12-17 02:02:57.287998 (Thread-1): finished collecting timing info
2021-12-17 02:02:57.288456 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 02:02:57.458248 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffb06d00>]}
2021-12-17 02:02:57.459155 (Thread-1): 10:02:57 | 4 of 6 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.84s]
2021-12-17 02:02:57.459582 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:02:57.459985 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:02:57.460513 (Thread-1): 10:02:57 | 5 of 6 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 02:02:57.461210 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:02:57.461546 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:02:57.465361 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:02:57.466277 (Thread-1): finished collecting timing info
2021-12-17 02:02:57.469579 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:02:57.471084 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:02:57.471304 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 02:02:57.471506 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:02:59.521706 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2021-12-17 02:02:59.525152 (Thread-1): finished collecting timing info
2021-12-17 02:02:59.525594 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 02:02:59.695942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffe26910>]}
2021-12-17 02:02:59.696939 (Thread-1): 10:02:59 | 5 of 6 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.23s]
2021-12-17 02:02:59.697382 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:02:59.697789 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:02:59.698314 (Thread-1): 10:02:59 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 02:02:59.699083 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:02:59.699375 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:02:59.703114 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:02:59.704048 (Thread-1): finished collecting timing info
2021-12-17 02:02:59.707349 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:02:59.708510 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:02:59.708731 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 02:02:59.708936 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:03:01.158842 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-12-17 02:03:01.161078 (Thread-1): finished collecting timing info
2021-12-17 02:03:01.161396 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 02:03:01.523415 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67df65-1ef8-43f9-8398-7363fa8a118e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ffe0e6d0>]}
2021-12-17 02:03:01.524330 (Thread-1): 10:03:01 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.82s]
2021-12-17 02:03:01.524770 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:03:01.527206 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:03:01.527938 (MainThread): 10:03:01 | 
2021-12-17 02:03:01.528261 (MainThread): 10:03:01 | Finished running 1 incremental model, 3 table models, 2 view models in 12.82s.
2021-12-17 02:03:01.528527 (MainThread): Connection 'master' was properly closed.
2021-12-17 02:03:01.528739 (MainThread): Connection 'model.jrtests_learn_dbt1.my_second_dbt_model' was properly closed.
2021-12-17 02:03:01.536188 (MainThread): 
2021-12-17 02:03:01.536522 (MainThread): Completed successfully
2021-12-17 02:03:01.536775 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-17 02:03:01.537082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff613310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ff831610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fd5ebb50>]}
2021-12-17 02:03:01.537428 (MainThread): Flushing usage events
2021-12-17 02:13:34.349712 (MainThread): Running with dbt=0.21.0
2021-12-17 02:13:35.179496 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 02:13:35.181056 (MainThread): Tracking: tracking
2021-12-17 02:13:35.181641 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa4cebe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7603a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7603b50>]}
2021-12-17 02:13:35.193687 (MainThread): Partial parsing not enabled
2021-12-17 02:13:35.204444 (MainThread): Parsing macros/catalog.sql
2021-12-17 02:13:35.207875 (MainThread): Parsing macros/adapters.sql
2021-12-17 02:13:35.242759 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 02:13:35.246371 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 02:13:35.250556 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 02:13:35.251796 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 02:13:35.254665 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 02:13:35.262664 (MainThread): Parsing macros/core.sql
2021-12-17 02:13:35.266025 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 02:13:35.271890 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 02:13:35.280301 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 02:13:35.282994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 02:13:35.298899 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 02:13:35.329224 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 02:13:35.349878 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 02:13:35.351581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 02:13:35.360550 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 02:13:35.376705 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 02:13:35.387839 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 02:13:35.394835 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 02:13:35.400892 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 02:13:35.403899 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 02:13:35.405045 (MainThread): Parsing macros/etc/query.sql
2021-12-17 02:13:35.405769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 02:13:35.406939 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 02:13:35.413702 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 02:13:35.415108 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 02:13:35.416979 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 02:13:35.418213 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 02:13:35.464201 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 02:13:35.465579 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 02:13:35.466513 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 02:13:35.467564 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 02:13:35.685788 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:13:35.696477 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:13:35.699691 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:13:35.702418 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:35.708397 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:13:35.711143 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:13:35.714634 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:13:35.756143 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa777ad90>]}
2021-12-17 02:13:35.760489 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa77089d0>]}
2021-12-17 02:13:35.760822 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 02:13:35.761998 (MainThread): 
2021-12-17 02:13:35.762440 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:13:35.764049 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 02:13:35.774507 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 02:13:35.774669 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 02:13:35.774775 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 02:13:36.677696 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-12-17 02:13:36.682083 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 02:13:36.848445 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 02:13:36.860115 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 02:13:36.860436 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 02:13:36.860653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 02:13:37.570793 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.71 seconds
2021-12-17 02:13:37.574624 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 02:13:37.734169 (MainThread): 10:13:37 | Concurrency: 1 threads (target='dev')
2021-12-17 02:13:37.734772 (MainThread): 10:13:37 | 
2021-12-17 02:13:37.737407 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 02:13:37.737993 (Thread-1): 10:13:37 | 1 of 7 START incremental model dbt.dates............................. [RUN]
2021-12-17 02:13:37.738692 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:37.739020 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 02:13:37.747738 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:13:37.748533 (Thread-1): finished collecting timing info
2021-12-17 02:13:37.792000 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:37.792285 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 02:13:37.792420 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:39.320969 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-12-17 02:13:39.338421 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:39.338724 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 02:13:39.475230 (Thread-1): SQL status: SUCCESS 28 in 0.14 seconds
2021-12-17 02:13:39.484678 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:39.485008 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 02:13:39.592966 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 02:13:39.608370 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:39.608685 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 02:13:39.709133 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:13:39.745056 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:13:39.747594 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:39.747753 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 02:13:39.926972 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-17 02:13:39.928098 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:39.928434 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 02:13:40.528976 (Thread-1): SQL status: SUCCESS 0 in 0.60 seconds
2021-12-17 02:13:40.529758 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:13:40.530225 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 02:13:40.804243 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-12-17 02:13:40.823128 (Thread-1): finished collecting timing info
2021-12-17 02:13:40.823480 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 02:13:41.013751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7ca86a0>]}
2021-12-17 02:13:41.014645 (Thread-1): 10:13:41 | 1 of 7 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.28s]
2021-12-17 02:13:41.015014 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 02:13:41.015503 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:13:41.015968 (Thread-1): 10:13:41 | 2 of 7 START table model dbt.first_model_2........................... [RUN]
2021-12-17 02:13:41.016713 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:13:41.017036 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:13:41.023306 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:13:41.024369 (Thread-1): finished collecting timing info
2021-12-17 02:13:41.035788 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:13:41.037190 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:13:41.037393 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 02:13:41.037553 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:42.195017 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-12-17 02:13:42.198485 (Thread-1): finished collecting timing info
2021-12-17 02:13:42.198942 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 02:13:42.572357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7e13700>]}
2021-12-17 02:13:42.573272 (Thread-1): 10:13:42 | 2 of 7 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.56s]
2021-12-17 02:13:42.573710 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:13:42.574115 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:13:42.575132 (Thread-1): 10:13:42 | 3 of 7 START view model dbt.orders_data.............................. [RUN]
2021-12-17 02:13:42.575901 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:13:42.576226 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 02:13:42.579799 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:13:42.580707 (Thread-1): finished collecting timing info
2021-12-17 02:13:42.601362 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:13:42.602236 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:13:42.602413 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 02:13:42.602557 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:43.272379 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 02:13:43.275800 (Thread-1): finished collecting timing info
2021-12-17 02:13:43.276256 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 02:13:43.452117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7c9d130>]}
2021-12-17 02:13:43.453040 (Thread-1): 10:13:43 | 3 of 7 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.88s]
2021-12-17 02:13:43.453474 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:13:43.453880 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:13:43.454401 (Thread-1): 10:13:43 | 4 of 7 START view model dbt.raw_data................................. [RUN]
2021-12-17 02:13:43.455317 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:13:43.455724 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 02:13:43.459361 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:13:43.460247 (Thread-1): finished collecting timing info
2021-12-17 02:13:43.463627 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:13:43.464680 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:13:43.464910 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 02:13:43.465115 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:44.151230 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-12-17 02:13:44.154700 (Thread-1): finished collecting timing info
2021-12-17 02:13:44.155153 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 02:13:44.321214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7ccbd60>]}
2021-12-17 02:13:44.322140 (Thread-1): 10:13:44 | 4 of 7 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.87s]
2021-12-17 02:13:44.322493 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:13:44.322826 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:13:44.323278 (Thread-1): 10:13:44 | 5 of 7 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 02:13:44.324075 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:13:44.324620 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:13:44.328375 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:13:44.329136 (Thread-1): finished collecting timing info
2021-12-17 02:13:44.332921 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:13:44.334451 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:13:44.334654 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 02:13:44.334832 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:46.184930 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-17 02:13:46.188440 (Thread-1): finished collecting timing info
2021-12-17 02:13:46.188900 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 02:13:46.354594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7dd8a90>]}
2021-12-17 02:13:46.355547 (Thread-1): 10:13:46 | 5 of 7 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.03s]
2021-12-17 02:13:46.355992 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:13:46.356394 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:13:46.356903 (Thread-1): 10:13:46 | 6 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 02:13:46.357845 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:13:46.358177 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:13:46.361873 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:13:46.362739 (Thread-1): finished collecting timing info
2021-12-17 02:13:46.365912 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:13:46.367067 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:13:46.367294 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 02:13:46.367508 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:47.618304 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-12-17 02:13:47.621760 (Thread-1): finished collecting timing info
2021-12-17 02:13:47.622213 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 02:13:47.792513 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7dd8f10>]}
2021-12-17 02:13:47.793439 (Thread-1): 10:13:47 | 6 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.43s]
2021-12-17 02:13:47.793873 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:13:47.794274 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:13:47.794781 (Thread-1): 10:13:47 | 7 of 7 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 02:13:47.795449 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:13:47.795784 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:13:47.800699 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:13:47.801575 (Thread-1): finished collecting timing info
2021-12-17 02:13:47.804695 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:13:47.806675 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:13:47.806940 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp()
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 02:13:47.807160 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:13:48.744665 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-12-17 02:13:48.748126 (Thread-1): finished collecting timing info
2021-12-17 02:13:48.748583 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 02:13:48.910819 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd4565d4-75e8-4bde-8e3c-3e2ccf8985e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa7c74640>]}
2021-12-17 02:13:48.911766 (Thread-1): 10:13:48 | 7 of 7 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.12s]
2021-12-17 02:13:48.912224 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:13:48.914017 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:13:48.914681 (MainThread): 10:13:48 | 
2021-12-17 02:13:48.914994 (MainThread): 10:13:48 | Finished running 1 incremental model, 3 table models, 3 view models in 13.15s.
2021-12-17 02:13:48.915264 (MainThread): Connection 'master' was properly closed.
2021-12-17 02:13:48.915484 (MainThread): Connection 'model.jrtests_learn_dbt1.raw_join_transform' was properly closed.
2021-12-17 02:13:48.924724 (MainThread): 
2021-12-17 02:13:48.925247 (MainThread): Completed successfully
2021-12-17 02:13:48.925611 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-12-17 02:13:48.925936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa77082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa777ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa75f96a0>]}
2021-12-17 02:13:48.926297 (MainThread): Flushing usage events
2021-12-17 02:15:26.234966 (MainThread): Running with dbt=0.21.0
2021-12-17 02:15:27.065368 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 02:15:27.066963 (MainThread): Tracking: tracking
2021-12-17 02:15:27.067576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba85cebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba888019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88801a60>]}
2021-12-17 02:15:27.079146 (MainThread): Partial parsing not enabled
2021-12-17 02:15:27.090092 (MainThread): Parsing macros/catalog.sql
2021-12-17 02:15:27.093682 (MainThread): Parsing macros/adapters.sql
2021-12-17 02:15:27.130152 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 02:15:27.134435 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 02:15:27.138642 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 02:15:27.139879 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 02:15:27.142763 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 02:15:27.150730 (MainThread): Parsing macros/core.sql
2021-12-17 02:15:27.154084 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 02:15:27.160328 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 02:15:27.170835 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 02:15:27.172474 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 02:15:27.189507 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 02:15:27.221257 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 02:15:27.242661 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 02:15:27.244301 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 02:15:27.253784 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 02:15:27.271394 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 02:15:27.283040 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 02:15:27.289432 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 02:15:27.295294 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 02:15:27.299066 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 02:15:27.300254 (MainThread): Parsing macros/etc/query.sql
2021-12-17 02:15:27.300991 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 02:15:27.302297 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 02:15:27.309763 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 02:15:27.311625 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 02:15:27.313572 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 02:15:27.314801 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 02:15:27.360484 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 02:15:27.361864 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 02:15:27.362808 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 02:15:27.363848 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 02:15:27.576999 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:15:27.589093 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:15:27.592707 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:15:27.595805 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:27.601493 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba888e7a00>]}
2021-12-17 02:15:27.602456 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:15:27.605491 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:15:27.608388 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:15:27.649871 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88906b50>]}
2021-12-17 02:15:27.654015 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88958b50>]}
2021-12-17 02:15:27.654344 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 02:15:27.655542 (MainThread): 
2021-12-17 02:15:27.656036 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:15:27.657561 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 02:15:27.669934 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 02:15:27.670218 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 02:15:27.670442 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 02:15:28.932030 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.26 seconds
2021-12-17 02:15:28.935464 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 02:15:29.114608 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 02:15:29.126232 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 02:15:29.126534 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 02:15:29.126757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 02:15:29.844380 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.72 seconds
2021-12-17 02:15:29.848425 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 02:15:30.032477 (MainThread): 10:15:30 | Concurrency: 1 threads (target='dev')
2021-12-17 02:15:30.033008 (MainThread): 10:15:30 | 
2021-12-17 02:15:30.035792 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 02:15:30.036438 (Thread-1): 10:15:30 | 1 of 7 START incremental model dbt.dates............................. [RUN]
2021-12-17 02:15:30.037058 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:30.037354 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 02:15:30.046132 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:15:30.047091 (Thread-1): finished collecting timing info
2021-12-17 02:15:30.093658 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:30.093875 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 02:15:30.094006 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:32.068294 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2021-12-17 02:15:32.083904 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:32.084165 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 02:15:32.199714 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 02:15:32.209071 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:32.209379 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 02:15:32.308648 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:15:32.323983 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:32.324277 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 02:15:32.420486 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:15:32.456648 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:15:32.459211 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:32.459376 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 02:15:32.581637 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 02:15:32.582729 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:32.583133 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 02:15:33.092811 (Thread-1): SQL status: SUCCESS 0 in 0.51 seconds
2021-12-17 02:15:33.093579 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:15:33.094036 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 02:15:33.270238 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-17 02:15:33.289300 (Thread-1): finished collecting timing info
2021-12-17 02:15:33.289718 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 02:15:33.473144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88ca8490>]}
2021-12-17 02:15:33.474092 (Thread-1): 10:15:33 | 1 of 7 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.44s]
2021-12-17 02:15:33.474557 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 02:15:33.474970 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:15:33.475488 (Thread-1): 10:15:33 | 2 of 7 START table model dbt.first_model_2........................... [RUN]
2021-12-17 02:15:33.476166 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:15:33.476516 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:15:33.483194 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:15:33.483981 (Thread-1): finished collecting timing info
2021-12-17 02:15:33.496141 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:15:33.497437 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:15:33.497633 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 02:15:33.497796 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:34.628601 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-12-17 02:15:34.632592 (Thread-1): finished collecting timing info
2021-12-17 02:15:34.633114 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 02:15:34.801711 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88c85af0>]}
2021-12-17 02:15:34.802623 (Thread-1): 10:15:34 | 2 of 7 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.33s]
2021-12-17 02:15:34.803052 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:15:34.803459 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:15:34.803967 (Thread-1): 10:15:34 | 3 of 7 START view model dbt.orders_data.............................. [RUN]
2021-12-17 02:15:34.805148 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:15:34.805539 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 02:15:34.809142 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:15:34.809996 (Thread-1): finished collecting timing info
2021-12-17 02:15:34.830451 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:15:34.831301 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:15:34.831476 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 02:15:34.831622 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:35.505246 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 02:15:35.509222 (Thread-1): finished collecting timing info
2021-12-17 02:15:35.509739 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 02:15:35.686060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88f403d0>]}
2021-12-17 02:15:35.687017 (Thread-1): 10:15:35 | 3 of 7 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.88s]
2021-12-17 02:15:35.687509 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:15:35.687920 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:15:35.688442 (Thread-1): 10:15:35 | 4 of 7 START view model dbt.raw_data................................. [RUN]
2021-12-17 02:15:35.689385 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:15:35.689714 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 02:15:35.693365 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:15:35.694203 (Thread-1): finished collecting timing info
2021-12-17 02:15:35.697557 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:15:35.698564 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:15:35.698786 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 02:15:35.698992 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:36.346261 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-12-17 02:15:36.349685 (Thread-1): finished collecting timing info
2021-12-17 02:15:36.350145 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 02:15:36.518313 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88cd9040>]}
2021-12-17 02:15:36.519254 (Thread-1): 10:15:36 | 4 of 7 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.83s]
2021-12-17 02:15:36.519693 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:15:36.520106 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:15:36.520653 (Thread-1): 10:15:36 | 5 of 7 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 02:15:36.521875 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:15:36.522278 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:15:36.526030 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:15:36.526883 (Thread-1): finished collecting timing info
2021-12-17 02:15:36.530961 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:15:36.532521 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:15:36.532765 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 02:15:36.532965 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:38.315357 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2021-12-17 02:15:38.318748 (Thread-1): finished collecting timing info
2021-12-17 02:15:38.319211 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 02:15:38.484943 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88d73f10>]}
2021-12-17 02:15:38.485860 (Thread-1): 10:15:38 | 5 of 7 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.96s]
2021-12-17 02:15:38.486294 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:15:38.486699 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:15:38.487218 (Thread-1): 10:15:38 | 6 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 02:15:38.488152 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:15:38.488531 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:15:38.492288 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:15:38.493133 (Thread-1): finished collecting timing info
2021-12-17 02:15:38.496310 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:15:38.497466 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:15:38.497676 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 02:15:38.497883 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:39.953528 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-12-17 02:15:39.956973 (Thread-1): finished collecting timing info
2021-12-17 02:15:39.957422 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 02:15:40.122278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88d98280>]}
2021-12-17 02:15:40.123033 (Thread-1): 10:15:40 | 6 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.63s]
2021-12-17 02:15:40.123377 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:15:40.123697 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:15:40.124324 (Thread-1): 10:15:40 | 7 of 7 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 02:15:40.125000 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:15:40.125298 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:15:40.129483 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:15:40.130216 (Thread-1): finished collecting timing info
2021-12-17 02:15:40.133243 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:15:40.134894 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:15:40.135080 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 02:15:40.135253 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:15:41.083218 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-12-17 02:15:41.086283 (Thread-1): finished collecting timing info
2021-12-17 02:15:41.086731 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 02:15:41.250648 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165b199e-b3ee-4e61-a94b-99b09edfcaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88cbba00>]}
2021-12-17 02:15:41.251561 (Thread-1): 10:15:41 | 7 of 7 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.13s]
2021-12-17 02:15:41.252012 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:15:41.254360 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:15:41.255108 (MainThread): 10:15:41 | 
2021-12-17 02:15:41.255413 (MainThread): 10:15:41 | Finished running 1 incremental model, 3 table models, 3 view models in 13.60s.
2021-12-17 02:15:41.255674 (MainThread): Connection 'master' was properly closed.
2021-12-17 02:15:41.255888 (MainThread): Connection 'model.jrtests_learn_dbt1.raw_join_transform' was properly closed.
2021-12-17 02:15:41.264187 (MainThread): 
2021-12-17 02:15:41.264495 (MainThread): Completed successfully
2021-12-17 02:15:41.264749 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-12-17 02:15:41.265090 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87ff66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8892cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba88c0c070>]}
2021-12-17 02:15:41.265430 (MainThread): Flushing usage events
2021-12-17 02:59:25.178852 (MainThread): Running with dbt=0.21.0
2021-12-17 02:59:25.998028 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 02:59:25.999680 (MainThread): Tracking: tracking
2021-12-17 02:59:26.000175 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdba3c8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc802970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc802a00>]}
2021-12-17 02:59:26.013494 (MainThread): Partial parsing not enabled
2021-12-17 02:59:26.023993 (MainThread): Parsing macros/catalog.sql
2021-12-17 02:59:26.027539 (MainThread): Parsing macros/adapters.sql
2021-12-17 02:59:26.062389 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 02:59:26.066016 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 02:59:26.070134 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 02:59:26.071354 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 02:59:26.074214 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 02:59:26.082389 (MainThread): Parsing macros/core.sql
2021-12-17 02:59:26.085755 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 02:59:26.091865 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 02:59:26.101862 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 02:59:26.103468 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 02:59:26.120622 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 02:59:26.152052 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 02:59:26.171959 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 02:59:26.173459 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 02:59:26.182073 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 02:59:26.199373 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 02:59:26.214032 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 02:59:26.221418 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 02:59:26.227992 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 02:59:26.231035 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 02:59:26.232200 (MainThread): Parsing macros/etc/query.sql
2021-12-17 02:59:26.232953 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 02:59:26.234235 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 02:59:26.242132 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 02:59:26.243896 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 02:59:26.246076 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 02:59:26.247496 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 02:59:26.297014 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 02:59:26.298594 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 02:59:26.299529 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 02:59:26.300583 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 02:59:26.508510 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:59:26.519801 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:59:26.523052 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:59:26.525914 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:26.531967 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:59:26.534734 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 02:59:26.538475 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:59:26.541623 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:59:26.589993 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc821490>]}
2021-12-17 02:59:26.594706 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc821910>]}
2021-12-17 02:59:26.595042 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 02:59:26.596431 (MainThread): 
2021-12-17 02:59:26.596936 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:59:26.598238 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 02:59:26.608329 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 02:59:26.608483 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 02:59:26.608588 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 02:59:27.518405 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.91 seconds
2021-12-17 02:59:27.521875 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 02:59:27.694228 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 02:59:27.705250 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 02:59:27.705553 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 02:59:27.705778 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 02:59:28.415125 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.71 seconds
2021-12-17 02:59:28.418838 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 02:59:28.583795 (MainThread): 10:59:28 | Concurrency: 1 threads (target='dev')
2021-12-17 02:59:28.584334 (MainThread): 10:59:28 | 
2021-12-17 02:59:28.586484 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 02:59:28.587037 (Thread-1): 10:59:28 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 02:59:28.587609 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:28.587894 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 02:59:28.596739 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:59:28.597596 (Thread-1): finished collecting timing info
2021-12-17 02:59:28.641025 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:28.641383 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 02:59:28.641587 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:30.183202 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-17 02:59:30.200917 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:30.201239 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 02:59:30.318374 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 02:59:30.328083 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:30.328430 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 02:59:30.432355 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 02:59:30.448305 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:30.448599 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 02:59:30.542978 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-12-17 02:59:30.578190 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 02:59:30.580745 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:30.580908 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 02:59:30.701119 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 02:59:30.701868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:30.702203 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 02:59:31.408727 (Thread-1): SQL status: SUCCESS 0 in 0.71 seconds
2021-12-17 02:59:31.409494 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 02:59:31.409957 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 02:59:31.590805 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-17 02:59:31.609745 (Thread-1): finished collecting timing info
2021-12-17 02:59:31.610101 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 02:59:31.787702 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce00250>]}
2021-12-17 02:59:31.789032 (Thread-1): 10:59:31 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.20s]
2021-12-17 02:59:31.789689 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 02:59:31.790317 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:59:31.791542 (Thread-1): 10:59:31 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 02:59:31.792678 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:59:31.793225 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:59:31.800183 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:59:31.801149 (Thread-1): finished collecting timing info
2021-12-17 02:59:31.815117 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 02:59:31.816542 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 02:59:31.816746 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 02:59:31.816929 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:33.046488 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-12-17 02:59:33.049527 (Thread-1): finished collecting timing info
2021-12-17 02:59:33.049995 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 02:59:33.212095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce00790>]}
2021-12-17 02:59:33.213033 (Thread-1): 10:59:33 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.42s]
2021-12-17 02:59:33.213488 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 02:59:33.213902 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:59:33.214423 (Thread-1): 10:59:33 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 02:59:33.215399 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:59:33.215811 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 02:59:33.219418 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:59:33.220315 (Thread-1): finished collecting timing info
2021-12-17 02:59:33.240811 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 02:59:33.241709 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 02:59:33.241882 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 02:59:33.242021 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:33.907483 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 02:59:33.910897 (Thread-1): finished collecting timing info
2021-12-17 02:59:33.911364 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 02:59:34.078403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce1fc70>]}
2021-12-17 02:59:34.079329 (Thread-1): 10:59:34 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.86s]
2021-12-17 02:59:34.079778 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 02:59:34.080192 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:59:34.080723 (Thread-1): 10:59:34 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 02:59:34.081678 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:59:34.082099 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 02:59:34.085783 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:59:34.086606 (Thread-1): finished collecting timing info
2021-12-17 02:59:34.090030 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 02:59:34.091125 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 02:59:34.091362 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 02:59:34.091570 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:34.819249 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-12-17 02:59:34.822638 (Thread-1): finished collecting timing info
2021-12-17 02:59:34.823096 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 02:59:34.993069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce77610>]}
2021-12-17 02:59:34.993993 (Thread-1): 10:59:34 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.91s]
2021-12-17 02:59:34.994463 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 02:59:34.994875 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:59:34.995432 (Thread-1): 10:59:34 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 02:59:34.996425 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:59:34.996768 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:59:35.000486 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:59:35.001433 (Thread-1): finished collecting timing info
2021-12-17 02:59:35.005099 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 02:59:35.006965 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 02:59:35.007493 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 02:59:35.007945 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:36.940980 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2021-12-17 02:59:36.944348 (Thread-1): finished collecting timing info
2021-12-17 02:59:36.944809 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 02:59:37.125390 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbcc8f0a0>]}
2021-12-17 02:59:37.126318 (Thread-1): 10:59:37 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.13s]
2021-12-17 02:59:37.126785 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 02:59:37.127206 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:59:37.127733 (Thread-1): 10:59:37 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 02:59:37.128686 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:59:37.129023 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:59:37.132782 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:59:37.133695 (Thread-1): finished collecting timing info
2021-12-17 02:59:37.136854 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 02:59:37.138052 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 02:59:37.138284 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 02:59:37.138485 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:38.678863 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-17 02:59:38.682178 (Thread-1): finished collecting timing info
2021-12-17 02:59:38.682674 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 02:59:38.850085 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbcb71b80>]}
2021-12-17 02:59:38.851009 (Thread-1): 10:59:38 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.72s]
2021-12-17 02:59:38.851450 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 02:59:38.851870 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:59:38.852388 (Thread-1): 10:59:38 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 02:59:38.853053 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:59:38.853437 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:59:38.858175 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:59:38.859242 (Thread-1): finished collecting timing info
2021-12-17 02:59:38.862417 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 02:59:38.864326 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 02:59:38.864587 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 02:59:38.864798 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 02:59:39.805487 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-12-17 02:59:39.808921 (Thread-1): finished collecting timing info
2021-12-17 02:59:39.809379 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 02:59:40.000475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce16340>]}
2021-12-17 02:59:40.001533 (Thread-1): 10:59:40 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.15s]
2021-12-17 02:59:40.002008 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 02:59:40.003234 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 02:59:40.004361 (Thread-1): 10:59:40 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 02:59:40.005008 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 02:59:40.005302 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 02:59:40.014946 (Thread-1): finished collecting timing info
2021-12-17 02:59:40.015747 (Thread-1): Compilation Error in model target_table (models/example/target_table.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 383, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model target_table (models/example/target_table.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-12-17 02:59:40.024663 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86799ac-a62a-4492-b8da-e27aaab928cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbce16f70>]}
2021-12-17 02:59:40.025241 (Thread-1): 10:59:40 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 0.02s]
2021-12-17 02:59:40.025535 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 02:59:40.026953 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 02:59:40.027480 (MainThread): 10:59:40 | 
2021-12-17 02:59:40.027718 (MainThread): 10:59:40 | Finished running 2 incremental models, 3 table models, 3 view models in 13.43s.
2021-12-17 02:59:40.028050 (MainThread): Connection 'master' was properly closed.
2021-12-17 02:59:40.028239 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 02:59:40.034391 (MainThread): 
2021-12-17 02:59:40.034667 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 02:59:40.034853 (MainThread): 
2021-12-17 02:59:40.035131 (MainThread): Compilation Error in model target_table (models/example/target_table.sql)
2021-12-17 02:59:40.035296 (MainThread):   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-12-17 02:59:40.035471 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 02:59:40.035707 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc821490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbc8218b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbcb4d190>]}
2021-12-17 02:59:40.035984 (MainThread): Flushing usage events
2021-12-17 03:01:41.713829 (MainThread): Running with dbt=0.21.0
2021-12-17 03:01:42.542039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-17 03:01:42.542414 (MainThread): Tracking: tracking
2021-12-17 03:01:42.542587 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9714f46550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9712cc7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9714f012b0>]}
2021-12-17 03:01:42.542829 (MainThread): Warning: No packages were found in packages.yml
2021-12-17 03:01:42.543023 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ed15640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9714f46550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9714f012b0>]}
2021-12-17 03:01:42.543336 (MainThread): Flushing usage events
2021-12-17 03:02:45.090848 (MainThread): Running with dbt=0.21.0
2021-12-17 03:02:45.918579 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-17 03:02:45.918987 (MainThread): Tracking: tracking
2021-12-17 03:02:45.919176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c64d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c64d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c601220>]}
2021-12-17 03:02:45.920633 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-_s14w7jw'
2021-12-17 03:02:45.920958 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-12-17 03:02:46.290809 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-12-17 03:02:46.291448 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-17 03:02:46.569085 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-17 03:02:46.597779 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-17 03:02:46.861448 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-17 03:02:46.861988 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-17 03:02:47.126296 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-17 03:02:47.155075 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-17 03:02:47.420448 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-17 03:02:47.421165 (MainThread): Installing dbt-labs/dbt_utils@0.7.6
2021-12-17 03:02:48.289349 (MainThread):   Installed from version 0.7.6
2021-12-17 03:02:48.289575 (MainThread):   Updated version available: 0.8.0
2021-12-17 03:02:48.289769 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '170a5537-6f7a-4275-8b05-f9271ed22c4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c64d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c601310>]}
2021-12-17 03:02:48.289991 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2021-12-17 03:02:48.290611 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c669070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa59cabaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c64de50>]}
2021-12-17 03:02:48.290819 (MainThread): Flushing usage events
2021-12-17 03:03:03.269775 (MainThread): Running with dbt=0.21.0
2021-12-17 03:03:04.125005 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 03:03:04.126798 (MainThread): Tracking: tracking
2021-12-17 03:03:04.127421 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca51dabfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca53f05be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca53f05ca0>]}
2021-12-17 03:03:04.146227 (MainThread): Partial parsing not enabled
2021-12-17 03:03:04.166316 (MainThread): Parsing macros/catalog.sql
2021-12-17 03:03:04.168506 (MainThread): Parsing macros/adapters.sql
2021-12-17 03:03:04.201794 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 03:03:04.205379 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 03:03:04.209466 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 03:03:04.210669 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 03:03:04.213530 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 03:03:04.221474 (MainThread): Parsing macros/core.sql
2021-12-17 03:03:04.224964 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 03:03:04.231909 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 03:03:04.241583 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 03:03:04.243141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 03:03:04.259426 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 03:03:04.290629 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 03:03:04.311938 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 03:03:04.313533 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 03:03:04.322997 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 03:03:04.341662 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 03:03:04.354534 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 03:03:04.361039 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 03:03:04.367036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 03:03:04.370533 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 03:03:04.371718 (MainThread): Parsing macros/etc/query.sql
2021-12-17 03:03:04.372463 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 03:03:04.373633 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 03:03:04.381222 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 03:03:04.382685 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 03:03:04.384590 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 03:03:04.385914 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 03:03:04.432850 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 03:03:04.434198 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 03:03:04.435115 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 03:03:04.436139 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 03:03:04.437920 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 03:03:04.438735 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 03:03:04.439852 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 03:03:04.440616 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 03:03:04.444978 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 03:03:04.445980 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 03:03:04.446987 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 03:03:04.449219 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 03:03:04.450029 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 03:03:04.451915 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 03:03:04.460002 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 03:03:04.461460 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 03:03:04.462547 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 03:03:04.463649 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 03:03:04.464912 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 03:03:04.466120 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 03:03:04.466830 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 03:03:04.470024 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 03:03:04.474767 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 03:03:04.477564 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 03:03:04.479060 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 03:03:04.480204 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 03:03:04.481698 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 03:03:04.502543 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 03:03:04.504786 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 03:03:04.507000 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 03:03:04.508338 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 03:03:04.509246 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 03:03:04.510221 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 03:03:04.511123 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 03:03:04.512322 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 03:03:04.513759 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 03:03:04.515115 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 03:03:04.517013 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 03:03:04.518584 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 03:03:04.519607 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 03:03:04.521647 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 03:03:04.523615 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 03:03:04.524868 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 03:03:04.525901 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 03:03:04.528286 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 03:03:04.529939 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 03:03:04.531619 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 03:03:04.533443 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 03:03:04.535795 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 03:03:04.536961 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 03:03:04.540027 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 03:03:04.547626 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 03:03:04.551332 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 03:03:04.552605 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 03:03:04.555296 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 03:03:04.558703 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 03:03:04.561530 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 03:03:04.562842 (MainThread): Parsing macros/sql/star.sql
2021-12-17 03:03:04.565637 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 03:03:04.572052 (MainThread): Parsing macros/sql/union.sql
2021-12-17 03:03:04.579883 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 03:03:04.581021 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 03:03:04.583773 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 03:03:04.585059 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 03:03:04.586438 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 03:03:04.592083 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 03:03:04.596731 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 03:03:04.600205 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 03:03:04.602137 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 03:03:04.941560 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:03:04.952920 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:03:04.956448 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:03:04.959400 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:04.965938 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:03:04.968889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:03:04.985197 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:03:04.990223 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:03:05.053268 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca540e3f40>]}
2021-12-17 03:03:05.061282 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5414c0a0>]}
2021-12-17 03:03:05.061594 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 03:03:05.062874 (MainThread): 
2021-12-17 03:03:05.063275 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:03:05.064298 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 03:03:05.076304 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 03:03:05.076494 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 03:03:05.076618 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 03:03:06.007840 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.93 seconds
2021-12-17 03:03:06.010456 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 03:03:06.175467 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 03:03:06.187817 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 03:03:06.188119 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 03:03:06.188340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 03:03:07.011514 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.82 seconds
2021-12-17 03:03:07.014082 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 03:03:07.252236 (MainThread): 11:03:07 | Concurrency: 1 threads (target='dev')
2021-12-17 03:03:07.252782 (MainThread): 11:03:07 | 
2021-12-17 03:03:07.254952 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 03:03:07.255504 (Thread-1): 11:03:07 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 03:03:07.256084 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:07.256372 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 03:03:07.265895 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:03:07.266695 (Thread-1): finished collecting timing info
2021-12-17 03:03:07.313378 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:07.313632 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 03:03:07.313771 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:09.657923 (Thread-1): SQL status: SUCCESS 1 in 2.34 seconds
2021-12-17 03:03:09.675671 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:09.675974 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 03:03:09.845764 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-12-17 03:03:09.856025 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:09.856350 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 03:03:09.959993 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 03:03:09.976537 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:09.976838 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 03:03:10.081710 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 03:03:10.117576 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:03:10.120126 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:10.120293 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 03:03:10.237409 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 03:03:10.238479 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:10.238915 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 03:03:11.091848 (Thread-1): SQL status: SUCCESS 0 in 0.85 seconds
2021-12-17 03:03:11.092616 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:03:11.093082 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 03:03:11.275705 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-17 03:03:11.295014 (Thread-1): finished collecting timing info
2021-12-17 03:03:11.295359 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 03:03:11.469459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca544948b0>]}
2021-12-17 03:03:11.470442 (Thread-1): 11:03:11 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.21s]
2021-12-17 03:03:11.470886 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 03:03:11.471291 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:03:11.472177 (Thread-1): 11:03:11 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 03:03:11.472957 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:03:11.473341 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:03:11.478991 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:03:11.479800 (Thread-1): finished collecting timing info
2021-12-17 03:03:11.492333 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:03:11.493586 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:03:11.493773 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 03:03:11.493933 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:12.832480 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-12-17 03:03:12.835805 (Thread-1): finished collecting timing info
2021-12-17 03:03:12.836255 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 03:03:13.008524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca544940a0>]}
2021-12-17 03:03:13.009478 (Thread-1): 11:03:13 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.54s]
2021-12-17 03:03:13.009904 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:03:13.010325 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:03:13.010735 (Thread-1): 11:03:13 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 03:03:13.011536 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:03:13.012159 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 03:03:13.017283 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:03:13.018038 (Thread-1): finished collecting timing info
2021-12-17 03:03:13.037802 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:03:13.038699 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:03:13.038853 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 03:03:13.038977 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:13.717623 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 03:03:13.721129 (Thread-1): finished collecting timing info
2021-12-17 03:03:13.721590 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 03:03:13.893999 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca546a5ac0>]}
2021-12-17 03:03:13.894890 (Thread-1): 11:03:13 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.88s]
2021-12-17 03:03:13.895307 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:03:13.895703 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:03:13.896213 (Thread-1): 11:03:13 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 03:03:13.897161 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:03:13.897559 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 03:03:13.902246 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:03:13.903065 (Thread-1): finished collecting timing info
2021-12-17 03:03:13.906498 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:03:13.907589 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:03:13.907810 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 03:03:13.908007 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:14.570560 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-12-17 03:03:14.573961 (Thread-1): finished collecting timing info
2021-12-17 03:03:14.574458 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 03:03:14.743311 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca546a5400>]}
2021-12-17 03:03:14.744216 (Thread-1): 11:03:14 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.85s]
2021-12-17 03:03:14.744651 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:03:14.744969 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:03:14.745386 (Thread-1): 11:03:14 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 03:03:14.745911 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:03:14.746173 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:03:14.751083 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:03:14.751963 (Thread-1): finished collecting timing info
2021-12-17 03:03:14.755275 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:03:14.756759 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:03:14.756947 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 03:03:14.757121 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:16.420988 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-17 03:03:16.424511 (Thread-1): finished collecting timing info
2021-12-17 03:03:16.424968 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 03:03:16.596427 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca54615ee0>]}
2021-12-17 03:03:16.597341 (Thread-1): 11:03:16 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.85s]
2021-12-17 03:03:16.597768 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:03:16.598168 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:03:16.598683 (Thread-1): 11:03:16 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 03:03:16.599609 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:03:16.600014 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:03:16.604809 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:03:16.605675 (Thread-1): finished collecting timing info
2021-12-17 03:03:16.610317 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:03:16.611511 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:03:16.611729 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 03:03:16.611924 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:18.259520 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-17 03:03:18.262810 (Thread-1): finished collecting timing info
2021-12-17 03:03:18.263272 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 03:03:18.436672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca544cd460>]}
2021-12-17 03:03:18.437596 (Thread-1): 11:03:18 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.84s]
2021-12-17 03:03:18.438050 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:03:18.438459 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:03:18.438981 (Thread-1): 11:03:18 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 03:03:18.439916 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:03:18.440307 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:03:18.446046 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:03:18.446799 (Thread-1): finished collecting timing info
2021-12-17 03:03:18.450138 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:03:18.451950 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:03:18.452194 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 03:03:18.452369 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:19.386293 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-12-17 03:03:19.390344 (Thread-1): finished collecting timing info
2021-12-17 03:03:19.390820 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 03:03:19.557096 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca544cd1f0>]}
2021-12-17 03:03:19.558021 (Thread-1): 11:03:19 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.12s]
2021-12-17 03:03:19.558442 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:03:19.559375 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:03:19.559944 (Thread-1): 11:03:19 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 03:03:19.561031 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:03:19.561353 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 03:03:19.569691 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 03:03:19.570451 (Thread-1): finished collecting timing info
2021-12-17 03:03:19.574175 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 03:03:19.575690 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:03:19.575887 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */


      create or replace  table analytics.dbt.target_table  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.*, from raw_join_transform
)

select * from dailyrun


      );
2021-12-17 03:03:19.576063 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:03:20.264298 (Thread-1): Snowflake query id: 01a0fff7-3200-9b61-0000-00008a25a6e1
2021-12-17 03:03:20.264744 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 24 unexpected 'from'.
2021-12-17 03:03:20.265164 (Thread-1): finished collecting timing info
2021-12-17 03:03:20.265563 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 03:03:20.436506 (Thread-1): Database Error in model target_table (models/example/target_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 24 unexpected 'from'.
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/target_table.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 14 at position 24 unexpected 'from'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 125, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model target_table (models/example/target_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 24 unexpected 'from'.
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/target_table.sql
2021-12-17 03:03:20.438602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293dc618-e3ba-47ba-95c4-932316cab7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca54629ac0>]}
2021-12-17 03:03:20.439410 (Thread-1): 11:03:20 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 0.88s]
2021-12-17 03:03:20.439840 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:03:20.442005 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:03:20.442711 (MainThread): 11:03:20 | 
2021-12-17 03:03:20.443017 (MainThread): 11:03:20 | Finished running 2 incremental models, 3 table models, 3 view models in 15.38s.
2021-12-17 03:03:20.443279 (MainThread): Connection 'master' was properly closed.
2021-12-17 03:03:20.443493 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 03:03:20.455864 (MainThread): 
2021-12-17 03:03:20.456158 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 03:03:20.456360 (MainThread): 
2021-12-17 03:03:20.456553 (MainThread): Database Error in model target_table (models/example/target_table.sql)
2021-12-17 03:03:20.456724 (MainThread):   001003 (42000): SQL compilation error:
2021-12-17 03:03:20.456884 (MainThread):   syntax error line 14 at position 24 unexpected 'from'.
2021-12-17 03:03:20.457043 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/target_table.sql
2021-12-17 03:03:20.457233 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 03:03:20.457495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca540e3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca54091c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca546253d0>]}
2021-12-17 03:03:20.457789 (MainThread): Flushing usage events
2021-12-17 03:05:59.199137 (MainThread): Running with dbt=0.21.0
2021-12-17 03:06:00.051531 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 03:06:00.053178 (MainThread): Tracking: tracking
2021-12-17 03:06:00.053727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85caccdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd07ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd07eb20>]}
2021-12-17 03:06:00.073592 (MainThread): Partial parsing not enabled
2021-12-17 03:06:00.095173 (MainThread): Parsing macros/catalog.sql
2021-12-17 03:06:00.097727 (MainThread): Parsing macros/adapters.sql
2021-12-17 03:06:00.132270 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 03:06:00.135910 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 03:06:00.140017 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 03:06:00.141289 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 03:06:00.143971 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 03:06:00.151415 (MainThread): Parsing macros/core.sql
2021-12-17 03:06:00.155786 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 03:06:00.161587 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 03:06:00.171160 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 03:06:00.172667 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 03:06:00.188898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 03:06:00.219874 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 03:06:00.239076 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 03:06:00.240490 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 03:06:00.248720 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 03:06:00.265549 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 03:06:00.277509 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 03:06:00.285202 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 03:06:00.291259 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 03:06:00.294324 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 03:06:00.295484 (MainThread): Parsing macros/etc/query.sql
2021-12-17 03:06:00.296249 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 03:06:00.297443 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 03:06:00.304507 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 03:06:00.305981 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 03:06:00.307977 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 03:06:00.309276 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 03:06:00.356371 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 03:06:00.357709 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 03:06:00.358711 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 03:06:00.360379 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 03:06:00.362442 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 03:06:00.363308 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 03:06:00.364441 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 03:06:00.365209 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 03:06:00.369941 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 03:06:00.370946 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 03:06:00.371973 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 03:06:00.374212 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 03:06:00.375019 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 03:06:00.376877 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 03:06:00.385067 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 03:06:00.386549 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 03:06:00.387636 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 03:06:00.389001 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 03:06:00.390550 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 03:06:00.391763 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 03:06:00.392476 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 03:06:00.395284 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 03:06:00.399463 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 03:06:00.402431 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 03:06:00.403867 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 03:06:00.405027 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 03:06:00.406544 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 03:06:00.427012 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 03:06:00.428600 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 03:06:00.430647 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 03:06:00.432268 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 03:06:00.433555 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 03:06:00.435121 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 03:06:00.436575 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 03:06:00.438064 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 03:06:00.439657 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 03:06:00.441147 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 03:06:00.443178 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 03:06:00.444908 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 03:06:00.446030 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 03:06:00.448275 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 03:06:00.450239 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 03:06:00.451530 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 03:06:00.452703 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 03:06:00.455307 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 03:06:00.457165 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 03:06:00.458774 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 03:06:00.460525 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 03:06:00.462980 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 03:06:00.464493 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 03:06:00.467827 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 03:06:00.476305 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 03:06:00.480661 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 03:06:00.482176 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 03:06:00.485374 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 03:06:00.489337 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 03:06:00.492633 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 03:06:00.494257 (MainThread): Parsing macros/sql/star.sql
2021-12-17 03:06:00.497683 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 03:06:00.505472 (MainThread): Parsing macros/sql/union.sql
2021-12-17 03:06:00.513329 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 03:06:00.514576 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 03:06:00.517791 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 03:06:00.519286 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 03:06:00.520768 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 03:06:00.526592 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 03:06:00.531526 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 03:06:00.535326 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 03:06:00.537433 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 03:06:00.864692 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:06:00.880765 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:06:00.884879 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:06:00.887904 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:00.894206 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:06:00.897162 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:06:00.913657 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:06:00.918079 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:06:00.973959 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd24a5e0>]}
2021-12-17 03:06:00.981403 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd24cfa0>]}
2021-12-17 03:06:00.981893 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 03:06:00.983401 (MainThread): 
2021-12-17 03:06:00.983850 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:06:00.984889 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 03:06:00.995951 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 03:06:00.996126 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 03:06:00.996232 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 03:06:01.823229 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.83 seconds
2021-12-17 03:06:01.826551 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 03:06:01.994568 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 03:06:02.008312 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 03:06:02.008641 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 03:06:02.008860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 03:06:02.856213 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.85 seconds
2021-12-17 03:06:02.860238 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 03:06:03.034532 (MainThread): 11:06:03 | Concurrency: 1 threads (target='dev')
2021-12-17 03:06:03.035072 (MainThread): 11:06:03 | 
2021-12-17 03:06:03.037280 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 03:06:03.037843 (Thread-1): 11:06:03 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 03:06:03.038419 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:03.038706 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 03:06:03.048303 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:06:03.049088 (Thread-1): finished collecting timing info
2021-12-17 03:06:03.095973 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:03.096189 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 03:06:03.096320 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:07.225851 (Thread-1): SQL status: SUCCESS 1 in 4.13 seconds
2021-12-17 03:06:07.243730 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:07.244034 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 03:06:07.353909 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 03:06:07.364124 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:07.364437 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 03:06:07.469519 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 03:06:07.487181 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:07.487591 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 03:06:07.587349 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 03:06:07.622658 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:06:07.625224 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:07.625375 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 03:06:07.755316 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-12-17 03:06:07.756400 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:07.756884 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 03:06:08.137472 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-12-17 03:06:08.138245 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:06:08.138711 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 03:06:08.391829 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-12-17 03:06:08.411341 (Thread-1): finished collecting timing info
2021-12-17 03:06:08.411666 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 03:06:08.588288 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd741340>]}
2021-12-17 03:06:08.589207 (Thread-1): 11:06:08 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 5.55s]
2021-12-17 03:06:08.589644 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 03:06:08.590069 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:06:08.590609 (Thread-1): 11:06:08 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 03:06:08.591584 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:06:08.591983 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:06:08.597675 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:06:08.598449 (Thread-1): finished collecting timing info
2021-12-17 03:06:08.611001 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:06:08.612289 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:06:08.612475 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 03:06:08.612635 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:10.093174 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-12-17 03:06:10.096579 (Thread-1): finished collecting timing info
2021-12-17 03:06:10.097051 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 03:06:10.266531 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd66fa60>]}
2021-12-17 03:06:10.267455 (Thread-1): 11:06:10 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.68s]
2021-12-17 03:06:10.267902 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:06:10.268320 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:06:10.268873 (Thread-1): 11:06:10 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 03:06:10.270069 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:06:10.270456 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 03:06:10.275189 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:06:10.276067 (Thread-1): finished collecting timing info
2021-12-17 03:06:10.296106 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:06:10.297055 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:06:10.297243 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 03:06:10.297386 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:10.979234 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 03:06:10.981674 (Thread-1): finished collecting timing info
2021-12-17 03:06:10.982066 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 03:06:11.153233 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cda28520>]}
2021-12-17 03:06:11.154149 (Thread-1): 11:06:11 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.88s]
2021-12-17 03:06:11.154583 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:06:11.155023 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:06:11.155539 (Thread-1): 11:06:11 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 03:06:11.156516 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:06:11.156897 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 03:06:11.161607 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:06:11.162453 (Thread-1): finished collecting timing info
2021-12-17 03:06:11.165730 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:06:11.166802 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:06:11.167025 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 03:06:11.167224 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:11.898375 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-12-17 03:06:11.901757 (Thread-1): finished collecting timing info
2021-12-17 03:06:11.902221 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 03:06:12.070301 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cda28eb0>]}
2021-12-17 03:06:12.071235 (Thread-1): 11:06:12 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.91s]
2021-12-17 03:06:12.071672 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:06:12.072096 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:06:12.072618 (Thread-1): 11:06:12 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 03:06:12.073779 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:06:12.074166 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:06:12.079120 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:06:12.080043 (Thread-1): finished collecting timing info
2021-12-17 03:06:12.083356 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:06:12.084851 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:06:12.085078 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 03:06:12.085284 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:13.984852 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2021-12-17 03:06:13.988340 (Thread-1): finished collecting timing info
2021-12-17 03:06:13.988814 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 03:06:14.159120 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd793430>]}
2021-12-17 03:06:14.160040 (Thread-1): 11:06:14 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.09s]
2021-12-17 03:06:14.160471 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:06:14.160876 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:06:14.161399 (Thread-1): 11:06:14 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 03:06:14.162060 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:06:14.162427 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:06:14.167382 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:06:14.168260 (Thread-1): finished collecting timing info
2021-12-17 03:06:14.172863 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:06:14.174071 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:06:14.174301 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 03:06:14.174531 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:15.520287 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-12-17 03:06:15.523567 (Thread-1): finished collecting timing info
2021-12-17 03:06:15.524055 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 03:06:15.689520 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd60d100>]}
2021-12-17 03:06:15.690458 (Thread-1): 11:06:15 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.53s]
2021-12-17 03:06:15.690894 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:06:15.691333 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:06:15.691866 (Thread-1): 11:06:15 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 03:06:15.692807 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:06:15.693237 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:06:15.698931 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:06:15.699723 (Thread-1): finished collecting timing info
2021-12-17 03:06:15.702987 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:06:15.704841 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:06:15.705069 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 03:06:15.705293 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:16.636007 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-12-17 03:06:16.639435 (Thread-1): finished collecting timing info
2021-12-17 03:06:16.639912 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 03:06:16.816271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd60d100>]}
2021-12-17 03:06:16.817210 (Thread-1): 11:06:16 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.12s]
2021-12-17 03:06:16.817644 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:06:16.818669 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:06:16.819551 (Thread-1): 11:06:16 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 03:06:16.820486 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:06:16.820821 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 03:06:16.829160 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 03:06:16.829940 (Thread-1): finished collecting timing info
2021-12-17 03:06:16.833593 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 03:06:16.835130 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:06:16.835334 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */


      create or replace  table analytics.dbt.target_table  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun


      );
2021-12-17 03:06:16.835518 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:06:18.561830 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-12-17 03:06:18.564250 (Thread-1): finished collecting timing info
2021-12-17 03:06:18.564590 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 03:06:18.729855 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3931843d-757e-4797-8b9e-4d24f20f0ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd7771f0>]}
2021-12-17 03:06:18.730792 (Thread-1): 11:06:18 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 1.91s]
2021-12-17 03:06:18.731232 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:06:18.733441 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:06:18.734150 (MainThread): 11:06:18 | 
2021-12-17 03:06:18.734461 (MainThread): 11:06:18 | Finished running 2 incremental models, 3 table models, 3 view models in 17.75s.
2021-12-17 03:06:18.734727 (MainThread): Connection 'master' was properly closed.
2021-12-17 03:06:18.735049 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 03:06:18.747460 (MainThread): 
2021-12-17 03:06:18.747745 (MainThread): Completed successfully
2021-12-17 03:06:18.747985 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-17 03:06:18.748268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd02bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd199070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85caccdd30>]}
2021-12-17 03:06:18.748585 (MainThread): Flushing usage events
2021-12-17 03:14:15.449694 (MainThread): Running with dbt=0.21.0
2021-12-17 03:14:16.340600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 03:14:16.342125 (MainThread): Tracking: tracking
2021-12-17 03:14:16.342737 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9bcebbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9dfbfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9dfbfb80>]}
2021-12-17 03:14:16.361560 (MainThread): Partial parsing not enabled
2021-12-17 03:14:16.382132 (MainThread): Parsing macros/catalog.sql
2021-12-17 03:14:16.384577 (MainThread): Parsing macros/adapters.sql
2021-12-17 03:14:16.419771 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 03:14:16.423421 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 03:14:16.427566 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 03:14:16.428781 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 03:14:16.432046 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 03:14:16.440831 (MainThread): Parsing macros/core.sql
2021-12-17 03:14:16.445040 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 03:14:16.451562 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 03:14:16.461350 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 03:14:16.463058 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 03:14:16.480152 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 03:14:16.511889 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 03:14:16.533898 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 03:14:16.535460 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 03:14:16.544960 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 03:14:16.563081 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 03:14:16.578929 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 03:14:16.586551 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 03:14:16.593897 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 03:14:16.597515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 03:14:16.598930 (MainThread): Parsing macros/etc/query.sql
2021-12-17 03:14:16.600042 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 03:14:16.601626 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 03:14:16.609944 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 03:14:16.611578 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 03:14:16.613775 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 03:14:16.615186 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 03:14:16.668180 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 03:14:16.669819 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 03:14:16.670903 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 03:14:16.672108 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 03:14:16.674147 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 03:14:16.675100 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 03:14:16.676384 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 03:14:16.677249 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 03:14:16.682344 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 03:14:16.683735 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 03:14:16.685013 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 03:14:16.687636 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 03:14:16.688576 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 03:14:16.690722 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 03:14:16.700688 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 03:14:16.702265 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 03:14:16.703395 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 03:14:16.704502 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 03:14:16.706291 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 03:14:16.707730 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 03:14:16.708451 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 03:14:16.711262 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 03:14:16.715927 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 03:14:16.719202 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 03:14:16.720691 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 03:14:16.721838 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 03:14:16.723375 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 03:14:16.746055 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 03:14:16.747936 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 03:14:16.750520 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 03:14:16.752030 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 03:14:16.753027 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 03:14:16.754085 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 03:14:16.755081 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 03:14:16.756141 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 03:14:16.757667 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 03:14:16.759132 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 03:14:16.761097 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 03:14:16.762816 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 03:14:16.763918 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 03:14:16.766136 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 03:14:16.768307 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 03:14:16.769663 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 03:14:16.770795 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 03:14:16.773215 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 03:14:16.774800 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 03:14:16.776218 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 03:14:16.777952 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 03:14:16.780582 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 03:14:16.781699 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 03:14:16.784940 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 03:14:16.792389 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 03:14:16.796108 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 03:14:16.797387 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 03:14:16.800465 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 03:14:16.803945 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 03:14:16.806834 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 03:14:16.808148 (MainThread): Parsing macros/sql/star.sql
2021-12-17 03:14:16.811000 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 03:14:16.818789 (MainThread): Parsing macros/sql/union.sql
2021-12-17 03:14:16.825722 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 03:14:16.826801 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 03:14:16.829558 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 03:14:16.830850 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 03:14:16.832351 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 03:14:16.837827 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 03:14:16.842159 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 03:14:16.845859 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 03:14:16.847729 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 03:14:17.216714 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:14:17.229907 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:14:17.234431 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:14:17.238128 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:17.245447 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:14:17.248838 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:14:17.266911 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:14:17.271765 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:14:17.332681 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e28a6a0>]}
2021-12-17 03:14:17.340532 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9df6c8e0>]}
2021-12-17 03:14:17.340945 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 03:14:17.342202 (MainThread): 
2021-12-17 03:14:17.342625 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:14:17.343644 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 03:14:17.354815 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 03:14:17.354983 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 03:14:17.355094 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 03:14:18.191657 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.84 seconds
2021-12-17 03:14:18.195009 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 03:14:18.372473 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 03:14:18.384360 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 03:14:18.384654 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 03:14:18.384850 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 03:14:19.183131 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.80 seconds
2021-12-17 03:14:19.187974 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 03:14:19.352710 (MainThread): 11:14:19 | Concurrency: 1 threads (target='dev')
2021-12-17 03:14:19.353235 (MainThread): 11:14:19 | 
2021-12-17 03:14:19.356249 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 03:14:19.356889 (Thread-1): 11:14:19 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 03:14:19.357497 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:19.357781 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 03:14:19.367630 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:14:19.368351 (Thread-1): finished collecting timing info
2021-12-17 03:14:19.416247 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:19.416497 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 03:14:19.416647 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:21.078747 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-17 03:14:21.096693 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:21.097044 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 03:14:21.211575 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 03:14:21.221678 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:21.222031 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 03:14:21.331016 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 03:14:21.347612 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:21.347906 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 03:14:21.451083 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 03:14:21.487253 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 03:14:21.489897 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:21.490087 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 03:14:21.614426 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 03:14:21.615042 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:21.615244 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 03:14:22.818594 (Thread-1): SQL status: SUCCESS 0 in 1.20 seconds
2021-12-17 03:14:22.819123 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 03:14:22.819436 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 03:14:23.154257 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-12-17 03:14:23.173764 (Thread-1): finished collecting timing info
2021-12-17 03:14:23.174110 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 03:14:23.350423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e6218b0>]}
2021-12-17 03:14:23.351326 (Thread-1): 11:14:23 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.99s]
2021-12-17 03:14:23.351768 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 03:14:23.352178 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:14:23.352693 (Thread-1): 11:14:23 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 03:14:23.353695 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:14:23.354013 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:14:23.359729 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:14:23.360541 (Thread-1): finished collecting timing info
2021-12-17 03:14:23.373207 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 03:14:23.374505 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 03:14:23.374691 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 03:14:23.374848 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:24.556828 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-12-17 03:14:24.560456 (Thread-1): finished collecting timing info
2021-12-17 03:14:24.560947 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 03:14:24.724658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e573a00>]}
2021-12-17 03:14:24.725602 (Thread-1): 11:14:24 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.37s]
2021-12-17 03:14:24.726042 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 03:14:24.726458 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:14:24.727002 (Thread-1): 11:14:24 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 03:14:24.727759 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:14:24.728118 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 03:14:24.732996 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:14:24.734141 (Thread-1): finished collecting timing info
2021-12-17 03:14:24.754307 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 03:14:24.755186 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 03:14:24.755357 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 03:14:24.755493 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:25.510000 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-12-17 03:14:25.513114 (Thread-1): finished collecting timing info
2021-12-17 03:14:25.513584 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 03:14:25.685723 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e925100>]}
2021-12-17 03:14:25.686616 (Thread-1): 11:14:25 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.96s]
2021-12-17 03:14:25.687036 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 03:14:25.687443 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:14:25.688212 (Thread-1): 11:14:25 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 03:14:25.689017 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:14:25.689377 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 03:14:25.694264 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:14:25.695183 (Thread-1): finished collecting timing info
2021-12-17 03:14:25.698621 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 03:14:25.699683 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 03:14:25.699915 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 03:14:25.700121 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:26.384566 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 03:14:26.387781 (Thread-1): finished collecting timing info
2021-12-17 03:14:26.388247 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 03:14:26.558580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e570a90>]}
2021-12-17 03:14:26.559555 (Thread-1): 11:14:26 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.87s]
2021-12-17 03:14:26.560141 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 03:14:26.560586 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:14:26.561714 (Thread-1): 11:14:26 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 03:14:26.562512 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:14:26.562797 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:14:26.567579 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:14:26.568430 (Thread-1): finished collecting timing info
2021-12-17 03:14:26.571732 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 03:14:26.573266 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 03:14:26.573485 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 03:14:26.573689 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:29.007242 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-12-17 03:14:29.010367 (Thread-1): finished collecting timing info
2021-12-17 03:14:29.010876 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 03:14:29.283053 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e570430>]}
2021-12-17 03:14:29.283995 (Thread-1): 11:14:29 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.72s]
2021-12-17 03:14:29.284431 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 03:14:29.284838 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:14:29.285359 (Thread-1): 11:14:29 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 03:14:29.286206 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:14:29.286534 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:14:29.291318 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:14:29.292175 (Thread-1): finished collecting timing info
2021-12-17 03:14:29.296959 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 03:14:29.298223 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 03:14:29.298422 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 03:14:29.298599 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:31.073572 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2021-12-17 03:14:31.077330 (Thread-1): finished collecting timing info
2021-12-17 03:14:31.077804 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 03:14:31.437543 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e509310>]}
2021-12-17 03:14:31.438467 (Thread-1): 11:14:31 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.15s]
2021-12-17 03:14:31.438893 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 03:14:31.439296 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:14:31.439808 (Thread-1): 11:14:31 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 03:14:31.440718 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:14:31.441106 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:14:31.446833 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:14:31.447658 (Thread-1): finished collecting timing info
2021-12-17 03:14:31.451156 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 03:14:31.453088 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 03:14:31.453284 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 03:14:31.453462 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:32.677026 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-12-17 03:14:32.680498 (Thread-1): finished collecting timing info
2021-12-17 03:14:32.680954 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 03:14:32.851577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e509820>]}
2021-12-17 03:14:32.852520 (Thread-1): 11:14:32 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.41s]
2021-12-17 03:14:32.852952 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 03:14:32.853856 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:14:32.854693 (Thread-1): 11:14:32 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 03:14:32.855406 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:14:32.855696 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 03:14:32.864341 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 03:14:32.865113 (Thread-1): finished collecting timing info
2021-12-17 03:14:32.870453 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 03:14:32.870722 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(nvl(r_loaddate,cast(('1900-01-01 00:00:00') as timestamp),
  nvl(o_loaddate, cast(('1900-01-01 00:00:00') as timestamp)))) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-17 03:14:32.870916 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 03:14:33.548782 (Thread-1): Snowflake query id: 01a10002-3200-9b61-0000-00008a25a735
2021-12-17 03:14:33.549259 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 21
invalid identifier 'R_LOADDATE'
2021-12-17 03:14:33.549742 (Thread-1): finished collecting timing info
2021-12-17 03:14:33.550292 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 03:14:33.717710 (Thread-1): Database Error in model target_table (models/example/target_table.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'R_LOADDATE'
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 21 at position 21
invalid identifier 'R_LOADDATE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model target_table (models/example/target_table.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'R_LOADDATE'
2021-12-17 03:14:33.719440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cf5b49-b41e-4af0-8584-ffd3b0e80252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e920820>]}
2021-12-17 03:14:33.719995 (Thread-1): 11:14:33 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 0.86s]
2021-12-17 03:14:33.720270 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 03:14:33.721851 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 03:14:33.722447 (MainThread): 11:14:33 | 
2021-12-17 03:14:33.722706 (MainThread): 11:14:33 | Finished running 2 incremental models, 3 table models, 3 view models in 16.38s.
2021-12-17 03:14:33.722927 (MainThread): Connection 'master' was properly closed.
2021-12-17 03:14:33.723104 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 03:14:33.733901 (MainThread): 
2021-12-17 03:14:33.734165 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 03:14:33.734336 (MainThread): 
2021-12-17 03:14:33.734500 (MainThread): Database Error in model target_table (models/example/target_table.sql)
2021-12-17 03:14:33.734651 (MainThread):   000904 (42000): SQL compilation error: error line 21 at position 21
2021-12-17 03:14:33.734791 (MainThread):   invalid identifier 'R_LOADDATE'
2021-12-17 03:14:33.734958 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 03:14:33.735196 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9df6cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e0cb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9e28a610>]}
2021-12-17 03:14:33.735471 (MainThread): Flushing usage events
2021-12-17 04:58:29.491813 (MainThread): Running with dbt=0.21.0
2021-12-17 04:58:30.726027 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 04:58:30.729051 (MainThread): Tracking: tracking
2021-12-17 04:58:30.729994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb9cceb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbbf49a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbbf49b20>]}
2021-12-17 04:58:30.757793 (MainThread): Partial parsing not enabled
2021-12-17 04:58:30.791989 (MainThread): Parsing macros/catalog.sql
2021-12-17 04:58:30.795777 (MainThread): Parsing macros/adapters.sql
2021-12-17 04:58:30.858622 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 04:58:30.864820 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 04:58:30.871730 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 04:58:30.873814 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 04:58:30.878596 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 04:58:30.892100 (MainThread): Parsing macros/core.sql
2021-12-17 04:58:30.897896 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 04:58:30.908571 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 04:58:30.924004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 04:58:30.926906 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 04:58:30.953778 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 04:58:31.011089 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 04:58:31.047847 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 04:58:31.050571 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 04:58:31.066771 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 04:58:31.098687 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 04:58:31.120799 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 04:58:31.133508 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 04:58:31.145330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 04:58:31.151239 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 04:58:31.153667 (MainThread): Parsing macros/etc/query.sql
2021-12-17 04:58:31.155483 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 04:58:31.158158 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 04:58:31.171716 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 04:58:31.174431 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 04:58:31.178118 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 04:58:31.180514 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 04:58:31.269688 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 04:58:31.272235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 04:58:31.274024 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 04:58:31.276399 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 04:58:31.279832 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 04:58:31.281454 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 04:58:31.283605 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 04:58:31.285216 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 04:58:31.293703 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 04:58:31.295678 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 04:58:31.297661 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 04:58:31.301937 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 04:58:31.303577 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 04:58:31.307065 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 04:58:31.323831 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 04:58:31.326741 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 04:58:31.328980 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 04:58:31.331178 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 04:58:31.333716 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 04:58:31.336092 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 04:58:31.337516 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 04:58:31.342937 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 04:58:31.351459 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 04:58:31.356933 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 04:58:31.359780 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 04:58:31.362035 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 04:58:31.364984 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 04:58:31.406015 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 04:58:31.409186 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 04:58:31.413221 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 04:58:31.415684 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 04:58:31.417775 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 04:58:31.419634 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 04:58:31.421329 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 04:58:31.423172 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 04:58:31.425923 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 04:58:31.428428 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 04:58:31.431812 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 04:58:31.434677 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 04:58:31.436551 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 04:58:31.440356 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 04:58:31.443616 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 04:58:31.445823 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 04:58:31.447689 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 04:58:31.451984 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 04:58:31.455315 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 04:58:31.458223 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 04:58:31.461605 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 04:58:31.466026 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 04:58:31.468225 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 04:58:31.473697 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 04:58:31.488798 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 04:58:31.496185 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 04:58:31.498627 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 04:58:31.504283 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 04:58:31.511018 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 04:58:31.516536 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 04:58:31.519134 (MainThread): Parsing macros/sql/star.sql
2021-12-17 04:58:31.524611 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 04:58:31.537173 (MainThread): Parsing macros/sql/union.sql
2021-12-17 04:58:31.550305 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 04:58:31.552436 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 04:58:31.557720 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 04:58:31.560206 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 04:58:31.562665 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 04:58:31.572620 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 04:58:31.580782 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 04:58:31.587153 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 04:58:31.590706 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 04:58:32.065627 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 04:58:32.079948 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 04:58:32.084693 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 04:58:32.089526 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:32.097962 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 04:58:32.102495 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 04:58:32.123130 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 04:58:32.128600 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 04:58:32.200012 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc18a550>]}
2021-12-17 04:58:32.209170 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbbf6bbb0>]}
2021-12-17 04:58:32.209475 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 04:58:32.210765 (MainThread): 
2021-12-17 04:58:32.211135 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 04:58:32.212142 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 04:58:32.225607 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 04:58:32.225792 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 04:58:32.225916 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 04:58:33.182557 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.96 seconds
2021-12-17 04:58:33.185078 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 04:58:33.366565 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 04:58:33.395536 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 04:58:33.395980 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 04:58:33.396306 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 04:58:34.154989 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.76 seconds
2021-12-17 04:58:34.159077 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 04:58:34.337268 (MainThread): 12:58:34 | Concurrency: 1 threads (target='dev')
2021-12-17 04:58:34.338347 (MainThread): 12:58:34 | 
2021-12-17 04:58:34.342794 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 04:58:34.343997 (Thread-1): 12:58:34 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 04:58:34.345128 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:34.345709 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 04:58:34.361708 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 04:58:34.362678 (Thread-1): finished collecting timing info
2021-12-17 04:58:34.431366 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:34.431705 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 04:58:34.431926 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:37.154110 (Thread-1): SQL status: SUCCESS 1 in 2.72 seconds
2021-12-17 04:58:37.171639 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:37.171910 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 04:58:37.296517 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 04:58:37.311076 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:37.311510 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 04:58:37.413646 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 04:58:37.433063 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:37.433335 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 04:58:37.548679 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 04:58:37.597995 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 04:58:37.600314 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:37.600465 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 04:58:37.756972 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-12-17 04:58:37.757882 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:37.758310 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 04:58:38.177078 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-12-17 04:58:38.178174 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 04:58:38.178927 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 04:58:38.372576 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-12-17 04:58:38.401610 (Thread-1): finished collecting timing info
2021-12-17 04:58:38.402031 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 04:58:38.592174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc5227f0>]}
2021-12-17 04:58:38.594093 (Thread-1): 12:58:38 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.25s]
2021-12-17 04:58:38.595088 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 04:58:38.596057 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 04:58:38.597753 (Thread-1): 12:58:38 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 04:58:38.599339 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 04:58:38.600193 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 04:58:38.610913 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 04:58:38.612207 (Thread-1): finished collecting timing info
2021-12-17 04:58:38.632246 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 04:58:38.634082 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 04:58:38.634407 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 04:58:38.634652 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:40.144020 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-12-17 04:58:40.147581 (Thread-1): finished collecting timing info
2021-12-17 04:58:40.148081 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 04:58:40.316867 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc472b20>]}
2021-12-17 04:58:40.317978 (Thread-1): 12:58:40 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.72s]
2021-12-17 04:58:40.318482 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 04:58:40.318910 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 04:58:40.319448 (Thread-1): 12:58:40 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 04:58:40.320402 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 04:58:40.320886 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 04:58:40.325818 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 04:58:40.326986 (Thread-1): finished collecting timing info
2021-12-17 04:58:40.354223 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 04:58:40.355373 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 04:58:40.355592 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 04:58:40.355768 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:41.038437 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 04:58:41.041628 (Thread-1): finished collecting timing info
2021-12-17 04:58:41.042172 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 04:58:41.222480 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc7366d0>]}
2021-12-17 04:58:41.223462 (Thread-1): 12:58:41 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.90s]
2021-12-17 04:58:41.224064 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 04:58:41.224832 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 04:58:41.226318 (Thread-1): 12:58:41 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 04:58:41.227707 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 04:58:41.228299 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 04:58:41.233925 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 04:58:41.234810 (Thread-1): finished collecting timing info
2021-12-17 04:58:41.238297 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 04:58:41.239309 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 04:58:41.239511 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 04:58:41.239686 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:41.919911 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 04:58:41.923328 (Thread-1): finished collecting timing info
2021-12-17 04:58:41.923839 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 04:58:42.129649 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc736a90>]}
2021-12-17 04:58:42.130585 (Thread-1): 12:58:42 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.90s]
2021-12-17 04:58:42.131041 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 04:58:42.131467 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 04:58:42.132580 (Thread-1): 12:58:42 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 04:58:42.133482 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 04:58:42.133898 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 04:58:42.138774 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 04:58:42.139619 (Thread-1): finished collecting timing info
2021-12-17 04:58:42.143013 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 04:58:42.144510 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 04:58:42.144731 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 04:58:42.144933 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:44.138962 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2021-12-17 04:58:44.146092 (Thread-1): finished collecting timing info
2021-12-17 04:58:44.147168 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 04:58:44.335433 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc5b9220>]}
2021-12-17 04:58:44.337495 (Thread-1): 12:58:44 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.20s]
2021-12-17 04:58:44.338446 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 04:58:44.339364 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 04:58:44.340943 (Thread-1): 12:58:44 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 04:58:44.342455 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 04:58:44.343222 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 04:58:44.354434 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 04:58:44.355883 (Thread-1): finished collecting timing info
2021-12-17 04:58:44.364164 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 04:58:44.366097 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 04:58:44.366476 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 04:58:44.366799 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:46.186431 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-12-17 04:58:46.193331 (Thread-1): finished collecting timing info
2021-12-17 04:58:46.194377 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 04:58:46.377836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc408070>]}
2021-12-17 04:58:46.379156 (Thread-1): 12:58:46 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.04s]
2021-12-17 04:58:46.379880 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 04:58:46.380805 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 04:58:46.382433 (Thread-1): 12:58:46 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 04:58:46.384111 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 04:58:46.384918 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 04:58:46.401575 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 04:58:46.403984 (Thread-1): finished collecting timing info
2021-12-17 04:58:46.413362 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 04:58:46.417320 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 04:58:46.417846 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
)
select * from transform
  );
2021-12-17 04:58:46.418294 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:47.415501 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-12-17 04:58:47.422133 (Thread-1): finished collecting timing info
2021-12-17 04:58:47.423233 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 04:58:47.602039 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc408c70>]}
2021-12-17 04:58:47.603932 (Thread-1): 12:58:47 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.22s]
2021-12-17 04:58:47.604888 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 04:58:47.607381 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 04:58:47.609112 (Thread-1): 12:58:47 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 04:58:47.610834 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 04:58:47.611892 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 04:58:47.622238 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 04:58:47.623172 (Thread-1): finished collecting timing info
2021-12-17 04:58:47.629440 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 04:58:47.629761 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(nvl(r_loaddate,cast(('1900-01-01 00:00:00') as timestamp),
  nvl(o_loaddate, cast(('1900-01-01 00:00:00') as timestamp)))) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-17 04:58:47.629953 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 04:58:48.468193 (Thread-1): Snowflake query id: 01a1006a-3200-9b61-0000-00008a25a75d
2021-12-17 04:58:48.468718 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 21
invalid identifier 'R_LOADDATE'
2021-12-17 04:58:48.469266 (Thread-1): finished collecting timing info
2021-12-17 04:58:48.469747 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 04:58:48.644265 (Thread-1): Database Error in model target_table (models/example/target_table.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'R_LOADDATE'
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 21 at position 21
invalid identifier 'R_LOADDATE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model target_table (models/example/target_table.sql)
  000904 (42000): SQL compilation error: error line 21 at position 21
  invalid identifier 'R_LOADDATE'
2021-12-17 04:58:48.648804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eca20f0c-489c-43e1-967b-7fb91d623a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc56d3a0>]}
2021-12-17 04:58:48.650584 (Thread-1): 12:58:48 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 1.04s]
2021-12-17 04:58:48.651503 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 04:58:48.656281 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 04:58:48.658207 (MainThread): 12:58:48 | 
2021-12-17 04:58:48.659122 (MainThread): 12:58:48 | Finished running 2 incremental models, 3 table models, 3 view models in 16.45s.
2021-12-17 04:58:48.659934 (MainThread): Connection 'master' was properly closed.
2021-12-17 04:58:48.660596 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 04:58:48.697152 (MainThread): 
2021-12-17 04:58:48.697687 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 04:58:48.698087 (MainThread): 
2021-12-17 04:58:48.698466 (MainThread): Database Error in model target_table (models/example/target_table.sql)
2021-12-17 04:58:48.698826 (MainThread):   000904 (42000): SQL compilation error: error line 21 at position 21
2021-12-17 04:58:48.699125 (MainThread):   invalid identifier 'R_LOADDATE'
2021-12-17 04:58:48.699472 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 04:58:48.699934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc190d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc0e0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb9cceb20>]}
2021-12-17 04:58:48.700478 (MainThread): Flushing usage events
2021-12-17 05:01:45.847704 (MainThread): Running with dbt=0.21.0
2021-12-17 05:01:47.200066 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 05:01:47.201789 (MainThread): Tracking: tracking
2021-12-17 05:01:47.202402 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525cebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528809b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528809bb0>]}
2021-12-17 05:01:47.222511 (MainThread): Partial parsing not enabled
2021-12-17 05:01:47.246186 (MainThread): Parsing macros/catalog.sql
2021-12-17 05:01:47.248619 (MainThread): Parsing macros/adapters.sql
2021-12-17 05:01:47.285099 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 05:01:47.288862 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 05:01:47.293619 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 05:01:47.294953 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 05:01:47.298033 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 05:01:47.307439 (MainThread): Parsing macros/core.sql
2021-12-17 05:01:47.311116 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 05:01:47.318702 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 05:01:47.328650 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 05:01:47.330504 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 05:01:47.347572 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 05:01:47.380186 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 05:01:47.402776 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 05:01:47.404483 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 05:01:47.414933 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 05:01:47.435249 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 05:01:47.449684 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 05:01:47.457785 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 05:01:47.466302 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 05:01:47.470584 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 05:01:47.472129 (MainThread): Parsing macros/etc/query.sql
2021-12-17 05:01:47.473041 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 05:01:47.474417 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 05:01:47.483490 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 05:01:47.485662 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 05:01:47.488205 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 05:01:47.489743 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 05:01:47.548173 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 05:01:47.549801 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 05:01:47.551104 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 05:01:47.552411 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 05:01:47.554503 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 05:01:47.555474 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 05:01:47.557163 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 05:01:47.558111 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 05:01:47.563767 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 05:01:47.565025 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 05:01:47.566342 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 05:01:47.569043 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 05:01:47.569998 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 05:01:47.572403 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 05:01:47.582292 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 05:01:47.584117 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 05:01:47.585487 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 05:01:47.586957 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 05:01:47.588473 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 05:01:47.589913 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 05:01:47.590837 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 05:01:47.594392 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 05:01:47.599443 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 05:01:47.603087 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 05:01:47.604882 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 05:01:47.606266 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 05:01:47.608346 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 05:01:47.633505 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 05:01:47.635653 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 05:01:47.638203 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 05:01:47.639692 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 05:01:47.640701 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 05:01:47.641777 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 05:01:47.642933 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 05:01:47.644159 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 05:01:47.645749 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 05:01:47.647283 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 05:01:47.649616 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 05:01:47.651565 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 05:01:47.652797 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 05:01:47.655575 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 05:01:47.657721 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 05:01:47.659381 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 05:01:47.660625 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 05:01:47.663406 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 05:01:47.665361 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 05:01:47.667181 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 05:01:47.669734 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 05:01:47.672592 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 05:01:47.674100 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 05:01:47.677501 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 05:01:47.686596 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 05:01:47.692012 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 05:01:47.693813 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 05:01:47.697052 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 05:01:47.701521 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 05:01:47.705145 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 05:01:47.706739 (MainThread): Parsing macros/sql/star.sql
2021-12-17 05:01:47.710424 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 05:01:47.718180 (MainThread): Parsing macros/sql/union.sql
2021-12-17 05:01:47.726635 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 05:01:47.727990 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 05:01:47.731360 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 05:01:47.732911 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 05:01:47.734423 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 05:01:47.740842 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 05:01:47.746153 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 05:01:47.750172 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 05:01:47.752551 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 05:01:48.144997 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:01:48.158589 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:01:48.163300 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:01:48.167330 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:48.175921 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:01:48.179700 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:01:48.198933 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:01:48.204128 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:01:48.271226 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95289e7bb0>]}
2021-12-17 05:01:48.280396 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95289be1c0>]}
2021-12-17 05:01:48.280741 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 05:01:48.282459 (MainThread): 
2021-12-17 05:01:48.282978 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:01:48.284344 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 05:01:48.299670 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 05:01:48.299934 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 05:01:48.300146 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 05:01:49.183455 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.88 seconds
2021-12-17 05:01:49.188812 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 05:01:49.363764 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 05:01:49.376935 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 05:01:49.377254 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 05:01:49.377509 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 05:01:50.114516 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.74 seconds
2021-12-17 05:01:50.118551 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 05:01:50.300718 (MainThread): 13:01:50 | Concurrency: 1 threads (target='dev')
2021-12-17 05:01:50.301230 (MainThread): 13:01:50 | 
2021-12-17 05:01:50.303574 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 05:01:50.304159 (Thread-1): 13:01:50 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 05:01:50.304889 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:50.305235 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 05:01:50.315233 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:01:50.315973 (Thread-1): finished collecting timing info
2021-12-17 05:01:50.362421 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:50.362659 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 05:01:50.362835 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:01:52.030065 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-12-17 05:01:52.048715 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:52.049095 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 05:01:52.306519 (Thread-1): SQL status: SUCCESS 28 in 0.26 seconds
2021-12-17 05:01:52.316862 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:52.317209 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 05:01:52.531379 (Thread-1): SQL status: SUCCESS 28 in 0.21 seconds
2021-12-17 05:01:52.550421 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:52.550886 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 05:01:52.715432 (Thread-1): SQL status: SUCCESS 28 in 0.16 seconds
2021-12-17 05:01:52.751389 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:01:52.753863 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:52.754076 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 05:01:52.891688 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-12-17 05:01:52.892744 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:52.893073 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 05:01:53.580594 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-12-17 05:01:53.581374 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:01:53.581855 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 05:01:53.764617 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-17 05:01:53.783916 (Thread-1): finished collecting timing info
2021-12-17 05:01:53.784240 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 05:01:54.099862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528de1880>]}
2021-12-17 05:01:54.100799 (Thread-1): 13:01:54 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.80s]
2021-12-17 05:01:54.101248 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 05:01:54.101618 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:01:54.102039 (Thread-1): 13:01:54 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 05:01:54.102812 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:01:54.103140 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:01:54.108671 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:01:54.109534 (Thread-1): finished collecting timing info
2021-12-17 05:01:54.122062 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:01:54.123324 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:01:54.123513 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 05:01:54.123673 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:01:55.664364 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-12-17 05:01:55.667402 (Thread-1): finished collecting timing info
2021-12-17 05:01:55.667889 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 05:01:55.831570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528e34c10>]}
2021-12-17 05:01:55.832508 (Thread-1): 13:01:55 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.73s]
2021-12-17 05:01:55.832955 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:01:55.833378 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:01:55.833917 (Thread-1): 13:01:55 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 05:01:55.834668 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:01:55.834964 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 05:01:55.840180 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:01:55.841186 (Thread-1): finished collecting timing info
2021-12-17 05:01:55.861427 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:01:55.862349 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:01:55.862520 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 05:01:55.862684 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:01:56.533673 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-17 05:01:56.536874 (Thread-1): finished collecting timing info
2021-12-17 05:01:56.537356 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 05:01:56.698488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528ea4b80>]}
2021-12-17 05:01:56.699394 (Thread-1): 13:01:56 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.86s]
2021-12-17 05:01:56.699822 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:01:56.700222 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:01:56.700732 (Thread-1): 13:01:56 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 05:01:56.701711 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:01:56.702128 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 05:01:56.707565 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:01:56.708433 (Thread-1): finished collecting timing info
2021-12-17 05:01:56.712188 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:01:56.713276 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:01:56.713505 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 05:01:56.713706 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:01:57.417459 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-12-17 05:01:57.421704 (Thread-1): finished collecting timing info
2021-12-17 05:01:57.422223 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 05:01:57.609655 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528ea4400>]}
2021-12-17 05:01:57.610427 (Thread-1): 13:01:57 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.91s]
2021-12-17 05:01:57.610899 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:01:57.611272 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:01:57.611728 (Thread-1): 13:01:57 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 05:01:57.612560 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:01:57.613150 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:01:57.617653 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:01:57.618376 (Thread-1): finished collecting timing info
2021-12-17 05:01:57.621641 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:01:57.622964 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:01:57.623167 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 05:01:57.623341 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:01:59.437046 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-12-17 05:01:59.441137 (Thread-1): finished collecting timing info
2021-12-17 05:01:59.441667 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 05:01:59.643257 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528dd1130>]}
2021-12-17 05:01:59.644186 (Thread-1): 13:01:59 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.03s]
2021-12-17 05:01:59.644588 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:01:59.645110 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:01:59.645600 (Thread-1): 13:01:59 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 05:01:59.646357 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:01:59.646685 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:01:59.651450 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:01:59.652211 (Thread-1): finished collecting timing info
2021-12-17 05:01:59.656975 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:01:59.658039 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:01:59.658239 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 05:01:59.658411 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:01.155828 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-17 05:02:01.159089 (Thread-1): finished collecting timing info
2021-12-17 05:02:01.159576 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 05:02:01.348267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528ea5a90>]}
2021-12-17 05:02:01.349624 (Thread-1): 13:02:01 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.70s]
2021-12-17 05:02:01.350293 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:02:01.350948 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:01.351741 (Thread-1): 13:02:01 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 05:02:01.352772 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:02:01.353308 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:01.362307 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:02:01.363358 (Thread-1): finished collecting timing info
2021-12-17 05:02:01.367627 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:02:01.369890 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:02:01.370126 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate,
)
select * from transform
  );
2021-12-17 05:02:01.370333 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:01.961788 (Thread-1): Snowflake query id: 01a1006e-3200-9b5f-0000-00008a259721
2021-12-17 05:02:01.962173 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected ')'.
2021-12-17 05:02:01.962539 (Thread-1): finished collecting timing info
2021-12-17 05:02:01.962868 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 05:02:02.131946 (Thread-1): Database Error in model raw_join_transform (models/example/raw_join_transform.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected ')'.
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/raw_join_transform.sql
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model raw_join_transform (models/example/raw_join_transform.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected ')'.
  compiled SQL at target/run/jrtests_learn_dbt1/models/example/raw_join_transform.sql
2021-12-17 05:02:02.134177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb0c9ea-15f8-42d9-b322-d5037bb21084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9528ea5c70>]}
2021-12-17 05:02:02.134882 (Thread-1): 13:02:02 | 7 of 8 ERROR creating view model dbt.raw_join_transform.............. [ERROR in 0.78s]
2021-12-17 05:02:02.135222 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:02.136049 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:02:02.136393 (Thread-1): 13:02:02 | 8 of 8 SKIP relation dbt.target_table................................ [SKIP]
2021-12-17 05:02:02.136940 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:02:02.138923 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:02:02.139642 (MainThread): 13:02:02 | 
2021-12-17 05:02:02.139972 (MainThread): 13:02:02 | Finished running 2 incremental models, 3 table models, 3 view models in 13.86s.
2021-12-17 05:02:02.140229 (MainThread): Connection 'master' was properly closed.
2021-12-17 05:02:02.140420 (MainThread): Connection 'model.jrtests_learn_dbt1.raw_join_transform' was properly closed.
2021-12-17 05:02:02.151914 (MainThread): 
2021-12-17 05:02:02.152179 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 05:02:02.152365 (MainThread): 
2021-12-17 05:02:02.152540 (MainThread): Database Error in model raw_join_transform (models/example/raw_join_transform.sql)
2021-12-17 05:02:02.152700 (MainThread):   001003 (42000): SQL compilation error:
2021-12-17 05:02:02.152847 (MainThread):   syntax error line 15 at position 0 unexpected ')'.
2021-12-17 05:02:02.152993 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt1/models/example/raw_join_transform.sql
2021-12-17 05:02:02.153166 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
2021-12-17 05:02:02.153414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952882e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952899ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525cebf70>]}
2021-12-17 05:02:02.153710 (MainThread): Flushing usage events
2021-12-17 05:02:40.703005 (MainThread): Running with dbt=0.21.0
2021-12-17 05:02:41.771491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 05:02:41.773725 (MainThread): Tracking: tracking
2021-12-17 05:02:41.774331 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834b5ebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834d809a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834d809b20>]}
2021-12-17 05:02:41.797603 (MainThread): Partial parsing not enabled
2021-12-17 05:02:41.821926 (MainThread): Parsing macros/catalog.sql
2021-12-17 05:02:41.824420 (MainThread): Parsing macros/adapters.sql
2021-12-17 05:02:41.861406 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 05:02:41.865303 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 05:02:41.871677 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 05:02:41.874539 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 05:02:41.878046 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 05:02:41.891078 (MainThread): Parsing macros/core.sql
2021-12-17 05:02:41.897699 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 05:02:41.909415 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 05:02:41.925034 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 05:02:41.928003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 05:02:41.948340 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 05:02:41.988592 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 05:02:42.011962 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 05:02:42.013881 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 05:02:42.025960 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 05:02:42.047181 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 05:02:42.061086 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 05:02:42.068871 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 05:02:42.076110 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 05:02:42.079975 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 05:02:42.081524 (MainThread): Parsing macros/etc/query.sql
2021-12-17 05:02:42.082435 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 05:02:42.083805 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 05:02:42.093052 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 05:02:42.094775 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 05:02:42.097238 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 05:02:42.098753 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 05:02:42.170129 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 05:02:42.172075 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 05:02:42.173244 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 05:02:42.174394 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 05:02:42.176285 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 05:02:42.177291 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 05:02:42.178831 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 05:02:42.179798 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 05:02:42.184580 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 05:02:42.185766 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 05:02:42.187033 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 05:02:42.190810 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 05:02:42.192420 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 05:02:42.195874 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 05:02:42.206978 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 05:02:42.209058 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 05:02:42.210395 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 05:02:42.211711 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 05:02:42.213402 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 05:02:42.214846 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 05:02:42.215921 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 05:02:42.219458 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 05:02:42.224486 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 05:02:42.228218 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 05:02:42.230199 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 05:02:42.231676 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 05:02:42.233644 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 05:02:42.259088 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 05:02:42.261199 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 05:02:42.263631 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 05:02:42.265642 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 05:02:42.266711 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 05:02:42.267809 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 05:02:42.268838 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 05:02:42.269905 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 05:02:42.271433 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 05:02:42.273096 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 05:02:42.275959 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 05:02:42.278892 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 05:02:42.280709 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 05:02:42.284734 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 05:02:42.288087 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 05:02:42.290272 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 05:02:42.292079 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 05:02:42.295335 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 05:02:42.297855 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 05:02:42.299572 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 05:02:42.301594 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 05:02:42.305226 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 05:02:42.306874 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 05:02:42.310439 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 05:02:42.319137 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 05:02:42.324032 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 05:02:42.325858 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 05:02:42.328902 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 05:02:42.333902 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 05:02:42.339598 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 05:02:42.342177 (MainThread): Parsing macros/sql/star.sql
2021-12-17 05:02:42.345830 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 05:02:42.354369 (MainThread): Parsing macros/sql/union.sql
2021-12-17 05:02:42.363038 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 05:02:42.364531 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 05:02:42.367838 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 05:02:42.369550 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 05:02:42.371280 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 05:02:42.377951 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 05:02:42.383097 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 05:02:42.387495 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 05:02:42.389780 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 05:02:42.810382 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:02:42.825287 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:02:42.830445 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:02:42.835217 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:42.843709 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:02:42.847990 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:02:42.867434 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:02:42.873354 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:02:42.944831 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834d9ea7f0>]}
2021-12-17 05:02:42.953500 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834da4dee0>]}
2021-12-17 05:02:42.953873 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 05:02:42.955135 (MainThread): 
2021-12-17 05:02:42.955504 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:02:42.956547 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 05:02:42.969477 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 05:02:42.969663 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 05:02:42.969781 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 05:02:43.923917 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.95 seconds
2021-12-17 05:02:43.926646 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 05:02:44.105744 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 05:02:44.118552 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 05:02:44.118894 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 05:02:44.119084 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 05:02:44.719859 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.60 seconds
2021-12-17 05:02:44.724105 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 05:02:44.894168 (MainThread): 13:02:44 | Concurrency: 1 threads (target='dev')
2021-12-17 05:02:44.898803 (MainThread): 13:02:44 | 
2021-12-17 05:02:44.903163 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 05:02:44.903798 (Thread-1): 13:02:44 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 05:02:44.904481 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:44.906868 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 05:02:44.916860 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:02:44.918249 (Thread-1): finished collecting timing info
2021-12-17 05:02:44.966552 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:44.966777 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 05:02:44.966918 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:46.128668 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-12-17 05:02:46.146394 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:46.146689 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 05:02:46.262342 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 05:02:46.272598 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:46.272946 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 05:02:46.371967 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 05:02:46.387796 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:46.388101 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 05:02:46.501763 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 05:02:46.538140 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:02:46.540720 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:46.540877 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 05:02:46.661241 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 05:02:46.662380 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:46.662804 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 05:02:47.134413 (Thread-1): SQL status: SUCCESS 0 in 0.47 seconds
2021-12-17 05:02:47.135090 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:02:47.135413 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 05:02:47.323181 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-12-17 05:02:47.341704 (Thread-1): finished collecting timing info
2021-12-17 05:02:47.342024 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 05:02:47.513751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834dde27f0>]}
2021-12-17 05:02:47.514665 (Thread-1): 13:02:47 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.61s]
2021-12-17 05:02:47.515103 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 05:02:47.515554 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:02:47.516079 (Thread-1): 13:02:47 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 05:02:47.516992 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:02:47.517316 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:02:47.523158 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:02:47.523979 (Thread-1): finished collecting timing info
2021-12-17 05:02:47.536586 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:02:47.537852 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:02:47.538043 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 05:02:47.538204 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:48.767981 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-12-17 05:02:48.771556 (Thread-1): finished collecting timing info
2021-12-17 05:02:48.772028 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 05:02:48.942326 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834dd32b20>]}
2021-12-17 05:02:48.943279 (Thread-1): 13:02:48 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.43s]
2021-12-17 05:02:48.943733 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:02:48.944169 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:02:48.944709 (Thread-1): 13:02:48 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 05:02:48.945490 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:02:48.946159 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 05:02:48.952507 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:02:48.953438 (Thread-1): finished collecting timing info
2021-12-17 05:02:48.972862 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:02:48.973779 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:02:48.973936 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 05:02:48.974065 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:49.654099 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-17 05:02:49.658531 (Thread-1): finished collecting timing info
2021-12-17 05:02:49.659226 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 05:02:49.830020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834deb96d0>]}
2021-12-17 05:02:49.831413 (Thread-1): 13:02:49 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.88s]
2021-12-17 05:02:49.832059 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:02:49.832773 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:02:49.833985 (Thread-1): 13:02:49 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 05:02:49.835133 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:02:49.835665 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 05:02:49.841864 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:02:49.842939 (Thread-1): finished collecting timing info
2021-12-17 05:02:49.846829 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:02:49.848119 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:02:49.848392 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 05:02:49.848639 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:50.552915 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-12-17 05:02:50.556277 (Thread-1): finished collecting timing info
2021-12-17 05:02:50.556749 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 05:02:50.729044 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834deb9a90>]}
2021-12-17 05:02:50.730513 (Thread-1): 13:02:50 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.89s]
2021-12-17 05:02:50.731215 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:02:50.732111 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:02:50.734246 (Thread-1): 13:02:50 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 05:02:50.735804 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:02:50.736678 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:02:50.743850 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:02:50.745497 (Thread-1): finished collecting timing info
2021-12-17 05:02:50.749849 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:02:50.753709 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:02:50.754273 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 05:02:50.754787 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:52.377039 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-12-17 05:02:52.381143 (Thread-1): finished collecting timing info
2021-12-17 05:02:52.381694 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 05:02:52.628059 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834de58d00>]}
2021-12-17 05:02:52.629032 (Thread-1): 13:02:52 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.89s]
2021-12-17 05:02:52.629535 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:02:52.630095 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:02:52.631056 (Thread-1): 13:02:52 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 05:02:52.631963 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:02:52.632407 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:02:52.638031 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:02:52.638890 (Thread-1): finished collecting timing info
2021-12-17 05:02:52.644282 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:02:52.645952 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:02:52.646258 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 05:02:52.646526 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:54.113120 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-12-17 05:02:54.116574 (Thread-1): finished collecting timing info
2021-12-17 05:02:54.117069 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 05:02:54.416502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834dcc9820>]}
2021-12-17 05:02:54.417460 (Thread-1): 13:02:54 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.78s]
2021-12-17 05:02:54.417918 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:02:54.418351 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:54.418903 (Thread-1): 13:02:54 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 05:02:54.419751 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:02:54.420057 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:54.431080 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:02:54.433390 (Thread-1): finished collecting timing info
2021-12-17 05:02:54.439911 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:02:54.443085 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:02:54.443667 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-17 05:02:54.444147 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:55.714052 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-12-17 05:02:55.718635 (Thread-1): finished collecting timing info
2021-12-17 05:02:55.719384 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 05:02:55.895251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834dcc9fa0>]}
2021-12-17 05:02:55.896168 (Thread-1): 13:02:55 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.48s]
2021-12-17 05:02:55.896603 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:02:55.897864 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:02:55.898542 (Thread-1): 13:02:55 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 05:02:55.899511 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:02:55.900063 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 05:02:55.908656 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 05:02:55.910279 (Thread-1): finished collecting timing info
2021-12-17 05:02:55.916292 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:02:55.916591 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(nvl(r_loaddate,cast(('1900-01-01 00:00:00') as timestamp),
  nvl(o_loaddate, cast(('1900-01-01 00:00:00') as timestamp)))) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-17 05:02:55.916810 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:02:56.741876 (Thread-1): Snowflake query id: 01a1006e-3200-9b61-0000-00008a25a7a1
2021-12-17 05:02:56.742410 (Thread-1): Snowflake error: 000939 (22023): SQL compilation error: error line 21 at position 17
too many arguments for function [NVL(DAILYRUN.R_LOADDATE, CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)), NVL(DAILYRUN.O_LOADDATE, CAST(CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)) AS TIMESTAMP_LTZ(9))))] expected 2, got 3
2021-12-17 05:02:56.742931 (Thread-1): finished collecting timing info
2021-12-17 05:02:56.743648 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 05:02:56.922929 (Thread-1): Database Error in model target_table (models/example/target_table.sql)
  000939 (22023): SQL compilation error: error line 21 at position 17
  too many arguments for function [NVL(DAILYRUN.R_LOADDATE, CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)), NVL(DAILYRUN.O_LOADDATE, CAST(CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)) AS TIMESTAMP_LTZ(9))))] expected 2, got 3
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000939 (22023): SQL compilation error: error line 21 at position 17
too many arguments for function [NVL(DAILYRUN.R_LOADDATE, CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)), NVL(DAILYRUN.O_LOADDATE, CAST(CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)) AS TIMESTAMP_LTZ(9))))] expected 2, got 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model target_table (models/example/target_table.sql)
  000939 (22023): SQL compilation error: error line 21 at position 17
  too many arguments for function [NVL(DAILYRUN.R_LOADDATE, CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)), NVL(DAILYRUN.O_LOADDATE, CAST(CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)) AS TIMESTAMP_LTZ(9))))] expected 2, got 3
2021-12-17 05:02:56.925113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4274b91a-6b50-409a-9caa-3888866c74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834de2a3a0>]}
2021-12-17 05:02:56.925963 (Thread-1): 13:02:56 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 1.03s]
2021-12-17 05:02:56.926413 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:02:56.928686 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:02:56.929472 (MainThread): 13:02:56 | 
2021-12-17 05:02:56.929802 (MainThread): 13:02:56 | Finished running 2 incremental models, 3 table models, 3 view models in 13.97s.
2021-12-17 05:02:56.930072 (MainThread): Connection 'master' was properly closed.
2021-12-17 05:02:56.930326 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 05:02:56.942990 (MainThread): 
2021-12-17 05:02:56.943287 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 05:02:56.943622 (MainThread): 
2021-12-17 05:02:56.943886 (MainThread): Database Error in model target_table (models/example/target_table.sql)
2021-12-17 05:02:56.944106 (MainThread):   000939 (22023): SQL compilation error: error line 21 at position 17
2021-12-17 05:02:56.944298 (MainThread):   too many arguments for function [NVL(DAILYRUN.R_LOADDATE, CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)), NVL(DAILYRUN.O_LOADDATE, CAST(CAST('1900-01-01 00:00:00' AS TIMESTAMP_NTZ(9)) AS TIMESTAMP_LTZ(9))))] expected 2, got 3
2021-12-17 05:02:56.944538 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 05:02:56.944835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834d82cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834d999070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834b5ebf70>]}
2021-12-17 05:02:56.945120 (MainThread): Flushing usage events
2021-12-17 05:05:34.425298 (MainThread): Running with dbt=0.21.0
2021-12-17 05:05:35.376149 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 05:05:35.377574 (MainThread): Tracking: tracking
2021-12-17 05:05:35.378153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8304cff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832f49a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832f49af0>]}
2021-12-17 05:05:35.397191 (MainThread): Partial parsing not enabled
2021-12-17 05:05:35.419950 (MainThread): Parsing macros/catalog.sql
2021-12-17 05:05:35.422432 (MainThread): Parsing macros/adapters.sql
2021-12-17 05:05:35.457973 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 05:05:35.461569 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 05:05:35.465671 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 05:05:35.466877 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 05:05:35.470194 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 05:05:35.479076 (MainThread): Parsing macros/core.sql
2021-12-17 05:05:35.483213 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 05:05:35.489658 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 05:05:35.498608 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 05:05:35.500129 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 05:05:35.516083 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 05:05:35.546127 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 05:05:35.568283 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 05:05:35.569807 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 05:05:35.578572 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 05:05:35.597326 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 05:05:35.610188 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 05:05:35.617442 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 05:05:35.623953 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 05:05:35.627144 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 05:05:35.628362 (MainThread): Parsing macros/etc/query.sql
2021-12-17 05:05:35.629140 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 05:05:35.630556 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 05:05:35.638150 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 05:05:35.639633 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 05:05:35.641595 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 05:05:35.642898 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 05:05:35.691064 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 05:05:35.692443 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 05:05:35.693358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 05:05:35.694409 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 05:05:35.696146 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 05:05:35.696972 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 05:05:35.698074 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 05:05:35.698844 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 05:05:35.703412 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 05:05:35.704473 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 05:05:35.705518 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 05:05:35.707843 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 05:05:35.709441 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 05:05:35.711386 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 05:05:35.719908 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 05:05:35.721435 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 05:05:35.722649 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 05:05:35.723950 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 05:05:35.725288 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 05:05:35.726568 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 05:05:35.727311 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 05:05:35.730173 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 05:05:35.734554 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 05:05:35.737773 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 05:05:35.739297 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 05:05:35.740620 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 05:05:35.742221 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 05:05:35.764601 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 05:05:35.766305 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 05:05:35.768541 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 05:05:35.769838 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 05:05:35.770726 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 05:05:35.771696 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 05:05:35.772591 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 05:05:35.773544 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 05:05:35.774927 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 05:05:35.776268 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 05:05:35.778567 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 05:05:35.780392 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 05:05:35.781426 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 05:05:35.783484 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 05:05:35.785244 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 05:05:35.786435 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 05:05:35.787460 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 05:05:35.789821 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 05:05:35.791485 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 05:05:35.793027 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 05:05:35.794835 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 05:05:35.797176 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 05:05:35.798846 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 05:05:35.801937 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 05:05:35.809646 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 05:05:35.813540 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 05:05:35.814877 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 05:05:35.817696 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 05:05:35.821325 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 05:05:35.824150 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 05:05:35.825445 (MainThread): Parsing macros/sql/star.sql
2021-12-17 05:05:35.828232 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 05:05:35.835148 (MainThread): Parsing macros/sql/union.sql
2021-12-17 05:05:35.841899 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 05:05:35.842981 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 05:05:35.845860 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 05:05:35.847357 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 05:05:35.848633 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 05:05:35.853722 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 05:05:35.857911 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 05:05:35.861146 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 05:05:35.862954 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 05:05:36.203706 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:05:36.215496 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:05:36.219110 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:05:36.222096 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:36.228445 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:05:36.231420 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:05:36.247286 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:05:36.253533 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:05:36.316653 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83318b520>]}
2021-12-17 05:05:36.324688 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832f6cb80>]}
2021-12-17 05:05:36.324991 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 05:05:36.326238 (MainThread): 
2021-12-17 05:05:36.326657 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:05:36.327702 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 05:05:36.339670 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 05:05:36.339856 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 05:05:36.339977 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 05:05:37.279159 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.94 seconds
2021-12-17 05:05:37.282060 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 05:05:37.470508 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 05:05:37.482440 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 05:05:37.482720 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 05:05:37.482925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 05:05:38.204271 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.72 seconds
2021-12-17 05:05:38.207885 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 05:05:38.373546 (MainThread): 13:05:38 | Concurrency: 1 threads (target='dev')
2021-12-17 05:05:38.374045 (MainThread): 13:05:38 | 
2021-12-17 05:05:38.376145 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 05:05:38.376709 (Thread-1): 13:05:38 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 05:05:38.377302 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:38.377589 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 05:05:38.386853 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:05:38.387550 (Thread-1): finished collecting timing info
2021-12-17 05:05:38.431433 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:38.431660 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 05:05:38.431860 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:39.902157 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-12-17 05:05:39.920049 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:39.920354 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 05:05:40.092662 (Thread-1): SQL status: SUCCESS 28 in 0.17 seconds
2021-12-17 05:05:40.102250 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:40.102562 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 05:05:40.241081 (Thread-1): SQL status: SUCCESS 28 in 0.14 seconds
2021-12-17 05:05:40.257598 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:40.257890 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 05:05:40.355298 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-17 05:05:40.392160 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:05:40.394721 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:40.394879 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 05:05:40.519855 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-17 05:05:40.520621 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:40.520940 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 05:05:41.214079 (Thread-1): SQL status: SUCCESS 0 in 0.69 seconds
2021-12-17 05:05:41.214840 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:05:41.215304 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 05:05:41.390738 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-12-17 05:05:41.410300 (Thread-1): finished collecting timing info
2021-12-17 05:05:41.410624 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 05:05:41.586024 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83379fd60>]}
2021-12-17 05:05:41.586969 (Thread-1): 13:05:41 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.21s]
2021-12-17 05:05:41.587417 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 05:05:41.587856 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:05:41.588383 (Thread-1): 13:05:41 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 05:05:41.589074 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:05:41.589844 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:05:41.597230 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:05:41.598194 (Thread-1): finished collecting timing info
2021-12-17 05:05:41.612188 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:05:41.613669 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:05:41.613915 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 05:05:41.614100 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:42.853143 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-12-17 05:05:42.856584 (Thread-1): finished collecting timing info
2021-12-17 05:05:42.857038 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 05:05:43.031091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83379fb50>]}
2021-12-17 05:05:43.031993 (Thread-1): 13:05:43 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.44s]
2021-12-17 05:05:43.032430 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:05:43.032848 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:05:43.033365 (Thread-1): 13:05:43 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 05:05:43.034266 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:05:43.034781 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 05:05:43.039511 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:05:43.040298 (Thread-1): finished collecting timing info
2021-12-17 05:05:43.060068 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:05:43.060940 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:05:43.061113 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 05:05:43.061258 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:43.722278 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-12-17 05:05:43.725739 (Thread-1): finished collecting timing info
2021-12-17 05:05:43.726199 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 05:05:43.898228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83396c430>]}
2021-12-17 05:05:43.899149 (Thread-1): 13:05:43 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.86s]
2021-12-17 05:05:43.899577 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:05:43.899979 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:05:43.900492 (Thread-1): 13:05:43 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 05:05:43.901155 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:05:43.901494 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 05:05:43.906492 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:05:43.907359 (Thread-1): finished collecting timing info
2021-12-17 05:05:43.910741 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:05:43.911807 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:05:43.912030 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 05:05:43.912228 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:44.567868 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-12-17 05:05:44.571340 (Thread-1): finished collecting timing info
2021-12-17 05:05:44.571797 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 05:05:44.738662 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83396c9a0>]}
2021-12-17 05:05:44.739599 (Thread-1): 13:05:44 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.84s]
2021-12-17 05:05:44.740044 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:05:44.740473 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:05:44.741002 (Thread-1): 13:05:44 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 05:05:44.742192 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:05:44.742585 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:05:44.747475 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:05:44.748427 (Thread-1): finished collecting timing info
2021-12-17 05:05:44.751767 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:05:44.753308 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:05:44.753547 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 05:05:44.753755 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:46.641831 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-12-17 05:05:46.645303 (Thread-1): finished collecting timing info
2021-12-17 05:05:46.645758 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 05:05:46.808020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc833758df0>]}
2021-12-17 05:05:46.808942 (Thread-1): 13:05:46 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.07s]
2021-12-17 05:05:46.809381 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:05:46.809797 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:05:46.810321 (Thread-1): 13:05:46 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 05:05:46.811247 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:05:46.811631 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:05:46.816376 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:05:46.817266 (Thread-1): finished collecting timing info
2021-12-17 05:05:46.822194 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:05:46.823456 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:05:46.823656 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 05:05:46.823831 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:48.238794 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-12-17 05:05:48.242280 (Thread-1): finished collecting timing info
2021-12-17 05:05:48.242741 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 05:05:48.603640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83396a730>]}
2021-12-17 05:05:48.604542 (Thread-1): 13:05:48 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.79s]
2021-12-17 05:05:48.604965 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:05:48.605368 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:05:48.605871 (Thread-1): 13:05:48 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 05:05:48.606803 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:05:48.607205 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:05:48.612944 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:05:48.613719 (Thread-1): finished collecting timing info
2021-12-17 05:05:48.617013 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:05:48.618953 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:05:48.619188 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-17 05:05:48.619356 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:50.036188 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-12-17 05:05:50.039557 (Thread-1): finished collecting timing info
2021-12-17 05:05:50.040005 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 05:05:50.399301 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83396aca0>]}
2021-12-17 05:05:50.400089 (Thread-1): 13:05:50 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.79s]
2021-12-17 05:05:50.400430 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:05:50.401323 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:05:50.401785 (Thread-1): 13:05:50 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 05:05:50.402243 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:05:50.402484 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 05:05:50.409763 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 05:05:50.410408 (Thread-1): finished collecting timing info
2021-12-17 05:05:50.415075 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:05:50.415279 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(nvl(r_loaddate,cast('1900-01-01 00:00:00') as timestamp),
  nvl(o_loaddate, cast('1900-01-01 00:00:00') as timestamp)) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-17 05:05:50.415441 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:05:51.382386 (Thread-1): Snowflake query id: 01a10071-3200-9b5f-0000-00008a25975d
2021-12-17 05:05:51.382942 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 58 unexpected ')'.
syntax error line 22 at position 44 unexpected ')'.
syntax error line 25 at position 7 unexpected ';'.
2021-12-17 05:05:51.383565 (Thread-1): finished collecting timing info
2021-12-17 05:05:51.384059 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 05:05:51.550639 (Thread-1): Database Error in model target_table (models/example/target_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 58 unexpected ')'.
  syntax error line 22 at position 44 unexpected ')'.
  syntax error line 25 at position 7 unexpected ';'.
Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 21 at position 58 unexpected ')'.
syntax error line 22 at position 44 unexpected ')'.
syntax error line 25 at position 7 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 97, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model target_table (models/example/target_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 58 unexpected ')'.
  syntax error line 22 at position 44 unexpected ')'.
  syntax error line 25 at position 7 unexpected ';'.
2021-12-17 05:05:51.552792 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '867b7d12-e7ad-4d0a-924d-37ede8810ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83396b580>]}
2021-12-17 05:05:51.553590 (Thread-1): 13:05:51 | 8 of 8 ERROR creating incremental model dbt.target_table............. [ERROR in 1.15s]
2021-12-17 05:05:51.554025 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:05:51.556092 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:05:51.556881 (MainThread): 13:05:51 | 
2021-12-17 05:05:51.557317 (MainThread): 13:05:51 | Finished running 2 incremental models, 3 table models, 3 view models in 15.23s.
2021-12-17 05:05:51.557709 (MainThread): Connection 'master' was properly closed.
2021-12-17 05:05:51.557938 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 05:05:51.571439 (MainThread): 
2021-12-17 05:05:51.571727 (MainThread): Completed with 1 error and 0 warnings:
2021-12-17 05:05:51.571929 (MainThread): 
2021-12-17 05:05:51.572116 (MainThread): Database Error in model target_table (models/example/target_table.sql)
2021-12-17 05:05:51.572287 (MainThread):   001003 (42000): SQL compilation error:
2021-12-17 05:05:51.572480 (MainThread):   syntax error line 21 at position 58 unexpected ')'.
2021-12-17 05:05:51.572620 (MainThread):   syntax error line 22 at position 44 unexpected ')'.
2021-12-17 05:05:51.572758 (MainThread):   syntax error line 25 at position 7 unexpected ';'.
2021-12-17 05:05:51.572922 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-12-17 05:05:51.573187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc833191cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8330ff040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8304cff40>]}
2021-12-17 05:05:51.573456 (MainThread): Flushing usage events
2021-12-17 05:06:52.246987 (MainThread): Running with dbt=0.21.0
2021-12-17 05:06:53.329257 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['example'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-17 05:06:53.330837 (MainThread): Tracking: tracking
2021-12-17 05:06:53.331437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3f4abfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41709b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41709be0>]}
2021-12-17 05:06:53.350806 (MainThread): Partial parsing not enabled
2021-12-17 05:06:53.372780 (MainThread): Parsing macros/catalog.sql
2021-12-17 05:06:53.375077 (MainThread): Parsing macros/adapters.sql
2021-12-17 05:06:53.410485 (MainThread): Parsing macros/materializations/merge.sql
2021-12-17 05:06:53.414194 (MainThread): Parsing macros/materializations/seed.sql
2021-12-17 05:06:53.418310 (MainThread): Parsing macros/materializations/view.sql
2021-12-17 05:06:53.419544 (MainThread): Parsing macros/materializations/table.sql
2021-12-17 05:06:53.422396 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-17 05:06:53.430947 (MainThread): Parsing macros/core.sql
2021-12-17 05:06:53.434838 (MainThread): Parsing macros/materializations/test.sql
2021-12-17 05:06:53.441374 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-17 05:06:53.469660 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-17 05:06:53.471367 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-17 05:06:53.487552 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-17 05:06:53.518696 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-17 05:06:53.539647 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-17 05:06:53.541034 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-17 05:06:53.550050 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-17 05:06:53.567212 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-17 05:06:53.579139 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-17 05:06:53.585956 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-17 05:06:53.592427 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-17 05:06:53.595632 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-17 05:06:53.596848 (MainThread): Parsing macros/etc/query.sql
2021-12-17 05:06:53.597641 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-17 05:06:53.598870 (MainThread): Parsing macros/etc/datetime.sql
2021-12-17 05:06:53.606127 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-17 05:06:53.607585 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-17 05:06:53.610015 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-17 05:06:53.611494 (MainThread): Parsing macros/adapters/common.sql
2021-12-17 05:06:53.658704 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-17 05:06:53.660096 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-17 05:06:53.661013 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-17 05:06:53.662032 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-17 05:06:53.663798 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-17 05:06:53.664768 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-17 05:06:53.665876 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-17 05:06:53.666623 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-17 05:06:53.671025 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-17 05:06:53.672018 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-17 05:06:53.673017 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-17 05:06:53.675239 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-17 05:06:53.676043 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-17 05:06:53.678453 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-17 05:06:53.687226 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-17 05:06:53.688807 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-17 05:06:53.689902 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-17 05:06:53.690989 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-17 05:06:53.692280 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-17 05:06:53.693471 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-17 05:06:53.694192 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-17 05:06:53.696925 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-17 05:06:53.701064 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-17 05:06:53.703808 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-17 05:06:53.705258 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-17 05:06:53.706392 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-17 05:06:53.707917 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-17 05:06:53.729101 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-17 05:06:53.730742 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-17 05:06:53.732972 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-17 05:06:53.734207 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-17 05:06:53.735065 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-17 05:06:53.736019 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-17 05:06:53.736880 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-17 05:06:53.737804 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-17 05:06:53.739312 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-17 05:06:53.740596 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-17 05:06:53.742348 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-17 05:06:53.743824 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-17 05:06:53.744795 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-17 05:06:53.746712 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-17 05:06:53.748524 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-17 05:06:53.749642 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-17 05:06:53.750617 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-17 05:06:53.752845 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-17 05:06:53.754440 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-17 05:06:53.755842 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-17 05:06:53.757550 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-17 05:06:53.759747 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-17 05:06:53.760863 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-17 05:06:53.764592 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-17 05:06:53.771893 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-17 05:06:53.775674 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-17 05:06:53.776937 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-17 05:06:53.779654 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-17 05:06:53.783685 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-17 05:06:53.787032 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-17 05:06:53.788374 (MainThread): Parsing macros/sql/star.sql
2021-12-17 05:06:53.791188 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-17 05:06:53.799376 (MainThread): Parsing macros/sql/union.sql
2021-12-17 05:06:53.806764 (MainThread): Parsing macros/sql/groupby.sql
2021-12-17 05:06:53.807996 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-17 05:06:53.810946 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-17 05:06:53.812272 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-17 05:06:53.813672 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-17 05:06:53.818683 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-17 05:06:53.823466 (MainThread): Parsing macros/sql/pivot.sql
2021-12-17 05:06:53.827214 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-17 05:06:53.829303 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-17 05:06:54.186482 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:06:54.198902 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:06:54.202523 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:06:54.206163 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:54.212615 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:06:54.216366 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:06:54.233088 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:06:54.237515 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:06:54.300986 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf418e39a0>]}
2021-12-17 05:06:54.308903 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4172ec10>]}
2021-12-17 05:06:54.309246 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-17 05:06:54.310565 (MainThread): 
2021-12-17 05:06:54.310942 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:06:54.312091 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-17 05:06:54.327026 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-17 05:06:54.327302 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-17 05:06:54.327435 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-17 05:06:55.630162 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.30 seconds
2021-12-17 05:06:55.633536 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-17 05:06:55.995467 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-17 05:06:56.008505 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-17 05:06:56.008838 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-17 05:06:56.009103 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-17 05:06:57.043239 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 1.03 seconds
2021-12-17 05:06:57.047193 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-17 05:06:57.217915 (MainThread): 13:06:57 | Concurrency: 1 threads (target='dev')
2021-12-17 05:06:57.218440 (MainThread): 13:06:57 | 
2021-12-17 05:06:57.220498 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-17 05:06:57.221180 (Thread-1): 13:06:57 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-17 05:06:57.221825 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:57.222117 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-17 05:06:57.231822 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:06:57.232597 (Thread-1): finished collecting timing info
2021-12-17 05:06:57.276204 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:57.276485 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-17 05:06:57.276659 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:06:58.778996 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-12-17 05:06:58.797757 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:58.798070 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-17 05:06:58.921881 (Thread-1): SQL status: SUCCESS 28 in 0.12 seconds
2021-12-17 05:06:58.928736 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:58.928999 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-17 05:06:59.022586 (Thread-1): SQL status: SUCCESS 28 in 0.09 seconds
2021-12-17 05:06:59.037956 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:59.038239 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-17 05:06:59.152507 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-17 05:06:59.188329 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-17 05:06:59.190959 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:59.191136 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-17 05:06:59.305711 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-12-17 05:06:59.306667 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:59.306987 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-17 05:06:59.959411 (Thread-1): SQL status: SUCCESS 0 in 0.65 seconds
2021-12-17 05:06:59.959942 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-17 05:06:59.960249 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-17 05:07:00.131621 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-12-17 05:07:00.150947 (Thread-1): finished collecting timing info
2021-12-17 05:07:00.151307 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-17 05:07:00.333751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f1f8b0>]}
2021-12-17 05:07:00.334656 (Thread-1): 13:07:00 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.11s]
2021-12-17 05:07:00.335082 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-17 05:07:00.335498 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:07:00.336015 (Thread-1): 13:07:00 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-17 05:07:00.336718 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:07:00.337095 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:07:00.342940 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:07:00.343759 (Thread-1): finished collecting timing info
2021-12-17 05:07:00.356252 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-17 05:07:00.357545 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-17 05:07:00.357752 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-17 05:07:00.357915 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:01.532854 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-12-17 05:07:01.536324 (Thread-1): finished collecting timing info
2021-12-17 05:07:01.536782 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-17 05:07:01.698567 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f5fe50>]}
2021-12-17 05:07:01.699469 (Thread-1): 13:07:01 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.36s]
2021-12-17 05:07:01.699903 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-17 05:07:01.700309 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:07:01.700838 (Thread-1): 13:07:01 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-17 05:07:01.702076 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:07:01.702509 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-17 05:07:01.707114 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:07:01.707928 (Thread-1): finished collecting timing info
2021-12-17 05:07:01.728182 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-17 05:07:01.729083 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-17 05:07:01.729260 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-17 05:07:01.729404 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:02.652113 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-12-17 05:07:02.655511 (Thread-1): finished collecting timing info
2021-12-17 05:07:02.655960 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-17 05:07:02.823795 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41fe8fd0>]}
2021-12-17 05:07:02.824701 (Thread-1): 13:07:02 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 1.12s]
2021-12-17 05:07:02.825129 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-17 05:07:02.825531 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:07:02.826037 (Thread-1): 13:07:02 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-17 05:07:02.826945 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:07:02.827351 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-17 05:07:02.832066 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:07:02.832962 (Thread-1): finished collecting timing info
2021-12-17 05:07:02.836354 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-17 05:07:02.837423 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-17 05:07:02.837648 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-17 05:07:02.837852 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:03.544072 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-12-17 05:07:03.547545 (Thread-1): finished collecting timing info
2021-12-17 05:07:03.547997 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-17 05:07:03.714418 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41fe5250>]}
2021-12-17 05:07:03.715326 (Thread-1): 13:07:03 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.89s]
2021-12-17 05:07:03.715749 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-17 05:07:03.716187 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:07:03.716708 (Thread-1): 13:07:03 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-17 05:07:03.717894 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:07:03.718304 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:07:03.723000 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:07:03.723857 (Thread-1): finished collecting timing info
2021-12-17 05:07:03.727271 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-17 05:07:03.728777 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-17 05:07:03.729005 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-17 05:07:03.729232 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:05.387142 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-17 05:07:05.390620 (Thread-1): finished collecting timing info
2021-12-17 05:07:05.391069 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-17 05:07:05.558755 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41fba0d0>]}
2021-12-17 05:07:05.560086 (Thread-1): 13:07:05 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.84s]
2021-12-17 05:07:05.561058 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-17 05:07:05.561953 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:07:05.562522 (Thread-1): 13:07:05 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-17 05:07:05.563600 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:07:05.564026 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:07:05.569710 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:07:05.570565 (Thread-1): finished collecting timing info
2021-12-17 05:07:05.575806 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-17 05:07:05.576956 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-17 05:07:05.577178 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-17 05:07:05.577378 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:07.025224 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-12-17 05:07:07.028987 (Thread-1): finished collecting timing info
2021-12-17 05:07:07.029517 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-17 05:07:07.207790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41fe6820>]}
2021-12-17 05:07:07.208698 (Thread-1): 13:07:07 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.64s]
2021-12-17 05:07:07.209126 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-17 05:07:07.209547 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:07:07.210068 (Thread-1): 13:07:07 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-17 05:07:07.210763 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:07:07.211361 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:07:07.217259 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:07:07.218051 (Thread-1): finished collecting timing info
2021-12-17 05:07:07.221406 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-17 05:07:07.223446 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-17 05:07:07.223640 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-17 05:07:07.223819 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:08.049677 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-12-17 05:07:08.053037 (Thread-1): finished collecting timing info
2021-12-17 05:07:08.053517 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-17 05:07:08.225358 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41f5fe80>]}
2021-12-17 05:07:08.226280 (Thread-1): 13:07:08 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.01s]
2021-12-17 05:07:08.226708 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-17 05:07:08.227906 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:07:08.228555 (Thread-1): 13:07:08 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-17 05:07:08.229161 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:08.229443 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-17 05:07:08.237487 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 05:07:08.238221 (Thread-1): finished collecting timing info
2021-12-17 05:07:08.243059 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:08.243280 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(r_loaddate,o_loaddate) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-17 05:07:08.243462 (Thread-1): Opening a new connection, currently in state closed
2021-12-17 05:07:09.892624 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-17 05:07:09.899801 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:09.900240 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table__dbt_tmp
2021-12-17 05:07:10.005632 (Thread-1): SQL status: SUCCESS 8 in 0.11 seconds
2021-12-17 05:07:10.010870 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:10.011140 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table
2021-12-17 05:07:10.158351 (Thread-1): SQL status: SUCCESS 6 in 0.15 seconds
2021-12-17 05:07:10.166167 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:10.166476 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table "ANALYTICS"."DBT"."TARGET_TABLE"
2021-12-17 05:07:10.269582 (Thread-1): SQL status: SUCCESS 6 in 0.10 seconds
2021-12-17 05:07:10.275063 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-17 05:07:10.277951 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:10.278238 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */
begin;
2021-12-17 05:07:10.410440 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-12-17 05:07:10.411039 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:10.411355 (Thread-1): On model.jrtests_learn_dbt1.target_table: merge into analytics.dbt.target_table as DBT_INTERNAL_DEST
        using analytics.dbt.target_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.shakey_raw = DBT_INTERNAL_DEST.shakey_raw
        

    
    when matched then update set
        "SHAKEY_RAW" = DBT_INTERNAL_SOURCE."SHAKEY_RAW","C_CUSTKEY" = DBT_INTERNAL_SOURCE."C_CUSTKEY","C_NAME" = DBT_INTERNAL_SOURCE."C_NAME","NATION" = DBT_INTERNAL_SOURCE."NATION","TOTAL_ORDER_PRICE" = DBT_INTERNAL_SOURCE."TOTAL_ORDER_PRICE","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE"
    

    when not matched then insert
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")
    values
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")

;
2021-12-17 05:07:12.759981 (Thread-1): SQL status: SUCCESS 99996 in 2.35 seconds
2021-12-17 05:07:12.760761 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-17 05:07:12.761232 (Thread-1): On model.jrtests_learn_dbt1.target_table: commit;
2021-12-17 05:07:13.039523 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-12-17 05:07:13.041915 (Thread-1): finished collecting timing info
2021-12-17 05:07:13.042257 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-17 05:07:13.218168 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b559916-736f-4aa7-9d9b-60dcdfe8d3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41fe9df0>]}
2021-12-17 05:07:13.219074 (Thread-1): 13:07:13 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 4.99s]
2021-12-17 05:07:13.219507 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-17 05:07:13.221679 (MainThread): Acquiring new snowflake connection "master".
2021-12-17 05:07:13.222435 (MainThread): 13:07:13 | 
2021-12-17 05:07:13.222751 (MainThread): 13:07:13 | Finished running 2 incremental models, 3 table models, 3 view models in 18.91s.
2021-12-17 05:07:13.223019 (MainThread): Connection 'master' was properly closed.
2021-12-17 05:07:13.223238 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-17 05:07:13.236069 (MainThread): 
2021-12-17 05:07:13.236361 (MainThread): Completed successfully
2021-12-17 05:07:13.236588 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-17 05:07:13.236864 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4172e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf418bf130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3f4abfd0>]}
2021-12-17 05:07:13.237168 (MainThread): Flushing usage events
2021-12-29 03:05:22.712900 (MainThread): Running with dbt=0.21.0
2021-12-29 03:05:26.829782 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 03:05:26.831870 (MainThread): Tracking: tracking
2021-12-29 03:05:26.832397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71ccef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed74709a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed74709af0>]}
2021-12-29 03:05:26.854415 (MainThread): Partial parsing not enabled
2021-12-29 03:05:26.902076 (MainThread): Parsing macros/catalog.sql
2021-12-29 03:05:26.904359 (MainThread): Parsing macros/adapters.sql
2021-12-29 03:05:26.944343 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 03:05:26.950051 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 03:05:26.956023 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 03:05:26.957626 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 03:05:26.960890 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 03:05:26.970891 (MainThread): Parsing macros/core.sql
2021-12-29 03:05:26.974493 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 03:05:26.982879 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 03:05:26.991961 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 03:05:26.993661 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 03:05:27.018322 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 03:05:27.052096 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 03:05:27.076063 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 03:05:27.078883 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 03:05:27.090817 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 03:05:27.111386 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 03:05:27.125117 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 03:05:27.133103 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 03:05:27.140253 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 03:05:27.143839 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 03:05:27.145227 (MainThread): Parsing macros/etc/query.sql
2021-12-29 03:05:27.146136 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 03:05:27.147546 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 03:05:27.156682 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 03:05:27.158451 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 03:05:27.160910 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 03:05:27.162439 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 03:05:27.220584 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 03:05:27.222548 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 03:05:27.223959 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 03:05:27.225479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 03:05:27.228106 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 03:05:27.229379 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 03:05:27.230846 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 03:05:27.231799 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 03:05:27.237216 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 03:05:27.238485 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 03:05:27.239706 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 03:05:27.242321 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 03:05:27.243254 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 03:05:27.245535 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 03:05:27.255433 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 03:05:27.257269 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 03:05:27.258825 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 03:05:27.260248 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 03:05:27.261786 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 03:05:27.263263 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 03:05:27.264113 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 03:05:27.267422 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 03:05:27.272579 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 03:05:27.276421 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 03:05:27.278553 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 03:05:27.280027 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 03:05:27.281985 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 03:05:27.308106 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 03:05:27.310064 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 03:05:27.312509 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 03:05:27.314039 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 03:05:27.315182 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 03:05:27.316305 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 03:05:27.317306 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 03:05:27.318385 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 03:05:27.319938 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 03:05:27.321433 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 03:05:27.323495 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 03:05:27.325259 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 03:05:27.326397 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 03:05:27.328649 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 03:05:27.330611 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 03:05:27.331941 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 03:05:27.333089 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 03:05:27.336024 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 03:05:27.338197 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 03:05:27.339989 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 03:05:27.342453 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 03:05:27.346556 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 03:05:27.349088 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 03:05:27.353986 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 03:05:27.363456 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 03:05:27.368533 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 03:05:27.370151 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 03:05:27.373585 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 03:05:27.378502 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 03:05:27.381989 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 03:05:27.383528 (MainThread): Parsing macros/sql/star.sql
2021-12-29 03:05:27.386902 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 03:05:27.394374 (MainThread): Parsing macros/sql/union.sql
2021-12-29 03:05:27.402170 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 03:05:27.403459 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 03:05:27.406754 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 03:05:27.408891 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 03:05:27.411134 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 03:05:27.417809 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 03:05:27.423569 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 03:05:27.427786 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 03:05:27.430079 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 03:05:27.813177 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:05:27.825297 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:05:27.829153 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:05:27.832550 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:27.840209 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:05:27.843874 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:27.861077 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:05:27.865540 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:05:27.925304 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7494a310>]}
2021-12-29 03:05:27.933835 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7472ebe0>]}
2021-12-29 03:05:27.934150 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 03:05:27.935477 (MainThread): 
2021-12-29 03:05:27.935841 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 03:05:27.936829 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 03:05:27.948838 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 03:05:27.949022 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 03:05:27.949139 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 03:05:29.148027 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.20 seconds
2021-12-29 03:05:29.151804 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-29 03:05:29.331965 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 03:05:29.348123 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 03:05:29.348469 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 03:05:29.348679 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-29 03:05:30.027487 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.68 seconds
2021-12-29 03:05:30.031170 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-29 03:05:30.198647 (MainThread): 11:05:30 | Concurrency: 1 threads (target='dev')
2021-12-29 03:05:30.199149 (MainThread): 11:05:30 | 
2021-12-29 03:05:30.201212 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-29 03:05:30.201783 (Thread-1): 11:05:30 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-29 03:05:30.202384 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:30.202661 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-29 03:05:30.212313 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 03:05:30.215368 (Thread-1): finished collecting timing info
2021-12-29 03:05:30.264267 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:30.264519 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-29 03:05:30.264657 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:32.458012 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2021-12-29 03:05:32.475978 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:32.476306 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-29 03:05:32.604161 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-12-29 03:05:32.613797 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:32.614117 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-29 03:05:32.742102 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-12-29 03:05:32.759053 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:32.759361 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-29 03:05:32.859147 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-29 03:05:32.914457 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 03:05:32.921518 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:32.921960 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-29 03:05:33.045958 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-29 03:05:33.046683 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:33.047006 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-29 03:05:34.173300 (Thread-1): SQL status: SUCCESS 12 in 1.13 seconds
2021-12-29 03:05:34.173530 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:05:34.173653 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-29 03:05:34.461986 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-12-29 03:05:34.470326 (Thread-1): finished collecting timing info
2021-12-29 03:05:34.470537 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-29 03:05:34.642672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed75093bb0>]}
2021-12-29 03:05:34.643123 (Thread-1): 11:05:34 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 4.44s]
2021-12-29 03:05:34.643321 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-29 03:05:34.643474 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:05:34.643747 (Thread-1): 11:05:34 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-29 03:05:34.644065 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:05:34.644220 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:05:34.647151 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 03:05:34.647735 (Thread-1): finished collecting timing info
2021-12-29 03:05:34.655591 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 03:05:34.656618 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:05:34.656828 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-29 03:05:34.657037 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:35.858822 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-12-29 03:05:35.860218 (Thread-1): finished collecting timing info
2021-12-29 03:05:35.860478 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-29 03:05:36.007729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed750b3eb0>]}
2021-12-29 03:05:36.008106 (Thread-1): 11:05:36 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.36s]
2021-12-29 03:05:36.008313 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:05:36.008464 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-29 03:05:36.008757 (Thread-1): 11:05:36 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-29 03:05:36.009179 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:05:36.009363 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-29 03:05:36.012391 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 03:05:36.013149 (Thread-1): finished collecting timing info
2021-12-29 03:05:36.026016 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 03:05:36.026795 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:05:36.026921 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-29 03:05:36.027027 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:36.664012 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-12-29 03:05:36.667329 (Thread-1): finished collecting timing info
2021-12-29 03:05:36.667781 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-29 03:05:36.826097 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed750f7bb0>]}
2021-12-29 03:05:36.826990 (Thread-1): 11:05:36 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.82s]
2021-12-29 03:05:36.827412 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-29 03:05:36.827796 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-29 03:05:36.828294 (Thread-1): 11:05:36 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-29 03:05:36.828980 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:05:36.829308 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-29 03:05:36.834366 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 03:05:36.835408 (Thread-1): finished collecting timing info
2021-12-29 03:05:36.838851 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 03:05:36.839925 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:05:36.840142 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-29 03:05:36.840344 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:37.490448 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-12-29 03:05:37.494743 (Thread-1): finished collecting timing info
2021-12-29 03:05:37.498519 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-29 03:05:37.662709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed750f7430>]}
2021-12-29 03:05:37.663288 (Thread-1): 11:05:37 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.83s]
2021-12-29 03:05:37.663548 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-29 03:05:37.663786 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:05:37.664089 (Thread-1): 11:05:37 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-29 03:05:37.664688 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:05:37.664954 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:05:37.668372 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 03:05:37.669053 (Thread-1): finished collecting timing info
2021-12-29 03:05:37.671914 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 03:05:37.673313 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:05:37.673513 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-29 03:05:37.673672 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:40.070699 (Thread-1): SQL status: SUCCESS 1 in 2.40 seconds
2021-12-29 03:05:40.074129 (Thread-1): finished collecting timing info
2021-12-29 03:05:40.074590 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-29 03:05:40.249909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed74cb30a0>]}
2021-12-29 03:05:40.250834 (Thread-1): 11:05:40 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.59s]
2021-12-29 03:05:40.251264 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:05:40.251660 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:05:40.252172 (Thread-1): 11:05:40 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-29 03:05:40.253104 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:05:40.253507 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:05:40.258351 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 03:05:40.259267 (Thread-1): finished collecting timing info
2021-12-29 03:05:40.263953 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 03:05:40.265160 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:05:40.265408 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-29 03:05:40.265584 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:41.597408 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-12-29 03:05:41.600890 (Thread-1): finished collecting timing info
2021-12-29 03:05:41.601370 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-29 03:05:41.782560 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed750ce4c0>]}
2021-12-29 03:05:41.783362 (Thread-1): 11:05:41 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.53s]
2021-12-29 03:05:41.783749 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:05:41.784084 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:05:41.784433 (Thread-1): 11:05:41 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-29 03:05:41.784890 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:05:41.785119 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:05:41.790250 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 03:05:41.790927 (Thread-1): finished collecting timing info
2021-12-29 03:05:41.793953 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 03:05:41.795727 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:05:41.795949 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-29 03:05:41.796106 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:42.550644 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-12-29 03:05:42.553999 (Thread-1): finished collecting timing info
2021-12-29 03:05:42.554458 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-29 03:05:42.735615 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed750ce0a0>]}
2021-12-29 03:05:42.736679 (Thread-1): 11:05:42 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 0.95s]
2021-12-29 03:05:42.737155 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:05:42.737962 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-29 03:05:42.738421 (Thread-1): 11:05:42 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-29 03:05:42.739271 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:42.739732 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-29 03:05:42.748004 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 03:05:42.750516 (Thread-1): finished collecting timing info
2021-12-29 03:05:42.758381 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:42.758767 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(r_loaddate,o_loaddate) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-29 03:05:42.759089 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:05:44.465096 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-12-29 03:05:44.472751 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:44.473106 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table__dbt_tmp
2021-12-29 03:05:44.628757 (Thread-1): SQL status: SUCCESS 8 in 0.16 seconds
2021-12-29 03:05:44.636631 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:44.636956 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table
2021-12-29 03:05:44.743459 (Thread-1): SQL status: SUCCESS 6 in 0.11 seconds
2021-12-29 03:05:44.751326 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:44.751637 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table "ANALYTICS"."DBT"."TARGET_TABLE"
2021-12-29 03:05:44.892796 (Thread-1): SQL status: SUCCESS 6 in 0.14 seconds
2021-12-29 03:05:44.898654 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 03:05:44.901454 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:44.901754 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */
begin;
2021-12-29 03:05:45.048534 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-12-29 03:05:45.049402 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:45.049890 (Thread-1): On model.jrtests_learn_dbt1.target_table: merge into analytics.dbt.target_table as DBT_INTERNAL_DEST
        using analytics.dbt.target_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.shakey_raw = DBT_INTERNAL_DEST.shakey_raw
        

    
    when matched then update set
        "SHAKEY_RAW" = DBT_INTERNAL_SOURCE."SHAKEY_RAW","C_CUSTKEY" = DBT_INTERNAL_SOURCE."C_CUSTKEY","C_NAME" = DBT_INTERNAL_SOURCE."C_NAME","NATION" = DBT_INTERNAL_SOURCE."NATION","TOTAL_ORDER_PRICE" = DBT_INTERNAL_SOURCE."TOTAL_ORDER_PRICE","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE"
    

    when not matched then insert
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")
    values
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")

;
2021-12-29 03:05:47.666134 (Thread-1): SQL status: SUCCESS 99996 in 2.62 seconds
2021-12-29 03:05:47.666573 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:05:47.666828 (Thread-1): On model.jrtests_learn_dbt1.target_table: commit;
2021-12-29 03:05:48.000811 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-12-29 03:05:48.005206 (Thread-1): finished collecting timing info
2021-12-29 03:05:48.005749 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-29 03:05:48.364669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c85614-b399-4d32-8b76-fdb1203b22e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed74cdd460>]}
2021-12-29 03:05:48.365589 (Thread-1): 11:05:48 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 5.63s]
2021-12-29 03:05:48.366034 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-29 03:05:48.368310 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 03:05:48.369046 (MainThread): 11:05:48 | 
2021-12-29 03:05:48.369369 (MainThread): 11:05:48 | Finished running 2 incremental models, 3 table models, 3 view models in 20.43s.
2021-12-29 03:05:48.369636 (MainThread): Connection 'master' was properly closed.
2021-12-29 03:05:48.369864 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-29 03:05:48.384575 (MainThread): 
2021-12-29 03:05:48.384880 (MainThread): Completed successfully
2021-12-29 03:05:48.385110 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-29 03:05:48.385390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7472eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed74898040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71ccef70>]}
2021-12-29 03:05:48.385714 (MainThread): Flushing usage events
2021-12-29 03:07:54.355023 (MainThread): Running with dbt=0.21.0
2021-12-29 03:07:55.219593 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 03:07:55.221134 (MainThread): Tracking: tracking
2021-12-29 03:07:55.221651 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89854c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987709a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987709af0>]}
2021-12-29 03:07:55.239425 (MainThread): Partial parsing not enabled
2021-12-29 03:07:55.259518 (MainThread): Parsing macros/catalog.sql
2021-12-29 03:07:55.261636 (MainThread): Parsing macros/adapters.sql
2021-12-29 03:07:55.296422 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 03:07:55.300065 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 03:07:55.304378 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 03:07:55.305590 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 03:07:55.308262 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 03:07:55.316430 (MainThread): Parsing macros/core.sql
2021-12-29 03:07:55.322054 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 03:07:55.328603 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 03:07:55.338045 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 03:07:55.340461 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 03:07:55.356961 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 03:07:55.388334 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 03:07:55.410523 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 03:07:55.412435 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 03:07:55.421218 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 03:07:55.440178 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 03:07:55.453391 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 03:07:55.460876 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 03:07:55.467749 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 03:07:55.471084 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 03:07:55.472337 (MainThread): Parsing macros/etc/query.sql
2021-12-29 03:07:55.473131 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 03:07:55.474382 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 03:07:55.481776 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 03:07:55.483266 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 03:07:55.485287 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 03:07:55.486589 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 03:07:55.532958 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 03:07:55.534977 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 03:07:55.536333 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 03:07:55.537427 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 03:07:55.539600 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 03:07:55.540443 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 03:07:55.541574 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 03:07:55.542360 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 03:07:55.546915 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 03:07:55.548436 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 03:07:55.549537 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 03:07:55.551789 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 03:07:55.552609 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 03:07:55.554470 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 03:07:55.562904 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 03:07:55.564369 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 03:07:55.565483 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 03:07:55.566591 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 03:07:55.567896 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 03:07:55.569489 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 03:07:55.570268 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 03:07:55.573063 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 03:07:55.577455 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 03:07:55.580251 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 03:07:55.582075 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 03:07:55.583274 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 03:07:55.584878 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 03:07:55.606170 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 03:07:55.608401 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 03:07:55.610505 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 03:07:55.611781 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 03:07:55.612660 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 03:07:55.613606 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 03:07:55.614479 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 03:07:55.615416 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 03:07:55.616738 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 03:07:55.618041 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 03:07:55.619999 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 03:07:55.621506 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 03:07:55.622485 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 03:07:55.624435 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 03:07:55.626210 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 03:07:55.627334 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 03:07:55.628326 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 03:07:55.630602 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 03:07:55.632229 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 03:07:55.633671 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 03:07:55.635602 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 03:07:55.637840 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 03:07:55.639001 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 03:07:55.642484 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 03:07:55.649945 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 03:07:55.653731 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 03:07:55.655015 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 03:07:55.657918 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 03:07:55.661493 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 03:07:55.664389 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 03:07:55.665740 (MainThread): Parsing macros/sql/star.sql
2021-12-29 03:07:55.668604 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 03:07:55.676484 (MainThread): Parsing macros/sql/union.sql
2021-12-29 03:07:55.684647 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 03:07:55.685793 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 03:07:55.688673 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 03:07:55.690003 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 03:07:55.691311 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 03:07:55.696450 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 03:07:55.700728 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 03:07:55.704258 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 03:07:55.706358 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 03:07:56.070267 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:07:56.084290 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:07:56.088638 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:07:56.092123 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:07:56.099686 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:07:56.103123 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:07:56.120780 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:07:56.125245 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:07:56.183650 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f898794a040>]}
2021-12-29 03:07:56.191262 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f898772d310>]}
2021-12-29 03:07:56.191758 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 03:07:56.193240 (MainThread): 
2021-12-29 03:07:56.193614 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 03:07:56.194827 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 03:07:56.206611 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 03:07:56.206799 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 03:07:56.206915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 03:07:57.110581 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-12-29 03:07:57.113946 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-29 03:07:57.284219 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 03:07:57.296596 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 03:07:57.296893 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 03:07:57.297108 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-29 03:07:58.120749 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.82 seconds
2021-12-29 03:07:58.124844 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-29 03:07:58.311690 (MainThread): 11:07:58 | Concurrency: 1 threads (target='dev')
2021-12-29 03:07:58.312220 (MainThread): 11:07:58 | 
2021-12-29 03:07:58.314284 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-29 03:07:58.314846 (Thread-1): 11:07:58 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-29 03:07:58.315428 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:07:58.315714 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-29 03:07:58.325351 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 03:07:58.326162 (Thread-1): finished collecting timing info
2021-12-29 03:07:58.370712 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:07:58.370923 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-29 03:07:58.371054 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:07:59.943233 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-12-29 03:07:59.960588 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:07:59.960893 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-29 03:08:00.103721 (Thread-1): SQL status: SUCCESS 28 in 0.14 seconds
2021-12-29 03:08:00.113792 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:08:00.114132 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-29 03:08:00.227754 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-29 03:08:00.244257 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:08:00.244542 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-29 03:08:00.345768 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-29 03:08:00.380223 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 03:08:00.382760 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:08:00.382906 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-29 03:08:00.501091 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-29 03:08:00.502192 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:08:00.502660 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-29 03:08:01.166806 (Thread-1): SQL status: SUCCESS 0 in 0.66 seconds
2021-12-29 03:08:01.167606 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 03:08:01.168071 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-29 03:08:01.324870 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-12-29 03:08:01.344395 (Thread-1): finished collecting timing info
2021-12-29 03:08:01.344710 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-29 03:08:01.525949 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987d6d850>]}
2021-12-29 03:08:01.527329 (Thread-1): 11:08:01 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 3.21s]
2021-12-29 03:08:01.527996 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-29 03:08:01.528639 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:08:01.529445 (Thread-1): 11:08:01 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-29 03:08:01.530513 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:08:01.531402 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:08:01.539411 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 03:08:01.540462 (Thread-1): finished collecting timing info
2021-12-29 03:08:01.554996 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 03:08:01.556450 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 03:08:01.556672 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-29 03:08:01.556855 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:02.703110 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-12-29 03:08:02.706582 (Thread-1): finished collecting timing info
2021-12-29 03:08:02.707048 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-29 03:08:02.867455 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987d6db50>]}
2021-12-29 03:08:02.868374 (Thread-1): 11:08:02 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.34s]
2021-12-29 03:08:02.868904 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 03:08:02.869446 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-29 03:08:02.870030 (Thread-1): 11:08:02 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-29 03:08:02.871023 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:08:02.871325 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-29 03:08:02.876193 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 03:08:02.877109 (Thread-1): finished collecting timing info
2021-12-29 03:08:02.897258 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 03:08:02.898158 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 03:08:02.898331 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-29 03:08:02.898479 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:03.536981 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-12-29 03:08:03.540460 (Thread-1): finished collecting timing info
2021-12-29 03:08:03.540930 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-29 03:08:03.713517 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8988120b80>]}
2021-12-29 03:08:03.714455 (Thread-1): 11:08:03 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.84s]
2021-12-29 03:08:03.714888 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-29 03:08:03.715305 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-29 03:08:03.715832 (Thread-1): 11:08:03 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-29 03:08:03.716763 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:08:03.717161 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-29 03:08:03.721862 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 03:08:03.722725 (Thread-1): finished collecting timing info
2021-12-29 03:08:03.726124 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 03:08:03.727295 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 03:08:03.727534 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-29 03:08:03.727739 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:04.412023 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-29 03:08:04.415524 (Thread-1): finished collecting timing info
2021-12-29 03:08:04.415984 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-29 03:08:04.585375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8988127fd0>]}
2021-12-29 03:08:04.586326 (Thread-1): 11:08:04 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.87s]
2021-12-29 03:08:04.586765 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-29 03:08:04.587176 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:08:04.587705 (Thread-1): 11:08:04 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-29 03:08:04.588886 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:08:04.589310 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:08:04.594061 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 03:08:04.594924 (Thread-1): finished collecting timing info
2021-12-29 03:08:04.598214 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 03:08:04.599864 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 03:08:04.600105 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-29 03:08:04.600314 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:06.324359 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-12-29 03:08:06.327451 (Thread-1): finished collecting timing info
2021-12-29 03:08:06.327913 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-29 03:08:06.508180 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987e9fc10>]}
2021-12-29 03:08:06.508946 (Thread-1): 11:08:06 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 1.92s]
2021-12-29 03:08:06.509301 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 03:08:06.509626 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:08:06.510237 (Thread-1): 11:08:06 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-29 03:08:06.510877 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:08:06.511168 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:08:06.515315 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 03:08:06.516083 (Thread-1): finished collecting timing info
2021-12-29 03:08:06.520246 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 03:08:06.521302 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 03:08:06.521498 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-29 03:08:06.521668 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:07.821359 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-12-29 03:08:07.823155 (Thread-1): finished collecting timing info
2021-12-29 03:08:07.823490 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-29 03:08:07.977516 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987d20d90>]}
2021-12-29 03:08:07.977940 (Thread-1): 11:08:07 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.47s]
2021-12-29 03:08:07.978151 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 03:08:07.978311 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:08:07.978605 (Thread-1): 11:08:07 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-29 03:08:07.978938 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:08:07.979099 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:08:07.982396 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 03:08:07.982922 (Thread-1): finished collecting timing info
2021-12-29 03:08:07.985005 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 03:08:07.986266 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 03:08:07.986425 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-29 03:08:07.986545 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:08.948519 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-12-29 03:08:08.952031 (Thread-1): finished collecting timing info
2021-12-29 03:08:08.952491 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-29 03:08:09.121784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987bb5e80>]}
2021-12-29 03:08:09.122696 (Thread-1): 11:08:09 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.14s]
2021-12-29 03:08:09.123116 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 03:08:09.124018 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-29 03:08:09.124858 (Thread-1): 11:08:09 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-29 03:08:09.125755 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:09.126055 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-29 03:08:09.134698 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 03:08:09.135429 (Thread-1): finished collecting timing info
2021-12-29 03:08:09.140480 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:09.140704 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(r_loaddate,o_loaddate) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-29 03:08:09.140887 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 03:08:10.792323 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-12-29 03:08:10.799287 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:10.799669 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table__dbt_tmp
2021-12-29 03:08:10.913860 (Thread-1): SQL status: SUCCESS 8 in 0.11 seconds
2021-12-29 03:08:10.921645 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:10.921980 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table
2021-12-29 03:08:11.035300 (Thread-1): SQL status: SUCCESS 6 in 0.11 seconds
2021-12-29 03:08:11.042750 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:11.043106 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table "ANALYTICS"."DBT"."TARGET_TABLE"
2021-12-29 03:08:11.148007 (Thread-1): SQL status: SUCCESS 6 in 0.10 seconds
2021-12-29 03:08:11.153687 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 03:08:11.156555 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:11.156845 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */
begin;
2021-12-29 03:08:11.271832 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-12-29 03:08:11.272717 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:11.273182 (Thread-1): On model.jrtests_learn_dbt1.target_table: merge into analytics.dbt.target_table as DBT_INTERNAL_DEST
        using analytics.dbt.target_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.shakey_raw = DBT_INTERNAL_DEST.shakey_raw
        

    
    when matched then update set
        "SHAKEY_RAW" = DBT_INTERNAL_SOURCE."SHAKEY_RAW","C_CUSTKEY" = DBT_INTERNAL_SOURCE."C_CUSTKEY","C_NAME" = DBT_INTERNAL_SOURCE."C_NAME","NATION" = DBT_INTERNAL_SOURCE."NATION","TOTAL_ORDER_PRICE" = DBT_INTERNAL_SOURCE."TOTAL_ORDER_PRICE","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE"
    

    when not matched then insert
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")
    values
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")

;
2021-12-29 03:08:13.351861 (Thread-1): SQL status: SUCCESS 99996 in 2.08 seconds
2021-12-29 03:08:13.352656 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 03:08:13.353120 (Thread-1): On model.jrtests_learn_dbt1.target_table: commit;
2021-12-29 03:08:13.659105 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-12-29 03:08:13.662524 (Thread-1): finished collecting timing info
2021-12-29 03:08:13.662972 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-29 03:08:13.842829 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb21530-3f9b-438b-97e2-16bcacc6dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8987e0ffd0>]}
2021-12-29 03:08:13.843754 (Thread-1): 11:08:13 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 4.72s]
2021-12-29 03:08:13.844186 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-29 03:08:13.846410 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 03:08:13.847110 (MainThread): 11:08:13 | 
2021-12-29 03:08:13.847428 (MainThread): 11:08:13 | Finished running 2 incremental models, 3 table models, 3 view models in 17.65s.
2021-12-29 03:08:13.847695 (MainThread): Connection 'master' was properly closed.
2021-12-29 03:08:13.847910 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-29 03:08:13.860371 (MainThread): 
2021-12-29 03:08:13.860666 (MainThread): Completed successfully
2021-12-29 03:08:13.860895 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-29 03:08:13.861170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f898772db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89878bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89854c8b20>]}
2021-12-29 03:08:13.861475 (MainThread): Flushing usage events
2021-12-29 03:54:32.982971 (MainThread): Running with dbt=0.21.0
2021-12-29 03:54:33.875742 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-29 03:54:33.876137 (MainThread): Tracking: tracking
2021-12-29 03:54:33.876313 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3779d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39e6165b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3763520>]}
2021-12-29 03:54:33.877781 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-1mzhuwcm'
2021-12-29 03:54:33.878119 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-12-29 03:54:34.549643 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-12-29 03:54:34.550291 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 03:54:34.827709 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 03:54:34.856694 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-29 03:54:35.118401 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-29 03:54:35.119067 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json
2021-12-29 03:54:35.384455 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json 200
2021-12-29 03:54:35.394962 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json
2021-12-29 03:54:35.832736 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json 200
2021-12-29 03:54:35.834170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39e6165b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a37631f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3763df0>]}
2021-12-29 03:54:35.834743 (MainThread): Flushing usage events
2021-12-29 03:54:37.138737 (MainThread): Encountered an error:
2021-12-29 03:54:37.139258 (MainThread): Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.7.6', '>=0.8.0', '<0.9.0']
2021-12-29 03:54:37.148989 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/semver.py", line 385, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/semver.py", line 287, in reduce
    start = self._try_combine_lower_bound(self.start, other.start)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/semver.py", line 245, in _try_combine_lower_bound
    return self._try_combine_lower_bound_with_exact(b, a)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/semver.py", line 228, in _try_combine_lower_bound_with_exact
    raise VersionsNotCompatibleException()
dbt.exceptions.VersionsNotCompatibleException

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/registry.py", line 123, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/semver.py", line 387, in reduce_versions
    raise VersionsNotCompatibleException(
dbt.exceptions.VersionsNotCompatibleException: Could not find a satisfactory version from options: ['=0.7.6', '>=0.8.0', '<0.9.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/deps.py", line 53, in run
    final_deps = resolve_packages(packages, self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/resolver.py", line 137, in resolve_packages
    target = final[package].resolved().fetch_metadata(config, renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/registry.py", line 127, in resolved
    raise DependencyException(new_msg) from e
dbt.exceptions.DependencyException: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.7.6', '>=0.8.0', '<0.9.0']

2021-12-29 03:56:40.499885 (MainThread): Running with dbt=0.21.0
2021-12-29 03:56:41.324088 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-29 03:56:41.324468 (MainThread): Tracking: tracking
2021-12-29 03:56:41.324649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e364ebb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e387144c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e387144f0>]}
2021-12-29 03:56:41.326092 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-jvrrq4bi'
2021-12-29 03:56:41.326441 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-12-29 03:56:41.662700 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-12-29 03:56:41.663584 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 03:56:41.934020 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 03:56:41.969805 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2021-12-29 03:56:42.241335 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2021-12-29 03:56:42.241987 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json
2021-12-29 03:56:42.508447 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json 200
2021-12-29 03:56:42.519156 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json
2021-12-29 03:56:42.987901 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json 200
2021-12-29 03:56:42.989504 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 03:56:43.260053 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 03:56:43.294835 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2021-12-29 03:56:43.559855 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2021-12-29 03:56:43.561309 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 03:56:43.847399 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 03:56:43.882314 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json
2021-12-29 03:56:44.146430 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json 200
2021-12-29 03:56:44.157121 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2021-12-29 03:56:44.425487 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2021-12-29 03:56:44.426062 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json
2021-12-29 03:56:44.696961 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging/0.6.0.json 200
2021-12-29 03:56:44.697715 (MainThread): Installing dbt-labs/dbt_utils@0.8.0
2021-12-29 03:56:45.311906 (MainThread):   Installed from version 0.8.0
2021-12-29 03:56:45.312217 (MainThread):   Up to date!
2021-12-29 03:56:45.312494 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd23541b0-05d5-4f1d-b784-932a2b1de3c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3873f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3873f0d0>]}
2021-12-29 03:56:45.312762 (MainThread): Installing dbt-labs/logging@0.6.0
2021-12-29 03:56:46.192057 (MainThread):   Installed from version 0.6.0
2021-12-29 03:56:46.192345 (MainThread):   Up to date!
2021-12-29 03:56:46.192581 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd23541b0-05d5-4f1d-b784-932a2b1de3c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3878ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3878efd0>]}
2021-12-29 03:56:46.193462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3877f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e38742f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e364ebb80>]}
2021-12-29 03:56:46.193708 (MainThread): Flushing usage events
2021-12-29 03:58:58.906810 (MainThread): Running with dbt=0.21.0
2021-12-29 03:58:59.885808 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 03:58:59.887692 (MainThread): Tracking: tracking
2021-12-29 03:58:59.888237 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f980e492c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810602ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810602d30>]}
2021-12-29 03:58:59.906694 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981062cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981062ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981062c430>]}
2021-12-29 03:58:59.907041 (MainThread): Flushing usage events
2021-12-29 03:59:01.333175 (MainThread): Encountered an error:
2021-12-29 03:59:01.333744 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 03:59:01.344690 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:01:02.694927 (MainThread): Running with dbt=0.21.0
2021-12-29 04:01:03.610628 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:01:03.612357 (MainThread): Tracking: tracking
2021-12-29 04:01:03.612878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bdecacf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be0e09a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be0e09b20>]}
2021-12-29 04:01:03.628053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be0e32340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be0e321c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be0e320d0>]}
2021-12-29 04:01:03.628381 (MainThread): Flushing usage events
2021-12-29 04:01:04.893185 (MainThread): Encountered an error:
2021-12-29 04:01:04.893761 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 04:01:04.896919 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:01:27.360613 (MainThread): Running with dbt=0.21.0
2021-12-29 04:01:28.223571 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:01:28.225081 (MainThread): Tracking: tracking
2021-12-29 04:01:28.225550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee874cef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee89709a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee89709b20>]}
2021-12-29 04:01:28.240445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee89732340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee897321c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee897320d0>]}
2021-12-29 04:01:28.240721 (MainThread): Flushing usage events
2021-12-29 04:01:29.536364 (MainThread): Encountered an error:
2021-12-29 04:01:29.536948 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 04:01:29.540206 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:01:37.966656 (MainThread): Running with dbt=0.21.0
2021-12-29 04:01:38.808976 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 04:01:38.810854 (MainThread): Tracking: tracking
2021-12-29 04:01:38.811404 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940c3c8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940e849a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940e849b20>]}
2021-12-29 04:01:38.825941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940e874340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940e8741c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940e8740d0>]}
2021-12-29 04:01:38.826235 (MainThread): Flushing usage events
2021-12-29 04:01:40.085736 (MainThread): Encountered an error:
2021-12-29 04:01:40.086314 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 04:01:40.089520 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:01:57.472765 (MainThread): Running with dbt=0.21.0
2021-12-29 04:01:58.315174 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:01:58.316681 (MainThread): Tracking: tracking
2021-12-29 04:01:58.317190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2e94cea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2eb6409a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2eb640a30>]}
2021-12-29 04:01:58.332805 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2eb66dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2eb66ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2eb6731f0>]}
2021-12-29 04:01:58.333094 (MainThread): Flushing usage events
2021-12-29 04:01:59.642968 (MainThread): Encountered an error:
2021-12-29 04:01:59.643534 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 04:01:59.646792 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:02:25.850137 (MainThread): Running with dbt=0.21.0
2021-12-29 04:02:26.713585 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-12-29 04:02:26.715362 (MainThread): Tracking: tracking
2021-12-29 04:02:26.715890 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc245debf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247f166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247f16760>]}
2021-12-29 04:02:26.742685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247f16d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247f15790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247f15ac0>]}
2021-12-29 04:02:26.742974 (MainThread): Flushing usage events
2021-12-29 04:02:28.231563 (MainThread): Encountered an error:
2021-12-29 04:02:28.232214 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    at path []: Additional properties are not allowed ('seed-paths', 'model-paths' were unexpected)
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging
2021-12-29 04:02:28.256266 (MainThread): jsonschema.exceptions.ValidationError: Additional properties are not allowed ('seed-paths', 'model-paths' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'GitPackage': {'additionalProperties': False,
                                    'description': 'GitPackage(git: str, '
                                                   'revision: Union[str, '
                                                   'float, NoneType] = '
                                                   'None, warn_unpinned: '
                                                   'Union[bool, NoneType] '
                                                   '= None, subdirectory: '
                                                   'Union[str, NoneType] = '
                                                   'None)',
                                    'properties': {'git': {'type': 'string'},
                                                   'revision': {'oneOf': [{'type': 'string'},
                                                                          {'type': 'number'},
                                                                          {'type': 'null'}]},
                                                   'subdirectory': {'oneOf': [{'type': 'string'},
                                                                              {'type': 'null'}]},
                                                   'warn-unpinned': {'oneOf': [{'type': 'boolean'},
                                                                               {'type': 'null'}]}},
                                    'required': ['git'],
                                    'type': 'object'},
                     'LocalPackage': {'additionalProperties': False,
                                      'description': 'LocalPackage(local: '
                                                     'str)',
                                      'properties': {'local': {'type': 'string'}},
                                      'required': ['local'],
                                      'type': 'object'},
                     'NoValue': {'additionalProperties': False,
                                 'description': 'Sometimes, you want a way '
                                                "to say none that isn't "
                                                'None',
                                 'properties': {'novalue': {'default': 'novalue',
                                                            'enum': ['novalue'],
                                                            'type': 'string'}},
                                 'required': [],
                                 'type': 'object'},
                     'QueryComment': {'additionalProperties': False,
                                      'description': 'QueryComment(comment: '
                                                     'str = "\\n{%- set '
                                                     'comment_dict = {} '
                                                     '-%}\\n{%- do '
                                                     'comment_dict.update(\\n    '
                                                     "app='dbt',\\n    "
                                                     'dbt_version=dbt_version,\\n    '
                                                     "profile_name=target.get('profile_name'),\\n    "
                                                     "target_name=target.get('target_name'),\\n) "
                                                     '-%}\\n{%- if node is '
                                                     'not none -%}\\n  {%- '
                                                     'do '
                                                     'comment_dict.update(\\n    '
                                                     'node_id=node.unique_id,\\n  '
                                                     ') -%}\\n{% else '
                                                     '%}\\n  {# in the '
                                                     'node context, the '
                                                     'connection name is '
                                                     'the node_id #}\\n  '
                                                     '{%- do '
                                                     'comment_dict.update(connection_name=connection_name) '
                                                     '-%}\\n{%- endif '
                                                     '-%}\\n{{ '
                                                     'return(tojson(comment_dict)) '
                                                     '}}\\n", append: bool '
                                                     '= False, job_label: '
                                                     'bool = False)',
                                      'properties': {'append': {'default': False,
                                                                'type': 'boolean'},
                                                     'comment': {'default': '\n'
                                                                            '{%- '
                                                                            'set '
                                                                            'comment_dict '
                                                                            '= '
                                                                            '{} '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(\n'
                                                                            '    '
                                                                            "app='dbt',\n"
                                                                            '    '
                                                                            'dbt_version=dbt_version,\n'
                                                                            '    '
                                                                            "profile_name=target.get('profile_name'),\n"
                                                                            '    '
                                                                            "target_name=target.get('target_name'),\n"
                                                                            ') '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'if '
                                                                            'node '
                                                                            'is '
                                                                            'not '
                                                                            'none '
                                                                            '-%}\n'
                                                                            '  '
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(\n'
                                                                            '    '
                                                                            'node_id=node.unique_id,\n'
                                                                            '  '
                                                                            ') '
                                                                            '-%}\n'
                                                                            '{% '
                                                                            'else '
                                                                            '%}\n'
                                                                            '  '
                                                                            '{# '
                                                                            'in '
                                                                            'the '
                                                                            'node '
                                                                            'context, '
                                                                            'the '
                                                                            'connection '
                                                                            'name '
                                                                            'is '
                                                                            'the '
                                                                            'node_id '
                                                                            '#}\n'
                                                                            '  '
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(connection_name=connection_name) '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'endif '
                                                                            '-%}\n'
                                                                            '{{ '
                                                                            'return(tojson(comment_dict)) '
                                                                            '}}\n',
                                                                 'type': 'string'},
                                                     'job-label': {'default': False,
                                                                   'type': 'boolean'}},
                                      'required': [],
                                      'type': 'object'},
                     'Quoting': {'additionalProperties': False,
                                 'description': 'Quoting(schema: '
                                                'Union[bool, NoneType] = '
                                                'None, database: '
                                                'Union[bool, NoneType] = '
                                                'None, project: '
                                                'Union[bool, NoneType] = '
                                                'None, identifier: '
                                                'Union[bool, NoneType] = '
                                                'None)',
                                 'properties': {'database': {'oneOf': [{'type': 'boolean'},
                                                                       {'type': 'null'}]},
                                                'identifier': {'oneOf': [{'type': 'boolean'},
                                                                         {'type': 'null'}]},
                                                'project': {'oneOf': [{'type': 'boolean'},
                                                                      {'type': 'null'}]},
                                                'schema': {'oneOf': [{'type': 'boolean'},
                                                                     {'type': 'null'}]}},
                                 'required': [],
                                 'type': 'object'},
                     'RegistryPackage': {'additionalProperties': False,
                                         'description': 'RegistryPackage(package: '
                                                        'str, version: '
                                                        'Union[str, float, '
                                                        'List[Union[str, '
                                                        'float]]], '
                                                        'install_prerelease: '
                                                        'Union[bool, '
                                                        'NoneType] = '
                                                        'False)',
                                         'properties': {'install-prerelease': {'default': False,
                                                                               'oneOf': [{'type': 'boolean'},
                                                                                         {'type': 'null'}]},
                                                        'package': {'type': 'string'},
                                                        'version': {'oneOf': [{'type': 'string'},
                                                                              {'type': 'number'},
                                                                              {'items': {'oneOf': [{'type': 'string'},
                                                                                                   {'type': 'number'}]},
                                                                               'type': 'array'}]}},
                                         'required': ['package', 'version'],
                                         'type': 'object'}},
     'description': 'Project(name: dbt.contracts.project.Name, version: '
                    'Union[dbt.contracts.project.SemverString, float], '
                    'config_version: int, project_root: Union[str, '
                    'NoneType] = None, source_paths: Union[List[str], '
                    'NoneType] = None, macro_paths: Union[List[str], '
                    'NoneType] = None, data_paths: Union[List[str], '
                    'NoneType] = None, test_paths: Union[List[str], '
                    'NoneType] = None, analysis_paths: Union[List[str], '
                    'NoneType] = None, docs_paths: Union[List[str], '
                    'NoneType] = None, asset_paths: Union[List[str], '
                    'NoneType] = None, target_path: Union[str, NoneType] = '
                    'None, snapshot_paths: Union[List[str], NoneType] = '
                    'None, clean_targets: Union[List[str], NoneType] = '
                    'None, profile: Union[str, NoneType] = None, log_path: '
                    'Union[str, NoneType] = None, modules_path: Union[str, '
                    'NoneType] = None, quoting: '
                    'Union[dbt.contracts.project.Quoting, NoneType] = '
                    'None, on_run_start: Union[List[str], NoneType] = '
                    '<factory>, on_run_end: Union[List[str], NoneType] = '
                    '<factory>, require_dbt_version: Union[List[str], str, '
                    'NoneType] = None, dispatch: List[Dict[str, Any]] = '
                    '<factory>, models: Dict[str, Any] = <factory>, seeds: '
                    'Dict[str, Any] = <factory>, snapshots: Dict[str, Any] '
                    '= <factory>, analyses: Dict[str, Any] = <factory>, '
                    'sources: Dict[str, Any] = <factory>, tests: Dict[str, '
                    'Any] = <factory>, vars: Union[Dict[str, Any], '
                    'NoneType] = None, packages: '
                    'List[Union[dbt.contracts.project.LocalPackage, '
                    'dbt.contracts.project.GitPackage, '
                    'dbt.contracts.project.RegistryPackage]] = <factory>, '
                    'query_comment: '
                    'Union[dbt.contracts.connection.QueryComment, '
                    'dbt.helper_types.NoValue, str, NoneType] = '
                    "NoValue(novalue=<NVEnum.novalue: 'novalue'>))",
     'properties': {'analyses': {'default': {}, 'type': 'object'},
                    'analysis-paths': {'oneOf': [{'items': {'type': 'string'},
                                                  'type': 'array'},
                                                 {'type': 'null'}]},
                    'asset-paths': {'oneOf': [{'items': {'type': 'string'},
                                               'type': 'array'},
                                              {'type': 'null'}]},
                    'clean-targets': {'oneOf': [{'items': {'type': 'string'},
                                                 'type': 'array'},
                                                {'type': 'null'}]},
                    'config-version': {'type': 'integer'},
                    'data-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'dispatch': {'default': [],
                                 'items': {'type': 'object'},
                                 'type': 'array'},
                    'docs-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'log-path': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'macro-paths': {'oneOf': [{'items': {'type': 'string'},
                                               'type': 'array'},
                                              {'type': 'null'}]},
                    'models': {'default': {}, 'type': 'object'},
                    'modules-path': {'oneOf': [{'type': 'string'},
                                               {'type': 'null'}]},
                    'name': {'pattern': '^[^\\d\\W]\\w*$',
                             'type': 'string'},
                    'on-run-end': {'default': [],
                                   'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'on-run-start': {'default': [],
                                     'oneOf': [{'items': {'type': 'string'},
                                                'type': 'array'},
                                               {'type': 'null'}]},
                    'packages': {'default': [],
                                 'items': {'oneOf': [{'$ref': '#/definitions/LocalPackage'},
                                                     {'$ref': '#/definitions/GitPackage'},
                                                     {'$ref': '#/definitions/RegistryPackage'}]},
                                 'type': 'array'},
                    'profile': {'oneOf': [{'type': 'string'},
                                          {'type': 'null'}]},
                    'project-root': {'oneOf': [{'type': 'string'},
                                               {'type': 'null'}]},
                    'query-comment': {'default': {'novalue': 'novalue'},
                                      'oneOf': [{'$ref': '#/definitions/QueryComment'},
                                                {'$ref': '#/definitions/NoValue'},
                                                {'type': 'string'},
                                                {'type': 'null'}]},
                    'quoting': {'oneOf': [{'$ref': '#/definitions/Quoting'},
                                          {'type': 'null'}]},
                    'require-dbt-version': {'oneOf': [{'items': {'type': 'string'},
                                                       'type': 'array'},
                                                      {'type': 'string'},
                                                      {'type': 'null'}]},
                    'seeds': {'default': {}, 'type': 'object'},
                    'snapshot-paths': {'oneOf': [{'items': {'type': 'string'},
                                                  'type': 'array'},
                                                 {'type': 'null'}]},
                    'snapshots': {'default': {}, 'type': 'object'},
                    'source-paths': {'oneOf': [{'items': {'type': 'string'},
                                                'type': 'array'},
                                               {'type': 'null'}]},
                    'sources': {'default': {}, 'type': 'object'},
                    'target-path': {'oneOf': [{'type': 'string'},
                                              {'type': 'null'}]},
                    'test-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'tests': {'default': {}, 'type': 'object'},
                    'vars': {'description': 'map project names to their '
                                            'vars override dicts',
                             'oneOf': [{'type': 'object'},
                                       {'type': 'null'}]},
                    'version': {'oneOf': [{'pattern': '^(?:0|[1-9]\\d*)\\.(?:0|[1-9]\\d*)(\\.(?:0|[1-9]\\d*))?$',
                                           'type': 'string'},
                                          {'type': 'number'}]}},
     'required': ['name', 'version', 'config-version'],
     'type': 'object'}

On instance:
    {'analysis-paths': ['analyses'],
     'clean-targets': ['target', 'dbt_packages'],
     'config-version': 2,
     'macro-paths': ['macros'],
     'model-paths': ['models'],
     'models': {'logging': {'+schema': 'meta',
                            'bigquery': {'+enabled': False},
                            'default': {'+enabled': True}}},
     'name': 'logging',
     'on-run-end': ['{{ logging.log_run_end_event() }}'],
     'on-run-start': ['{{ logging.create_audit_schema() }}',
                      '{{ logging.create_audit_log_table() }}',
                      '{{ logging.log_run_start_event() }}'],
     'project-root': '/Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging',
     'require-dbt-version': ['>=1.0.0', '<2.0.0'],
     'seed-paths': ['seeds'],
     'target-path': 'target',
     'test-paths': ['tests'],
     'version': '0.5.0'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 307, in create_project
    ProjectContract.validate(rendered.project_dict)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/project.py", line 213, in validate
    super().validate(data)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: Additional properties are not allowed ('seed-paths', 'model-paths' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'definitions': {'GitPackage': {'additionalProperties': False,
                                    'description': 'GitPackage(git: str, '
                                                   'revision: Union[str, '
                                                   'float, NoneType] = '
                                                   'None, warn_unpinned: '
                                                   'Union[bool, NoneType] '
                                                   '= None, subdirectory: '
                                                   'Union[str, NoneType] = '
                                                   'None)',
                                    'properties': {'git': {'type': 'string'},
                                                   'revision': {'oneOf': [{'type': 'string'},
                                                                          {'type': 'number'},
                                                                          {'type': 'null'}]},
                                                   'subdirectory': {'oneOf': [{'type': 'string'},
                                                                              {'type': 'null'}]},
                                                   'warn-unpinned': {'oneOf': [{'type': 'boolean'},
                                                                               {'type': 'null'}]}},
                                    'required': ['git'],
                                    'type': 'object'},
                     'LocalPackage': {'additionalProperties': False,
                                      'description': 'LocalPackage(local: '
                                                     'str)',
                                      'properties': {'local': {'type': 'string'}},
                                      'required': ['local'],
                                      'type': 'object'},
                     'NoValue': {'additionalProperties': False,
                                 'description': 'Sometimes, you want a way '
                                                "to say none that isn't "
                                                'None',
                                 'properties': {'novalue': {'default': 'novalue',
                                                            'enum': ['novalue'],
                                                            'type': 'string'}},
                                 'required': [],
                                 'type': 'object'},
                     'QueryComment': {'additionalProperties': False,
                                      'description': 'QueryComment(comment: '
                                                     'str = "\\n{%- set '
                                                     'comment_dict = {} '
                                                     '-%}\\n{%- do '
                                                     'comment_dict.update(\\n    '
                                                     "app='dbt',\\n    "
                                                     'dbt_version=dbt_version,\\n    '
                                                     "profile_name=target.get('profile_name'),\\n    "
                                                     "target_name=target.get('target_name'),\\n) "
                                                     '-%}\\n{%- if node is '
                                                     'not none -%}\\n  {%- '
                                                     'do '
                                                     'comment_dict.update(\\n    '
                                                     'node_id=node.unique_id,\\n  '
                                                     ') -%}\\n{% else '
                                                     '%}\\n  {# in the '
                                                     'node context, the '
                                                     'connection name is '
                                                     'the node_id #}\\n  '
                                                     '{%- do '
                                                     'comment_dict.update(connection_name=connection_name) '
                                                     '-%}\\n{%- endif '
                                                     '-%}\\n{{ '
                                                     'return(tojson(comment_dict)) '
                                                     '}}\\n", append: bool '
                                                     '= False, job_label: '
                                                     'bool = False)',
                                      'properties': {'append': {'default': False,
                                                                'type': 'boolean'},
                                                     'comment': {'default': '\n'
                                                                            '{%- '
                                                                            'set '
                                                                            'comment_dict '
                                                                            '= '
                                                                            '{} '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(\n'
                                                                            '    '
                                                                            "app='dbt',\n"
                                                                            '    '
                                                                            'dbt_version=dbt_version,\n'
                                                                            '    '
                                                                            "profile_name=target.get('profile_name'),\n"
                                                                            '    '
                                                                            "target_name=target.get('target_name'),\n"
                                                                            ') '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'if '
                                                                            'node '
                                                                            'is '
                                                                            'not '
                                                                            'none '
                                                                            '-%}\n'
                                                                            '  '
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(\n'
                                                                            '    '
                                                                            'node_id=node.unique_id,\n'
                                                                            '  '
                                                                            ') '
                                                                            '-%}\n'
                                                                            '{% '
                                                                            'else '
                                                                            '%}\n'
                                                                            '  '
                                                                            '{# '
                                                                            'in '
                                                                            'the '
                                                                            'node '
                                                                            'context, '
                                                                            'the '
                                                                            'connection '
                                                                            'name '
                                                                            'is '
                                                                            'the '
                                                                            'node_id '
                                                                            '#}\n'
                                                                            '  '
                                                                            '{%- '
                                                                            'do '
                                                                            'comment_dict.update(connection_name=connection_name) '
                                                                            '-%}\n'
                                                                            '{%- '
                                                                            'endif '
                                                                            '-%}\n'
                                                                            '{{ '
                                                                            'return(tojson(comment_dict)) '
                                                                            '}}\n',
                                                                 'type': 'string'},
                                                     'job-label': {'default': False,
                                                                   'type': 'boolean'}},
                                      'required': [],
                                      'type': 'object'},
                     'Quoting': {'additionalProperties': False,
                                 'description': 'Quoting(schema: '
                                                'Union[bool, NoneType] = '
                                                'None, database: '
                                                'Union[bool, NoneType] = '
                                                'None, project: '
                                                'Union[bool, NoneType] = '
                                                'None, identifier: '
                                                'Union[bool, NoneType] = '
                                                'None)',
                                 'properties': {'database': {'oneOf': [{'type': 'boolean'},
                                                                       {'type': 'null'}]},
                                                'identifier': {'oneOf': [{'type': 'boolean'},
                                                                         {'type': 'null'}]},
                                                'project': {'oneOf': [{'type': 'boolean'},
                                                                      {'type': 'null'}]},
                                                'schema': {'oneOf': [{'type': 'boolean'},
                                                                     {'type': 'null'}]}},
                                 'required': [],
                                 'type': 'object'},
                     'RegistryPackage': {'additionalProperties': False,
                                         'description': 'RegistryPackage(package: '
                                                        'str, version: '
                                                        'Union[str, float, '
                                                        'List[Union[str, '
                                                        'float]]], '
                                                        'install_prerelease: '
                                                        'Union[bool, '
                                                        'NoneType] = '
                                                        'False)',
                                         'properties': {'install-prerelease': {'default': False,
                                                                               'oneOf': [{'type': 'boolean'},
                                                                                         {'type': 'null'}]},
                                                        'package': {'type': 'string'},
                                                        'version': {'oneOf': [{'type': 'string'},
                                                                              {'type': 'number'},
                                                                              {'items': {'oneOf': [{'type': 'string'},
                                                                                                   {'type': 'number'}]},
                                                                               'type': 'array'}]}},
                                         'required': ['package', 'version'],
                                         'type': 'object'}},
     'description': 'Project(name: dbt.contracts.project.Name, version: '
                    'Union[dbt.contracts.project.SemverString, float], '
                    'config_version: int, project_root: Union[str, '
                    'NoneType] = None, source_paths: Union[List[str], '
                    'NoneType] = None, macro_paths: Union[List[str], '
                    'NoneType] = None, data_paths: Union[List[str], '
                    'NoneType] = None, test_paths: Union[List[str], '
                    'NoneType] = None, analysis_paths: Union[List[str], '
                    'NoneType] = None, docs_paths: Union[List[str], '
                    'NoneType] = None, asset_paths: Union[List[str], '
                    'NoneType] = None, target_path: Union[str, NoneType] = '
                    'None, snapshot_paths: Union[List[str], NoneType] = '
                    'None, clean_targets: Union[List[str], NoneType] = '
                    'None, profile: Union[str, NoneType] = None, log_path: '
                    'Union[str, NoneType] = None, modules_path: Union[str, '
                    'NoneType] = None, quoting: '
                    'Union[dbt.contracts.project.Quoting, NoneType] = '
                    'None, on_run_start: Union[List[str], NoneType] = '
                    '<factory>, on_run_end: Union[List[str], NoneType] = '
                    '<factory>, require_dbt_version: Union[List[str], str, '
                    'NoneType] = None, dispatch: List[Dict[str, Any]] = '
                    '<factory>, models: Dict[str, Any] = <factory>, seeds: '
                    'Dict[str, Any] = <factory>, snapshots: Dict[str, Any] '
                    '= <factory>, analyses: Dict[str, Any] = <factory>, '
                    'sources: Dict[str, Any] = <factory>, tests: Dict[str, '
                    'Any] = <factory>, vars: Union[Dict[str, Any], '
                    'NoneType] = None, packages: '
                    'List[Union[dbt.contracts.project.LocalPackage, '
                    'dbt.contracts.project.GitPackage, '
                    'dbt.contracts.project.RegistryPackage]] = <factory>, '
                    'query_comment: '
                    'Union[dbt.contracts.connection.QueryComment, '
                    'dbt.helper_types.NoValue, str, NoneType] = '
                    "NoValue(novalue=<NVEnum.novalue: 'novalue'>))",
     'properties': {'analyses': {'default': {}, 'type': 'object'},
                    'analysis-paths': {'oneOf': [{'items': {'type': 'string'},
                                                  'type': 'array'},
                                                 {'type': 'null'}]},
                    'asset-paths': {'oneOf': [{'items': {'type': 'string'},
                                               'type': 'array'},
                                              {'type': 'null'}]},
                    'clean-targets': {'oneOf': [{'items': {'type': 'string'},
                                                 'type': 'array'},
                                                {'type': 'null'}]},
                    'config-version': {'type': 'integer'},
                    'data-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'dispatch': {'default': [],
                                 'items': {'type': 'object'},
                                 'type': 'array'},
                    'docs-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'log-path': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'macro-paths': {'oneOf': [{'items': {'type': 'string'},
                                               'type': 'array'},
                                              {'type': 'null'}]},
                    'models': {'default': {}, 'type': 'object'},
                    'modules-path': {'oneOf': [{'type': 'string'},
                                               {'type': 'null'}]},
                    'name': {'pattern': '^[^\\d\\W]\\w*$',
                             'type': 'string'},
                    'on-run-end': {'default': [],
                                   'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'on-run-start': {'default': [],
                                     'oneOf': [{'items': {'type': 'string'},
                                                'type': 'array'},
                                               {'type': 'null'}]},
                    'packages': {'default': [],
                                 'items': {'oneOf': [{'$ref': '#/definitions/LocalPackage'},
                                                     {'$ref': '#/definitions/GitPackage'},
                                                     {'$ref': '#/definitions/RegistryPackage'}]},
                                 'type': 'array'},
                    'profile': {'oneOf': [{'type': 'string'},
                                          {'type': 'null'}]},
                    'project-root': {'oneOf': [{'type': 'string'},
                                               {'type': 'null'}]},
                    'query-comment': {'default': {'novalue': 'novalue'},
                                      'oneOf': [{'$ref': '#/definitions/QueryComment'},
                                                {'$ref': '#/definitions/NoValue'},
                                                {'type': 'string'},
                                                {'type': 'null'}]},
                    'quoting': {'oneOf': [{'$ref': '#/definitions/Quoting'},
                                          {'type': 'null'}]},
                    'require-dbt-version': {'oneOf': [{'items': {'type': 'string'},
                                                       'type': 'array'},
                                                      {'type': 'string'},
                                                      {'type': 'null'}]},
                    'seeds': {'default': {}, 'type': 'object'},
                    'snapshot-paths': {'oneOf': [{'items': {'type': 'string'},
                                                  'type': 'array'},
                                                 {'type': 'null'}]},
                    'snapshots': {'default': {}, 'type': 'object'},
                    'source-paths': {'oneOf': [{'items': {'type': 'string'},
                                                'type': 'array'},
                                               {'type': 'null'}]},
                    'sources': {'default': {}, 'type': 'object'},
                    'target-path': {'oneOf': [{'type': 'string'},
                                              {'type': 'null'}]},
                    'test-paths': {'oneOf': [{'items': {'type': 'string'},
                                              'type': 'array'},
                                             {'type': 'null'}]},
                    'tests': {'default': {}, 'type': 'object'},
                    'vars': {'description': 'map project names to their '
                                            'vars override dicts',
                             'oneOf': [{'type': 'object'},
                                       {'type': 'null'}]},
                    'version': {'oneOf': [{'pattern': '^(?:0|[1-9]\\d*)\\.(?:0|[1-9]\\d*)(\\.(?:0|[1-9]\\d*))?$',
                                           'type': 'string'},
                                          {'type': 'number'}]}},
     'required': ['name', 'version', 'config-version'],
     'type': 'object'}

On instance:
    {'analysis-paths': ['analyses'],
     'clean-targets': ['target', 'dbt_packages'],
     'config-version': 2,
     'macro-paths': ['macros'],
     'model-paths': ['models'],
     'models': {'logging': {'+schema': 'meta',
                            'bigquery': {'+enabled': False},
                            'default': {'+enabled': True}}},
     'name': 'logging',
     'on-run-end': ['{{ logging.log_run_end_event() }}'],
     'on-run-start': ['{{ logging.create_audit_schema() }}',
                      '{{ logging.create_audit_log_table() }}',
                      '{{ logging.log_run_start_event() }}'],
     'project-root': '/Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging',
     'require-dbt-version': ['>=1.0.0', '<2.0.0'],
     'seed-paths': ['seeds'],
     'target-path': 'target',
     'test-paths': ['tests'],
     'version': '0.5.0'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 312, in create_project
    raise DbtProjectError(validator_error_message(e)) from e
dbt.exceptions.DbtProjectError: Runtime Error
  at path []: Additional properties are not allowed ('seed-paths', 'model-paths' were unexpected)

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    at path []: Additional properties are not allowed ('seed-paths', 'model-paths' were unexpected)
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging

2021-12-29 04:03:00.452973 (MainThread): Running with dbt=0.21.0
2021-12-29 04:03:01.326053 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:03:01.327831 (MainThread): Tracking: tracking
2021-12-29 04:03:01.328338 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb13a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb3709af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb3709b80>]}
2021-12-29 04:03:01.343413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb37323a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb3732220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb3732130>]}
2021-12-29 04:03:01.343702 (MainThread): Flushing usage events
2021-12-29 04:03:02.619997 (MainThread): Encountered an error:
2021-12-29 04:03:02.620565 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils
2021-12-29 04:03:02.623926 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/dbt_utils

2021-12-29 04:06:40.806631 (MainThread): Running with dbt=0.21.0
2021-12-29 04:06:41.790153 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-29 04:06:41.790518 (MainThread): Tracking: tracking
2021-12-29 04:06:41.790687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9746370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9746460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9702250>]}
2021-12-29 04:06:41.792082 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-f78f09o4'
2021-12-29 04:06:41.792411 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-12-29 04:06:42.443662 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-12-29 04:06:42.444305 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 04:06:42.723482 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 04:06:42.752715 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-29 04:06:43.015888 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-29 04:06:43.016664 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 04:06:43.280816 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 04:06:43.309300 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-29 04:06:43.578410 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-29 04:06:43.579122 (MainThread): Installing dbt-labs/dbt_utils@0.7.6
2021-12-29 04:06:44.177632 (MainThread):   Installed from version 0.7.6
2021-12-29 04:06:44.177893 (MainThread):   Updated version available: 0.8.0
2021-12-29 04:06:44.178182 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb79d8b4-e422-4cc3-ba05-e8ca06014d5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9746370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9702160>]}
2021-12-29 04:06:44.178416 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2021-12-29 04:06:44.178987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b977f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b74eceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b9746d30>]}
2021-12-29 04:06:44.179178 (MainThread): Flushing usage events
2021-12-29 04:06:50.455535 (MainThread): Running with dbt=0.21.0
2021-12-29 04:06:51.359871 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:06:51.361681 (MainThread): Tracking: tracking
2021-12-29 04:06:51.362291 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfe4acb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00f7a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00f7a9d0>]}
2021-12-29 04:06:51.388180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00f33d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00f33e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00f33af0>]}
2021-12-29 04:06:51.388471 (MainThread): Flushing usage events
2021-12-29 04:06:52.716598 (MainThread): Encountered an error:
2021-12-29 04:06:52.717164 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'logging' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'logging' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging
2021-12-29 04:06:52.720307 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'logging' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'logging' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'logging' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'logging' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging

2021-12-29 04:06:58.243248 (MainThread): Running with dbt=0.21.0
2021-12-29 04:06:59.113995 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 04:06:59.115619 (MainThread): Tracking: tracking
2021-12-29 04:06:59.116119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae64cebd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae66f09af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae66f09b80>]}
2021-12-29 04:06:59.141227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae66f339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae66f33be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae66f33f10>]}
2021-12-29 04:06:59.141516 (MainThread): Flushing usage events
2021-12-29 04:07:00.364962 (MainThread): Encountered an error:
2021-12-29 04:07:00.365397 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'logging' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'logging' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging
2021-12-29 04:07:00.367752 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'logging' package.
    Installed version of dbt: =0.21.0
    Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'logging' package, or run dbt again with --no-version-check
  

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'logging' package.
      Installed version of dbt: =0.21.0
      Required version of dbt for 'logging': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'logging' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging/dbt_project.yml

Error encountered in /Users/devanand/Documents/learn_dbt/learn_dbt/dbt_modules/logging

2021-12-29 04:09:28.492758 (MainThread): Running with dbt=0.21.0
2021-12-29 04:09:29.443913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-29 04:09:29.444349 (MainThread): Tracking: tracking
2021-12-29 04:09:29.444540 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc667550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc667370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc614220>]}
2021-12-29 04:09:29.446232 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-fue_wjd3'
2021-12-29 04:09:29.446673 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-12-29 04:09:29.782662 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-12-29 04:09:29.783294 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 04:09:30.060201 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 04:09:30.090161 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-29 04:09:30.365236 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-29 04:09:30.365921 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2021-12-29 04:09:30.634098 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2021-12-29 04:09:30.661948 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2021-12-29 04:09:30.935096 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2021-12-29 04:09:30.935854 (MainThread): Installing dbt-labs/dbt_utils@0.7.6
2021-12-29 04:09:31.812656 (MainThread):   Installed from version 0.7.6
2021-12-29 04:09:31.812887 (MainThread):   Updated version available: 0.8.0
2021-12-29 04:09:31.813094 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '5c959ba5-8355-41eb-aa74-9520a4ebae5e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc667370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc6142e0>]}
2021-12-29 04:09:31.813317 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2021-12-29 04:09:31.814052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc6680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc667460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc667550>]}
2021-12-29 04:09:31.814329 (MainThread): Flushing usage events
2021-12-29 04:09:40.169197 (MainThread): Running with dbt=0.21.0
2021-12-29 04:09:41.046853 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 04:09:41.048550 (MainThread): Tracking: tracking
2021-12-29 04:09:41.049127 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bd4ebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bff04bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bff04c40>]}
2021-12-29 04:09:41.068860 (MainThread): Partial parsing not enabled
2021-12-29 04:09:41.091502 (MainThread): Parsing macros/catalog.sql
2021-12-29 04:09:41.093974 (MainThread): Parsing macros/adapters.sql
2021-12-29 04:09:41.129012 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 04:09:41.132666 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 04:09:41.136974 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 04:09:41.138142 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 04:09:41.140826 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 04:09:41.149289 (MainThread): Parsing macros/core.sql
2021-12-29 04:09:41.153386 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 04:09:41.159207 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 04:09:41.168603 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 04:09:41.170094 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 04:09:41.186159 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 04:09:41.218235 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 04:09:41.239514 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 04:09:41.241122 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 04:09:41.250863 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 04:09:41.267784 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 04:09:41.279106 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 04:09:41.285904 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 04:09:41.292057 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 04:09:41.295348 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 04:09:41.296586 (MainThread): Parsing macros/etc/query.sql
2021-12-29 04:09:41.297350 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 04:09:41.298543 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 04:09:41.305497 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 04:09:41.306920 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 04:09:41.308832 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 04:09:41.310086 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 04:09:41.355870 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 04:09:41.357205 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 04:09:41.358452 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 04:09:41.359619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 04:09:41.361405 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 04:09:41.362218 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 04:09:41.363346 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 04:09:41.364103 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 04:09:41.368517 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 04:09:41.369524 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 04:09:41.370536 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 04:09:41.372780 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 04:09:41.373597 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 04:09:41.375380 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 04:09:41.384058 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 04:09:41.385791 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 04:09:41.386889 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 04:09:41.388189 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 04:09:41.389490 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 04:09:41.390722 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 04:09:41.391445 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 04:09:41.394371 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 04:09:41.398612 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 04:09:41.401458 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 04:09:41.402890 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 04:09:41.404050 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 04:09:41.405590 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 04:09:41.427023 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 04:09:41.431258 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 04:09:41.434431 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 04:09:41.435865 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 04:09:41.436891 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 04:09:41.437972 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 04:09:41.438980 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 04:09:41.440075 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 04:09:41.441620 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 04:09:41.443107 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 04:09:41.444943 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 04:09:41.446433 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 04:09:41.447413 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 04:09:41.449363 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 04:09:41.451276 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 04:09:41.452403 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 04:09:41.453405 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 04:09:41.455950 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 04:09:41.457918 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 04:09:41.459593 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 04:09:41.461620 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 04:09:41.464431 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 04:09:41.465747 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 04:09:41.469064 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 04:09:41.477584 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 04:09:41.481900 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 04:09:41.483389 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 04:09:41.486625 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 04:09:41.490623 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 04:09:41.493908 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 04:09:41.495261 (MainThread): Parsing macros/sql/star.sql
2021-12-29 04:09:41.499027 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 04:09:41.507083 (MainThread): Parsing macros/sql/union.sql
2021-12-29 04:09:41.514005 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 04:09:41.515111 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 04:09:41.517906 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 04:09:41.519228 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 04:09:41.520535 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 04:09:41.526067 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 04:09:41.530667 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 04:09:41.534455 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 04:09:41.536636 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 04:09:41.896935 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 04:09:41.907633 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '0f8515de-b736-4c2e-b2ab-3766c2097f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c0044dc0>]}
2021-12-29 04:09:41.908664 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 04:09:41.912332 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 04:09:41.915433 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 04:09:41.922333 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 04:09:41.925451 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 04:09:41.942420 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 04:09:41.946598 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 04:09:42.002505 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f8515de-b736-4c2e-b2ab-3766c2097f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c00a0550>]}
2021-12-29 04:09:42.010078 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f8515de-b736-4c2e-b2ab-3766c2097f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bff2bc40>]}
2021-12-29 04:09:42.010427 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 04:09:42.011790 (MainThread): 
2021-12-29 04:09:42.012304 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 04:09:42.013409 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 04:09:42.027556 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 04:09:42.027756 (ThreadPoolExecutor-0_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 04:09:42.027884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 04:09:42.936881 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 10 in 0.91 seconds
2021-12-29 04:09:42.941079 (ThreadPoolExecutor-0_0): On list_analytics_dbt: Close
2021-12-29 04:09:43.105936 (MainThread): 12:09:43 | Concurrency: 1 threads (target='dev')
2021-12-29 04:09:43.106468 (MainThread): 12:09:43 | 
2021-12-29 04:09:43.109220 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-29 04:09:43.109901 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 04:09:43.110213 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-29 04:09:43.119474 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 04:09:43.120298 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.120613 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.121110 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-29 04:09:43.121344 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 04:09:43.121720 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 04:09:43.121919 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 04:09:43.127228 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 04:09:43.127851 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.128078 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.128458 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 04:09:43.128656 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-29 04:09:43.128980 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 04:09:43.129150 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-29 04:09:43.131989 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 04:09:43.132768 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.133038 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.133388 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-29 04:09:43.133587 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-29 04:09:43.133898 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 04:09:43.134079 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-29 04:09:43.137215 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 04:09:43.137799 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.138064 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.138459 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-29 04:09:43.138664 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 04:09:43.139245 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 04:09:43.139570 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 04:09:43.142275 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 04:09:43.142759 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.143165 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.143532 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 04:09:43.143700 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 04:09:43.144172 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 04:09:43.144664 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 04:09:43.147751 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 04:09:43.148305 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.148671 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.149121 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 04:09:43.149321 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 04:09:43.149670 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710".
2021-12-29 04:09:43.149831 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 04:09:43.160227 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710"
2021-12-29 04:09:43.160925 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.161118 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.161411 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 04:09:43.161564 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 04:09:43.161814 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321".
2021-12-29 04:09:43.161964 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 04:09:43.168358 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321"
2021-12-29 04:09:43.168851 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.169086 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.169376 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 04:09:43.169524 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 04:09:43.169757 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 04:09:43.169879 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 04:09:43.172688 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 04:09:43.173234 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.173414 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.173705 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 04:09:43.173854 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 04:09:43.174086 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688".
2021-12-29 04:09:43.174208 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 04:09:43.177261 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688"
2021-12-29 04:09:43.178148 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.178331 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.178621 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 04:09:43.178770 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 04:09:43.179003 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833".
2021-12-29 04:09:43.179129 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 04:09:43.183149 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833"
2021-12-29 04:09:43.183835 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.184024 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.184314 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 04:09:43.184470 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 04:09:43.184810 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778".
2021-12-29 04:09:43.185022 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 04:09:43.188015 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778"
2021-12-29 04:09:43.188443 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.188608 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.188878 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 04:09:43.189027 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 04:09:43.189255 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493".
2021-12-29 04:09:43.189376 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 04:09:43.192310 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493"
2021-12-29 04:09:43.192749 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.192928 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.193206 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 04:09:43.193354 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-29 04:09:43.193585 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 04:09:43.193710 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-29 04:09:43.198098 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 04:09:43.198673 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.198880 (Thread-1): finished collecting timing info
2021-12-29 04:09:43.199175 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-29 04:09:43.200122 (MainThread): Connection 'master' was properly closed.
2021-12-29 04:09:43.200265 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-29 04:09:43.207109 (MainThread): 12:09:43 | Done.
2021-12-29 04:09:43.207354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c00c0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bd4ebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0bff2b9a0>]}
2021-12-29 04:09:43.207637 (MainThread): Flushing usage events
2021-12-29 05:10:12.022080 (MainThread): Running with dbt=0.21.0
2021-12-29 05:10:12.977397 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-12-29 05:10:12.979272 (MainThread): Tracking: tracking
2021-12-29 05:10:12.979845 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56e4c7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570779a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570779b20>]}
2021-12-29 05:10:12.997746 (MainThread): Partial parsing not enabled
2021-12-29 05:10:13.020606 (MainThread): Parsing macros/catalog.sql
2021-12-29 05:10:13.023026 (MainThread): Parsing macros/adapters.sql
2021-12-29 05:10:13.057362 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 05:10:13.060981 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 05:10:13.065096 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 05:10:13.066314 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 05:10:13.069195 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 05:10:13.077196 (MainThread): Parsing macros/core.sql
2021-12-29 05:10:13.081703 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 05:10:13.087409 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 05:10:13.097060 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 05:10:13.098481 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 05:10:13.112969 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 05:10:13.144440 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 05:10:13.166114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 05:10:13.167745 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 05:10:13.177275 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 05:10:13.195354 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 05:10:13.206907 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 05:10:13.213311 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 05:10:13.219273 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 05:10:13.222694 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 05:10:13.224008 (MainThread): Parsing macros/etc/query.sql
2021-12-29 05:10:13.224750 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 05:10:13.225931 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 05:10:13.232918 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 05:10:13.234320 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 05:10:13.236190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 05:10:13.237467 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 05:10:13.283375 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 05:10:13.284764 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 05:10:13.285694 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 05:10:13.286733 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 05:10:13.288551 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 05:10:13.289362 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 05:10:13.290488 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 05:10:13.291247 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 05:10:13.296285 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 05:10:13.297291 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 05:10:13.298466 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 05:10:13.300956 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 05:10:13.301780 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 05:10:13.303539 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 05:10:13.312291 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 05:10:13.313784 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 05:10:13.314890 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 05:10:13.315997 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 05:10:13.317265 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 05:10:13.318473 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 05:10:13.319188 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 05:10:13.322113 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 05:10:13.326258 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 05:10:13.329006 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 05:10:13.330423 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 05:10:13.331564 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 05:10:13.333141 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 05:10:13.353669 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 05:10:13.355370 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 05:10:13.357425 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 05:10:13.358658 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 05:10:13.359503 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 05:10:13.360458 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 05:10:13.361310 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 05:10:13.362219 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 05:10:13.363550 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 05:10:13.364816 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 05:10:13.366549 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 05:10:13.368037 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 05:10:13.369276 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 05:10:13.371254 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 05:10:13.372929 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 05:10:13.374039 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 05:10:13.375038 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 05:10:13.377301 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 05:10:13.378867 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 05:10:13.380304 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 05:10:13.382100 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 05:10:13.384325 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 05:10:13.385455 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 05:10:13.388274 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 05:10:13.396202 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 05:10:13.399975 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 05:10:13.401236 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 05:10:13.403943 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 05:10:13.407386 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 05:10:13.410823 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 05:10:13.412187 (MainThread): Parsing macros/sql/star.sql
2021-12-29 05:10:13.415022 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 05:10:13.421389 (MainThread): Parsing macros/sql/union.sql
2021-12-29 05:10:13.428448 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 05:10:13.429524 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 05:10:13.432326 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 05:10:13.433640 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 05:10:13.434931 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 05:10:13.439959 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 05:10:13.444627 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 05:10:13.447956 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 05:10:13.450039 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 05:10:13.799011 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:10:13.810969 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:10:13.814536 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:10:13.817527 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:10:13.823870 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:10:13.827500 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:10:13.843107 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:10:13.847171 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:10:13.856107 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:10:13.858456 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:10:13.910432 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f2e62f-93d2-4c20-8511-3d9073cc125d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff571057a60>]}
2021-12-29 05:10:13.917859 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f2e62f-93d2-4c20-8511-3d9073cc125d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff57072c9a0>]}
2021-12-29 05:10:13.918408 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 05:10:13.919883 (MainThread): 
2021-12-29 05:10:13.920321 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:10:13.921301 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 05:10:13.932941 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 05:10:13.933125 (ThreadPoolExecutor-0_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 05:10:13.933242 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 05:10:14.979579 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 11 in 1.05 seconds
2021-12-29 05:10:14.983749 (ThreadPoolExecutor-0_0): On list_analytics_dbt: Close
2021-12-29 05:10:15.159735 (MainThread): 13:10:15 | Concurrency: 1 threads (target='dev')
2021-12-29 05:10:15.160507 (MainThread): 13:10:15 | 
2021-12-29 05:10:15.165996 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-29 05:10:15.166947 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:10:15.167353 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-29 05:10:15.177654 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 05:10:15.178502 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.178825 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.179325 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-29 05:10:15.179600 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:10:15.180207 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:10:15.180481 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:10:15.184837 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 05:10:15.185429 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.185707 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.186120 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:10:15.186361 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-29 05:10:15.186727 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:10:15.186919 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-29 05:10:15.189781 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 05:10:15.190557 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.190801 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.191189 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-29 05:10:15.191389 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-29 05:10:15.191700 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:10:15.191866 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-29 05:10:15.194520 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 05:10:15.195089 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.195292 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.195644 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-29 05:10:15.195830 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:10:15.196123 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:10:15.196274 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:10:15.199044 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 05:10:15.199739 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.199953 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.200306 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:10:15.200539 (Thread-1): Began running node operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0
2021-12-29 05:10:15.201064 (Thread-1): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:10:15.201243 (Thread-1): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0
2021-12-29 05:10:15.203032 (Thread-1): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0"
2021-12-29 05:10:15.204144 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.204419 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.204902 (Thread-1): Finished running node operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0
2021-12-29 05:10:15.205126 (Thread-1): Began running node operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2021-12-29 05:10:15.205561 (Thread-1): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:10:15.205739 (Thread-1): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2021-12-29 05:10:15.207747 (Thread-1): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2021-12-29 05:10:15.208696 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.209075 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.209662 (Thread-1): Finished running node operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2021-12-29 05:10:15.209933 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:10:15.210348 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:10:15.210492 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:10:15.212733 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 05:10:15.213272 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.213511 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.213819 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:10:15.213981 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 05:10:15.214442 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710".
2021-12-29 05:10:15.214779 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 05:10:15.226778 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710"
2021-12-29 05:10:15.227317 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.227583 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.227909 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_my_first_dbt_model_id.5fb22c2710
2021-12-29 05:10:15.228098 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 05:10:15.228414 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321".
2021-12-29 05:10:15.228576 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 05:10:15.235896 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321"
2021-12-29 05:10:15.236384 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.236566 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.236864 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_my_first_dbt_model_id.16e066b321
2021-12-29 05:10:15.237154 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:10:15.237497 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:10:15.237665 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:10:15.240988 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 05:10:15.241903 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.242204 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.242564 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:10:15.242727 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 05:10:15.242982 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688".
2021-12-29 05:10:15.243219 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 05:10:15.246705 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688"
2021-12-29 05:10:15.247376 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.247686 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.248088 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_snowflake_customer_purchase_c_custkey.bc775ea688
2021-12-29 05:10:15.248245 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 05:10:15.248484 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833".
2021-12-29 05:10:15.248615 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 05:10:15.251697 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833"
2021-12-29 05:10:15.252367 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.252539 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.252817 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_snowflake_customer_purchase_c_custkey.7499dc9833
2021-12-29 05:10:15.252960 (Thread-1): Began running node test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 05:10:15.253394 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778".
2021-12-29 05:10:15.253578 (Thread-1): Compiling test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 05:10:15.256783 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778"
2021-12-29 05:10:15.257245 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.257419 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.257695 (Thread-1): Finished running node test.jrtests_learn_dbt1.not_null_my_second_dbt_model_id.151b76d778
2021-12-29 05:10:15.257842 (Thread-1): Began running node test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 05:10:15.258070 (Thread-1): Acquiring new snowflake connection "test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493".
2021-12-29 05:10:15.258194 (Thread-1): Compiling test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 05:10:15.261221 (Thread-1): Writing injected SQL for node "test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493"
2021-12-29 05:10:15.261767 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.261932 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.262215 (Thread-1): Finished running node test.jrtests_learn_dbt1.unique_my_second_dbt_model_id.57a0f8c493
2021-12-29 05:10:15.262358 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-29 05:10:15.262789 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:10:15.262916 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-29 05:10:15.267219 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 05:10:15.267706 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.267883 (Thread-1): finished collecting timing info
2021-12-29 05:10:15.268167 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-29 05:10:15.269263 (MainThread): Connection 'master' was properly closed.
2021-12-29 05:10:15.269404 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-29 05:10:15.277700 (MainThread): 13:10:15 | Done.
2021-12-29 05:10:15.278029 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5710d0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff57072cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff57160e790>]}
2021-12-29 05:10:15.278279 (MainThread): Flushing usage events
2021-12-29 05:10:24.179703 (MainThread): Running with dbt=0.21.0
2021-12-29 05:10:25.039854 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 05:10:25.042146 (MainThread): Tracking: tracking
2021-12-29 05:10:25.042825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc9cc8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc800a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc800b20>]}
2021-12-29 05:10:25.062258 (MainThread): Partial parsing not enabled
2021-12-29 05:10:25.083161 (MainThread): Parsing macros/catalog.sql
2021-12-29 05:10:25.085505 (MainThread): Parsing macros/adapters.sql
2021-12-29 05:10:25.120183 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 05:10:25.123761 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 05:10:25.127850 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 05:10:25.129048 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 05:10:25.132242 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 05:10:25.140327 (MainThread): Parsing macros/core.sql
2021-12-29 05:10:25.144802 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 05:10:25.151630 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 05:10:25.161523 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 05:10:25.163139 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 05:10:25.179399 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 05:10:25.210682 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 05:10:25.231972 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 05:10:25.233648 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 05:10:25.241887 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 05:10:25.259707 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 05:10:25.271551 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 05:10:25.278658 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 05:10:25.285482 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 05:10:25.289051 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 05:10:25.290425 (MainThread): Parsing macros/etc/query.sql
2021-12-29 05:10:25.291280 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 05:10:25.292625 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 05:10:25.300579 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 05:10:25.302197 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 05:10:25.304358 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 05:10:25.305784 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 05:10:25.358918 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 05:10:25.360533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 05:10:25.361594 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 05:10:25.362785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 05:10:25.364811 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 05:10:25.365962 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 05:10:25.367318 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 05:10:25.368201 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 05:10:25.373410 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 05:10:25.374866 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 05:10:25.376044 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 05:10:25.378604 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 05:10:25.379530 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 05:10:25.381539 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 05:10:25.390991 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 05:10:25.392709 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 05:10:25.394089 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 05:10:25.395424 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 05:10:25.396911 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 05:10:25.398283 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 05:10:25.399133 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 05:10:25.402326 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 05:10:25.407113 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 05:10:25.410315 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 05:10:25.411957 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 05:10:25.413266 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 05:10:25.415022 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 05:10:25.438144 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 05:10:25.439740 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 05:10:25.441789 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 05:10:25.443042 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 05:10:25.443890 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 05:10:25.444824 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 05:10:25.445909 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 05:10:25.446834 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 05:10:25.448166 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 05:10:25.449436 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 05:10:25.451235 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 05:10:25.452709 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 05:10:25.453659 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 05:10:25.455998 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 05:10:25.457699 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 05:10:25.458822 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 05:10:25.459805 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 05:10:25.462045 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 05:10:25.463631 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 05:10:25.465046 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 05:10:25.467241 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 05:10:25.469452 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 05:10:25.470589 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 05:10:25.473763 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 05:10:25.481575 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 05:10:25.485960 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 05:10:25.487237 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 05:10:25.490105 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 05:10:25.493489 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 05:10:25.496334 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 05:10:25.497636 (MainThread): Parsing macros/sql/star.sql
2021-12-29 05:10:25.500518 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 05:10:25.507930 (MainThread): Parsing macros/sql/union.sql
2021-12-29 05:10:25.514780 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 05:10:25.515911 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 05:10:25.518813 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 05:10:25.520163 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 05:10:25.521517 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 05:10:25.526790 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 05:10:25.531648 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 05:10:25.535462 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 05:10:25.537741 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 05:10:25.883808 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:10:25.896020 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:10:25.900285 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:10:25.903414 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:10:25.909797 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:10:25.912732 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:10:25.928067 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:10:25.931975 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:10:25.941159 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:10:25.943393 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:10:25.995399 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4730909-0ebf-4853-8d75-089f8e3147a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc9558b0>]}
2021-12-29 05:10:26.003425 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4730909-0ebf-4853-8d75-089f8e3147a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc82e9a0>]}
2021-12-29 05:10:26.003814 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 05:10:26.005592 (MainThread): 
2021-12-29 05:10:26.006212 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:10:26.007172 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 05:10:26.018157 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 05:10:26.018331 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:10:26.018444 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 05:10:26.938521 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.92 seconds
2021-12-29 05:10:26.941932 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-29 05:10:27.109409 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 05:10:27.122702 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 05:10:27.123024 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 05:10:27.123245 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-29 05:10:27.694648 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.57 seconds
2021-12-29 05:10:27.698794 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-29 05:10:27.867233 (MainThread): 13:10:27 | 
2021-12-29 05:10:27.867774 (MainThread): 13:10:27 | Running 1 on-run-start hook
2021-12-29 05:10:27.868142 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2021-12-29 05:10:27.871495 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2021-12-29 05:10:27.874081 (MainThread): 13:10:27 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2021-12-29 05:10:27.874931 (MainThread): Using snowflake connection "master".
2021-12-29 05:10:27.875195 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2021-12-29 05:10:27.875434 (MainThread): Opening a new connection, currently in state init
2021-12-29 05:10:28.686490 (MainThread): Snowflake query id: 01a143f6-3200-9d8e-0000-00008a25c749
2021-12-29 05:10:28.686853 (MainThread): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'
2021-12-29 05:10:28.687163 (MainThread): Database error while running on-run-start
2021-12-29 05:10:28.687496 (MainThread): On master: Close
2021-12-29 05:10:28.856503 (MainThread): Connection 'master' was properly closed.
2021-12-29 05:10:28.856970 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-12-29 05:10:28.857419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc97eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccf1acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccf1a0a0>]}
2021-12-29 05:10:28.857967 (MainThread): Flushing usage events
2021-12-29 05:10:30.096517 (MainThread): Encountered an error:
2021-12-29 05:10:30.097049 (MainThread): Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'
2021-12-29 05:10:30.102035 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'

2021-12-29 05:19:56.477258 (MainThread): Running with dbt=0.21.0
2021-12-29 05:19:57.336500 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 05:19:57.338471 (MainThread): Tracking: tracking
2021-12-29 05:19:57.339019 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1024ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104809b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104809be0>]}
2021-12-29 05:19:57.358974 (MainThread): Partial parsing not enabled
2021-12-29 05:19:57.380878 (MainThread): Parsing macros/catalog.sql
2021-12-29 05:19:57.383164 (MainThread): Parsing macros/adapters.sql
2021-12-29 05:19:57.418286 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 05:19:57.422057 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 05:19:57.426262 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 05:19:57.427490 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 05:19:57.430413 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 05:19:57.439069 (MainThread): Parsing macros/core.sql
2021-12-29 05:19:57.442522 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 05:19:57.448350 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 05:19:57.457505 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 05:19:57.459002 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 05:19:57.475329 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 05:19:57.507321 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 05:19:57.529016 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 05:19:57.530684 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 05:19:57.540215 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 05:19:57.559690 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 05:19:57.572141 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 05:19:57.579255 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 05:19:57.585893 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 05:19:57.588984 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 05:19:57.590162 (MainThread): Parsing macros/etc/query.sql
2021-12-29 05:19:57.590913 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 05:19:57.592101 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 05:19:57.600230 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 05:19:57.601904 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 05:19:57.604153 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 05:19:57.605621 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 05:19:57.655089 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 05:19:57.656480 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 05:19:57.657416 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 05:19:57.658482 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 05:19:57.660263 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 05:19:57.661100 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 05:19:57.662216 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 05:19:57.663006 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 05:19:57.667637 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 05:19:57.668666 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 05:19:57.669750 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 05:19:57.672007 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 05:19:57.672818 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 05:19:57.674614 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 05:19:57.683758 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 05:19:57.685430 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 05:19:57.686529 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 05:19:57.687667 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 05:19:57.688944 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 05:19:57.690198 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 05:19:57.690931 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 05:19:57.693710 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 05:19:57.697917 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 05:19:57.700730 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 05:19:57.702328 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 05:19:57.703477 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 05:19:57.705000 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 05:19:57.726515 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 05:19:57.728233 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 05:19:57.730305 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 05:19:57.731729 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 05:19:57.732591 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 05:19:57.733543 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 05:19:57.734404 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 05:19:57.735328 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 05:19:57.736672 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 05:19:57.737948 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 05:19:57.739832 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 05:19:57.741322 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 05:19:57.742298 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 05:19:57.744224 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 05:19:57.745929 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 05:19:57.747205 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 05:19:57.748191 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 05:19:57.750453 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 05:19:57.752109 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 05:19:57.753540 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 05:19:57.755437 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 05:19:57.757684 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 05:19:57.759138 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 05:19:57.762028 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 05:19:57.769598 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 05:19:57.773326 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 05:19:57.774596 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 05:19:57.777497 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 05:19:57.781807 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 05:19:57.785316 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 05:19:57.786694 (MainThread): Parsing macros/sql/star.sql
2021-12-29 05:19:57.789639 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 05:19:57.796558 (MainThread): Parsing macros/sql/union.sql
2021-12-29 05:19:57.803846 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 05:19:57.804993 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 05:19:57.808046 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 05:19:57.809434 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 05:19:57.810814 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 05:19:57.816250 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 05:19:57.820769 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 05:19:57.824277 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 05:19:57.826230 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 05:19:58.183516 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:19:58.194764 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:19:58.198739 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:19:58.201808 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:19:58.208528 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:19:58.211586 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:19:58.227131 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:19:58.231106 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:19:58.241105 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:19:58.243612 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:19:58.297232 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fee9adb6-a581-426e-b11f-559ffef0c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104944d30>]}
2021-12-29 05:19:58.304982 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fee9adb6-a581-426e-b11f-559ffef0c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10482c430>]}
2021-12-29 05:19:58.305409 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 05:19:58.306722 (MainThread): 
2021-12-29 05:19:58.307096 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:19:58.308021 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 05:19:58.319281 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 05:19:58.319455 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:19:58.319568 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 05:19:59.091401 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.'
2021-12-29 05:19:59.091813 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:19:59.092048 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-12-29 05:19:59.092358 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-12-29 05:19:59.092575 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-12-29 05:19:59.092857 (ThreadPoolExecutor-0_0): On list_analytics: No close available on handle
2021-12-29 05:19:59.094035 (MainThread): Connection 'master' was properly closed.
2021-12-29 05:19:59.094288 (MainThread): Connection 'list_analytics' was properly closed.
2021-12-29 05:19:59.094589 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104944c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1046e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104971ca0>]}
2021-12-29 05:19:59.094961 (MainThread): Flushing usage events
2021-12-29 05:20:00.501311 (MainThread): Encountered an error:
2021-12-29 05:20:00.501834 (MainThread): Runtime Error
  Database error while listing schemas in database "analytics"
  Database Error
    250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
2021-12-29 05:20:00.509094 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 224, in open
    handle = snowflake.connector.connect(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 50, in Connect
    return SnowflakeConnection(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 273, in __init__
    self.connect(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 484, in connect
    self.__open_connection()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 723, in __open_connection
    self._authenticate(auth_instance)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 984, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1003, in __authenticate
    auth.authenticate(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/auth.py", line 380, in authenticate
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 261, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 102, in list_schemas
    results = self.execute_macro(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 82, in handle
    self._handle.resolve(self)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 108, in resolve
    return self.opener(connection)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 252, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 541, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 518, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 111, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "analytics"
  Database Error
    250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

2021-12-29 05:21:52.845608 (MainThread): Running with dbt=0.21.0
2021-12-29 05:21:53.688962 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 05:21:53.690666 (MainThread): Tracking: tracking
2021-12-29 05:21:53.691134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1664abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe168709ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe168709b50>]}
2021-12-29 05:21:53.709061 (MainThread): Partial parsing not enabled
2021-12-29 05:21:53.731210 (MainThread): Parsing macros/catalog.sql
2021-12-29 05:21:53.733519 (MainThread): Parsing macros/adapters.sql
2021-12-29 05:21:53.768993 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 05:21:53.772591 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 05:21:53.776690 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 05:21:53.777911 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 05:21:53.780859 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 05:21:53.789825 (MainThread): Parsing macros/core.sql
2021-12-29 05:21:53.793753 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 05:21:53.799983 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 05:21:53.809962 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 05:21:53.811678 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 05:21:53.828095 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 05:21:53.859669 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 05:21:53.880913 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 05:21:53.882529 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 05:21:53.892017 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 05:21:53.910522 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 05:21:53.924982 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 05:21:53.932509 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 05:21:53.939310 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 05:21:53.942777 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 05:21:53.944119 (MainThread): Parsing macros/etc/query.sql
2021-12-29 05:21:53.944964 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 05:21:53.946342 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 05:21:53.954553 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 05:21:53.956231 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 05:21:53.958404 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 05:21:53.959817 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 05:21:54.012998 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 05:21:54.014566 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 05:21:54.015643 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 05:21:54.016960 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 05:21:54.019011 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 05:21:54.019958 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 05:21:54.021407 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 05:21:54.022339 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 05:21:54.028291 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 05:21:54.029535 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 05:21:54.030713 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 05:21:54.033276 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 05:21:54.034228 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 05:21:54.036255 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 05:21:54.045686 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 05:21:54.047409 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 05:21:54.048663 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 05:21:54.049949 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 05:21:54.051409 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 05:21:54.052841 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 05:21:54.053772 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 05:21:54.057079 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 05:21:54.061917 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 05:21:54.065128 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 05:21:54.066810 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 05:21:54.068118 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 05:21:54.070019 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 05:21:54.094044 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 05:21:54.096062 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 05:21:54.098756 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 05:21:54.100173 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 05:21:54.101184 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 05:21:54.102249 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 05:21:54.103322 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 05:21:54.104408 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 05:21:54.105948 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 05:21:54.107426 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 05:21:54.109427 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 05:21:54.111129 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 05:21:54.112253 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 05:21:54.114457 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 05:21:54.116397 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 05:21:54.117686 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 05:21:54.118838 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 05:21:54.121612 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 05:21:54.123433 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 05:21:54.125048 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 05:21:54.127062 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 05:21:54.129569 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 05:21:54.130860 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 05:21:54.134098 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 05:21:54.142665 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 05:21:54.148014 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 05:21:54.149583 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 05:21:54.152819 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 05:21:54.156803 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 05:21:54.160467 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 05:21:54.162175 (MainThread): Parsing macros/sql/star.sql
2021-12-29 05:21:54.165558 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 05:21:54.173500 (MainThread): Parsing macros/sql/union.sql
2021-12-29 05:21:54.181292 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 05:21:54.182552 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 05:21:54.186192 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 05:21:54.187731 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 05:21:54.190219 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 05:21:54.196492 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 05:21:54.201473 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 05:21:54.205521 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 05:21:54.207634 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 05:21:54.575396 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:21:54.588078 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:21:54.592125 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:21:54.595653 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:21:54.602990 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:21:54.606955 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:21:54.625032 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:21:54.629508 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:21:54.639701 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:21:54.642596 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:21:54.696478 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '721d170c-b009-41ac-9329-29cb0695e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe169044c40>]}
2021-12-29 05:21:54.703786 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '721d170c-b009-41ac-9329-29cb0695e97f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16872e9d0>]}
2021-12-29 05:21:54.704142 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 05:21:54.705553 (MainThread): 
2021-12-29 05:21:54.706010 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:21:54.707066 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 05:21:54.718379 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 05:21:54.718567 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:21:54.718693 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 05:21:55.424712 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.'
2021-12-29 05:21:55.425175 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:21:55.425425 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-12-29 05:21:55.425742 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-12-29 05:21:55.425963 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-12-29 05:21:55.426248 (ThreadPoolExecutor-0_0): On list_analytics: No close available on handle
2021-12-29 05:21:55.427392 (MainThread): Connection 'master' was properly closed.
2021-12-29 05:21:55.427705 (MainThread): Connection 'list_analytics' was properly closed.
2021-12-29 05:21:55.428070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe169044be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe169044e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16907e310>]}
2021-12-29 05:21:55.428519 (MainThread): Flushing usage events
2021-12-29 05:21:56.702121 (MainThread): Encountered an error:
2021-12-29 05:21:56.702692 (MainThread): Runtime Error
  Database error while listing schemas in database "analytics"
  Database Error
    250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
2021-12-29 05:21:56.707532 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 224, in open
    handle = snowflake.connector.connect(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 50, in Connect
    return SnowflakeConnection(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 273, in __init__
    self.connect(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 484, in connect
    self.__open_connection()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 723, in __open_connection
    self._authenticate(auth_instance)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 984, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1003, in __authenticate
    auth.authenticate(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/auth.py", line 380, in authenticate
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 261, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 102, in list_schemas
    results = self.execute_macro(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 82, in handle
    self._handle.resolve(self)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 108, in resolve
    return self.opener(connection)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 252, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 541, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 518, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 111, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "analytics"
  Database Error
    250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

2021-12-29 05:24:01.131192 (MainThread): Running with dbt=0.21.0
2021-12-29 05:24:02.010484 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-29 05:24:02.012115 (MainThread): Tracking: tracking
2021-12-29 05:24:02.012745 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca94ebf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac009b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac009c10>]}
2021-12-29 05:24:02.032148 (MainThread): Partial parsing not enabled
2021-12-29 05:24:02.053435 (MainThread): Parsing macros/catalog.sql
2021-12-29 05:24:02.055727 (MainThread): Parsing macros/adapters.sql
2021-12-29 05:24:02.092120 (MainThread): Parsing macros/materializations/merge.sql
2021-12-29 05:24:02.095929 (MainThread): Parsing macros/materializations/seed.sql
2021-12-29 05:24:02.100113 (MainThread): Parsing macros/materializations/view.sql
2021-12-29 05:24:02.101368 (MainThread): Parsing macros/materializations/table.sql
2021-12-29 05:24:02.104257 (MainThread): Parsing macros/materializations/incremental.sql
2021-12-29 05:24:02.113378 (MainThread): Parsing macros/core.sql
2021-12-29 05:24:02.116893 (MainThread): Parsing macros/materializations/test.sql
2021-12-29 05:24:02.123808 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-29 05:24:02.133492 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-29 05:24:02.135098 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-29 05:24:02.151904 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-29 05:24:02.184855 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-29 05:24:02.207074 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-29 05:24:02.209062 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-29 05:24:02.220095 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-29 05:24:02.240319 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-29 05:24:02.254415 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-29 05:24:02.261850 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-29 05:24:02.268675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-29 05:24:02.272169 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-29 05:24:02.273528 (MainThread): Parsing macros/etc/query.sql
2021-12-29 05:24:02.274377 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-29 05:24:02.275738 (MainThread): Parsing macros/etc/datetime.sql
2021-12-29 05:24:02.283612 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-29 05:24:02.285232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-29 05:24:02.287435 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-29 05:24:02.289064 (MainThread): Parsing macros/adapters/common.sql
2021-12-29 05:24:02.336963 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-29 05:24:02.338300 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-29 05:24:02.339235 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-29 05:24:02.340276 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-29 05:24:02.342059 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-12-29 05:24:02.343029 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-12-29 05:24:02.344303 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-12-29 05:24:02.345191 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-12-29 05:24:02.349714 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-12-29 05:24:02.350919 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-12-29 05:24:02.351925 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-12-29 05:24:02.354161 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-12-29 05:24:02.354967 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-12-29 05:24:02.356739 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-12-29 05:24:02.365339 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-12-29 05:24:02.366969 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-12-29 05:24:02.368177 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2021-12-29 05:24:02.369337 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-12-29 05:24:02.370634 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-12-29 05:24:02.371909 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-12-29 05:24:02.372618 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-12-29 05:24:02.375397 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-12-29 05:24:02.379924 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-12-29 05:24:02.382681 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-12-29 05:24:02.384118 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-12-29 05:24:02.385257 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-12-29 05:24:02.386926 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-12-29 05:24:02.408030 (MainThread): Parsing macros/web/get_url_host.sql
2021-12-29 05:24:02.409654 (MainThread): Parsing macros/web/get_url_path.sql
2021-12-29 05:24:02.411766 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-12-29 05:24:02.413112 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2021-12-29 05:24:02.413968 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2021-12-29 05:24:02.414886 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2021-12-29 05:24:02.415758 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2021-12-29 05:24:02.416683 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2021-12-29 05:24:02.418001 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-12-29 05:24:02.419355 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-12-29 05:24:02.421088 (MainThread): Parsing macros/schema_tests/recency.sql
2021-12-29 05:24:02.422569 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-12-29 05:24:02.423518 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2021-12-29 05:24:02.425476 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2021-12-29 05:24:02.427140 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-12-29 05:24:02.428276 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-12-29 05:24:02.429251 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-12-29 05:24:02.431529 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-12-29 05:24:02.433259 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-12-29 05:24:02.434682 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2021-12-29 05:24:02.436391 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2021-12-29 05:24:02.439134 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-12-29 05:24:02.440265 (MainThread): Parsing macros/schema_tests/equality.sql
2021-12-29 05:24:02.443084 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-12-29 05:24:02.453461 (MainThread): Parsing macros/sql/date_spine.sql
2021-12-29 05:24:02.458804 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-12-29 05:24:02.460364 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-12-29 05:24:02.463577 (MainThread): Parsing macros/sql/generate_series.sql
2021-12-29 05:24:02.467549 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-12-29 05:24:02.470914 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-12-29 05:24:02.472427 (MainThread): Parsing macros/sql/star.sql
2021-12-29 05:24:02.475719 (MainThread): Parsing macros/sql/unpivot.sql
2021-12-29 05:24:02.483224 (MainThread): Parsing macros/sql/union.sql
2021-12-29 05:24:02.491115 (MainThread): Parsing macros/sql/groupby.sql
2021-12-29 05:24:02.492393 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-12-29 05:24:02.495758 (MainThread): Parsing macros/sql/safe_add.sql
2021-12-29 05:24:02.497276 (MainThread): Parsing macros/sql/nullcheck.sql
2021-12-29 05:24:02.498784 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-12-29 05:24:02.505199 (MainThread): Parsing macros/sql/get_column_values.sql
2021-12-29 05:24:02.510143 (MainThread): Parsing macros/sql/pivot.sql
2021-12-29 05:24:02.514153 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-12-29 05:24:02.516330 (MainThread): Parsing macros/sql/haversine_distance.sql
2021-12-29 05:24:02.867649 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:24:02.878957 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:24:02.882505 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:24:02.885905 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:02.892463 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:24:02.895429 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:02.911561 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:24:02.915538 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:24:02.924061 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2021-12-29 05:24:02.926332 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2021-12-29 05:24:02.984164 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac157340>]}
2021-12-29 05:24:02.992007 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac02f970>]}
2021-12-29 05:24:02.992385 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2021-12-29 05:24:02.993747 (MainThread): 
2021-12-29 05:24:02.994154 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:24:02.995218 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-12-29 05:24:03.008987 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-12-29 05:24:03.009477 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-12-29 05:24:03.009641 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-29 05:24:04.024031 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.01 seconds
2021-12-29 05:24:04.026854 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-12-29 05:24:04.203182 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-12-29 05:24:04.216253 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-12-29 05:24:04.216591 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-12-29 05:24:04.216780 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-29 05:24:04.972858 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.76 seconds
2021-12-29 05:24:04.976538 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-12-29 05:24:05.185950 (MainThread): 13:24:05 | 
2021-12-29 05:24:05.186491 (MainThread): 13:24:05 | Running 1 on-run-start hook
2021-12-29 05:24:05.186865 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2021-12-29 05:24:05.190223 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2021-12-29 05:24:05.192849 (MainThread): 13:24:05 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2021-12-29 05:24:05.193713 (MainThread): Using snowflake connection "master".
2021-12-29 05:24:05.193979 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2021-12-29 05:24:05.194217 (MainThread): Opening a new connection, currently in state init
2021-12-29 05:24:06.685574 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-12-29 05:24:06.686473 (MainThread): Using snowflake connection "master".
2021-12-29 05:24:06.686819 (MainThread): On master: commit;
2021-12-29 05:24:06.794623 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2021-12-29 05:24:06.796938 (MainThread): 13:24:06 | 1 of 1 OK hook: jrtests_learn_dbt1.on-run-start.0.................... [SUCCESS 1 in 1.60s]
2021-12-29 05:24:06.797394 (MainThread): 13:24:06 | 
2021-12-29 05:24:06.797809 (MainThread): On master: Close
2021-12-29 05:24:07.035660 (MainThread): 13:24:07 | Concurrency: 1 threads (target='dev')
2021-12-29 05:24:07.036179 (MainThread): 13:24:07 | 
2021-12-29 05:24:07.038236 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2021-12-29 05:24:07.038804 (Thread-1): 13:24:07 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2021-12-29 05:24:07.039383 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:07.039667 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2021-12-29 05:24:07.049120 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 05:24:07.049902 (Thread-1): finished collecting timing info
2021-12-29 05:24:07.094603 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:07.094849 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-12-29 05:24:07.095031 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:08.388722 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-12-29 05:24:08.406744 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:08.407064 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-12-29 05:24:08.536573 (Thread-1): SQL status: SUCCESS 28 in 0.13 seconds
2021-12-29 05:24:08.546623 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:08.546944 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table analytics.dbt.dates
2021-12-29 05:24:08.651383 (Thread-1): SQL status: SUCCESS 28 in 0.10 seconds
2021-12-29 05:24:08.667858 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:08.668171 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */

    describe table "ANALYTICS"."DBT"."DATES"
2021-12-29 05:24:08.774973 (Thread-1): SQL status: SUCCESS 28 in 0.11 seconds
2021-12-29 05:24:08.810432 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2021-12-29 05:24:08.813014 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:08.813177 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */
begin;
2021-12-29 05:24:08.945352 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-12-29 05:24:08.946434 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:08.946864 (Thread-1): On model.jrtests_learn_dbt1.dates: merge into analytics.dbt.dates as DBT_INTERNAL_DEST
        using analytics.dbt.dates__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.d_date = DBT_INTERNAL_DEST.d_date
        

    
    when matched then update set
        "D_DATE_SK" = DBT_INTERNAL_SOURCE."D_DATE_SK","D_DATE_ID" = DBT_INTERNAL_SOURCE."D_DATE_ID","D_DATE" = DBT_INTERNAL_SOURCE."D_DATE","D_MONTH_SEQ" = DBT_INTERNAL_SOURCE."D_MONTH_SEQ","D_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_WEEK_SEQ","D_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_QUARTER_SEQ","D_YEAR" = DBT_INTERNAL_SOURCE."D_YEAR","D_DOW" = DBT_INTERNAL_SOURCE."D_DOW","D_MOY" = DBT_INTERNAL_SOURCE."D_MOY","D_DOM" = DBT_INTERNAL_SOURCE."D_DOM","D_QOY" = DBT_INTERNAL_SOURCE."D_QOY","D_FY_YEAR" = DBT_INTERNAL_SOURCE."D_FY_YEAR","D_FY_QUARTER_SEQ" = DBT_INTERNAL_SOURCE."D_FY_QUARTER_SEQ","D_FY_WEEK_SEQ" = DBT_INTERNAL_SOURCE."D_FY_WEEK_SEQ","D_DAY_NAME" = DBT_INTERNAL_SOURCE."D_DAY_NAME","D_QUARTER_NAME" = DBT_INTERNAL_SOURCE."D_QUARTER_NAME","D_HOLIDAY" = DBT_INTERNAL_SOURCE."D_HOLIDAY","D_WEEKEND" = DBT_INTERNAL_SOURCE."D_WEEKEND","D_FOLLOWING_HOLIDAY" = DBT_INTERNAL_SOURCE."D_FOLLOWING_HOLIDAY","D_FIRST_DOM" = DBT_INTERNAL_SOURCE."D_FIRST_DOM","D_LAST_DOM" = DBT_INTERNAL_SOURCE."D_LAST_DOM","D_SAME_DAY_LY" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LY","D_SAME_DAY_LQ" = DBT_INTERNAL_SOURCE."D_SAME_DAY_LQ","D_CURRENT_DAY" = DBT_INTERNAL_SOURCE."D_CURRENT_DAY","D_CURRENT_WEEK" = DBT_INTERNAL_SOURCE."D_CURRENT_WEEK","D_CURRENT_MONTH" = DBT_INTERNAL_SOURCE."D_CURRENT_MONTH","D_CURRENT_QUARTER" = DBT_INTERNAL_SOURCE."D_CURRENT_QUARTER","D_CURRENT_YEAR" = DBT_INTERNAL_SOURCE."D_CURRENT_YEAR"
    

    when not matched then insert
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")
    values
        ("D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR")

;
2021-12-29 05:24:09.441040 (Thread-1): SQL status: SUCCESS 0 in 0.49 seconds
2021-12-29 05:24:09.441574 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2021-12-29 05:24:09.441895 (Thread-1): On model.jrtests_learn_dbt1.dates: commit;
2021-12-29 05:24:09.619033 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-12-29 05:24:09.638449 (Thread-1): finished collecting timing info
2021-12-29 05:24:09.638818 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2021-12-29 05:24:09.812985 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac71c520>]}
2021-12-29 05:24:09.813906 (Thread-1): 13:24:09 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.77s]
2021-12-29 05:24:09.814350 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2021-12-29 05:24:09.814763 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:24:09.815289 (Thread-1): 13:24:09 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2021-12-29 05:24:09.816208 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:24:09.816620 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:24:09.822358 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 05:24:09.823169 (Thread-1): finished collecting timing info
2021-12-29 05:24:09.835761 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2021-12-29 05:24:09.837295 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2021-12-29 05:24:09.837509 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-12-29 05:24:09.837673 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:11.079010 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-12-29 05:24:11.082284 (Thread-1): finished collecting timing info
2021-12-29 05:24:11.082741 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2021-12-29 05:24:11.256502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac8d5a00>]}
2021-12-29 05:24:11.257691 (Thread-1): 13:24:11 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.44s]
2021-12-29 05:24:11.258214 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2021-12-29 05:24:11.258634 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2021-12-29 05:24:11.259101 (Thread-1): 13:24:11 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2021-12-29 05:24:11.260040 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:24:11.260319 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2021-12-29 05:24:11.264527 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 05:24:11.265269 (Thread-1): finished collecting timing info
2021-12-29 05:24:11.284043 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2021-12-29 05:24:11.284885 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2021-12-29 05:24:11.285042 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2021-12-29 05:24:11.285175 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:11.966431 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-12-29 05:24:11.969978 (Thread-1): finished collecting timing info
2021-12-29 05:24:11.970440 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2021-12-29 05:24:12.133145 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac812310>]}
2021-12-29 05:24:12.134058 (Thread-1): 13:24:12 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.87s]
2021-12-29 05:24:12.134491 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2021-12-29 05:24:12.134898 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2021-12-29 05:24:12.135410 (Thread-1): 13:24:12 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2021-12-29 05:24:12.136370 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:24:12.136704 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2021-12-29 05:24:12.141459 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 05:24:12.142304 (Thread-1): finished collecting timing info
2021-12-29 05:24:12.145640 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2021-12-29 05:24:12.146717 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2021-12-29 05:24:12.146937 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2021-12-29 05:24:12.147138 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:12.819514 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-12-29 05:24:12.822845 (Thread-1): finished collecting timing info
2021-12-29 05:24:12.823306 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2021-12-29 05:24:12.994179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac8d3a30>]}
2021-12-29 05:24:12.995087 (Thread-1): 13:24:12 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.86s]
2021-12-29 05:24:12.995523 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2021-12-29 05:24:12.995928 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:24:12.996445 (Thread-1): 13:24:12 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2021-12-29 05:24:12.997609 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:24:12.997948 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:24:13.002731 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 05:24:13.003876 (Thread-1): finished collecting timing info
2021-12-29 05:24:13.007345 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2021-12-29 05:24:13.008892 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2021-12-29 05:24:13.009117 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2021-12-29 05:24:13.009326 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:14.969755 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-12-29 05:24:14.973257 (Thread-1): finished collecting timing info
2021-12-29 05:24:14.973717 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2021-12-29 05:24:15.131831 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac8d3c70>]}
2021-12-29 05:24:15.132741 (Thread-1): 13:24:15 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.13s]
2021-12-29 05:24:15.133170 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2021-12-29 05:24:15.133576 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:24:15.134083 (Thread-1): 13:24:15 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2021-12-29 05:24:15.135007 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:24:15.135428 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:24:15.140217 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 05:24:15.141106 (Thread-1): finished collecting timing info
2021-12-29 05:24:15.144548 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2021-12-29 05:24:15.145731 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2021-12-29 05:24:15.145951 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2021-12-29 05:24:15.146150 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:16.711451 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-12-29 05:24:16.714868 (Thread-1): finished collecting timing info
2021-12-29 05:24:16.715332 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2021-12-29 05:24:16.883039 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac80c070>]}
2021-12-29 05:24:16.883979 (Thread-1): 13:24:16 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.75s]
2021-12-29 05:24:16.884429 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2021-12-29 05:24:16.884845 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:24:16.885373 (Thread-1): 13:24:16 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2021-12-29 05:24:16.886081 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:24:16.886405 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:24:16.892312 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 05:24:16.893041 (Thread-1): finished collecting timing info
2021-12-29 05:24:16.897628 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2021-12-29 05:24:16.899455 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2021-12-29 05:24:16.899651 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2021-12-29 05:24:16.899830 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:17.829726 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-12-29 05:24:17.833246 (Thread-1): finished collecting timing info
2021-12-29 05:24:17.833721 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2021-12-29 05:24:18.016079 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac868a00>]}
2021-12-29 05:24:18.017008 (Thread-1): 13:24:18 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.13s]
2021-12-29 05:24:18.017462 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2021-12-29 05:24:18.018700 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2021-12-29 05:24:18.019799 (Thread-1): 13:24:18 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2021-12-29 05:24:18.020895 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:18.021235 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2021-12-29 05:24:18.029473 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 05:24:18.030244 (Thread-1): finished collecting timing info
2021-12-29 05:24:18.035520 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:18.035793 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    

      create or replace temporary table analytics.dbt.target_table__dbt_tmp  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun



  where greatest(r_loaddate,o_loaddate) > (select max(load_date) from analytics.dbt.target_table)


      );
2021-12-29 05:24:18.035993 (Thread-1): Opening a new connection, currently in state closed
2021-12-29 05:24:19.884974 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-12-29 05:24:19.892012 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:19.892436 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table__dbt_tmp
2021-12-29 05:24:20.013340 (Thread-1): SQL status: SUCCESS 8 in 0.12 seconds
2021-12-29 05:24:20.022032 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:20.022406 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table analytics.dbt.target_table
2021-12-29 05:24:20.135704 (Thread-1): SQL status: SUCCESS 6 in 0.11 seconds
2021-12-29 05:24:20.144282 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:20.144604 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */

    describe table "ANALYTICS"."DBT"."TARGET_TABLE"
2021-12-29 05:24:20.240528 (Thread-1): SQL status: SUCCESS 6 in 0.10 seconds
2021-12-29 05:24:20.246159 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2021-12-29 05:24:20.249047 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:20.249321 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */
begin;
2021-12-29 05:24:20.372381 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-12-29 05:24:20.373258 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:20.373733 (Thread-1): On model.jrtests_learn_dbt1.target_table: merge into analytics.dbt.target_table as DBT_INTERNAL_DEST
        using analytics.dbt.target_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.shakey_raw = DBT_INTERNAL_DEST.shakey_raw
        

    
    when matched then update set
        "SHAKEY_RAW" = DBT_INTERNAL_SOURCE."SHAKEY_RAW","C_CUSTKEY" = DBT_INTERNAL_SOURCE."C_CUSTKEY","C_NAME" = DBT_INTERNAL_SOURCE."C_NAME","NATION" = DBT_INTERNAL_SOURCE."NATION","TOTAL_ORDER_PRICE" = DBT_INTERNAL_SOURCE."TOTAL_ORDER_PRICE","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE"
    

    when not matched then insert
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")
    values
        ("SHAKEY_RAW", "C_CUSTKEY", "C_NAME", "NATION", "TOTAL_ORDER_PRICE", "LOAD_DATE")

;
2021-12-29 05:24:22.221488 (Thread-1): SQL status: SUCCESS 99996 in 1.85 seconds
2021-12-29 05:24:22.222268 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2021-12-29 05:24:22.222737 (Thread-1): On model.jrtests_learn_dbt1.target_table: commit;
2021-12-29 05:24:22.548816 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-12-29 05:24:22.552179 (Thread-1): finished collecting timing info
2021-12-29 05:24:22.552788 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2021-12-29 05:24:22.717873 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b65a8-ffdd-4428-b0f5-0cae0be53849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac8b1c10>]}
2021-12-29 05:24:22.718807 (Thread-1): 13:24:22 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 4.70s]
2021-12-29 05:24:22.719305 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2021-12-29 05:24:22.721600 (MainThread): Acquiring new snowflake connection "master".
2021-12-29 05:24:22.721997 (MainThread): 13:24:22 | 
2021-12-29 05:24:22.722302 (MainThread): 13:24:22 | Running 1 on-run-end hook
2021-12-29 05:24:22.722565 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0
2021-12-29 05:24:22.725320 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0"
2021-12-29 05:24:22.726540 (MainThread): 13:24:22 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-end.0................... [RUN]
2021-12-29 05:24:22.727349 (MainThread): Using snowflake connection "master".
2021-12-29 05:24:22.727619 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, end_time) values ('end_process',current_timestamp());
2021-12-29 05:24:22.727815 (MainThread): Opening a new connection, currently in state closed
2021-12-29 05:24:24.390969 (MainThread): SQL status: SUCCESS 1 in 1.66 seconds
2021-12-29 05:24:24.391748 (MainThread): Using snowflake connection "master".
2021-12-29 05:24:24.392191 (MainThread): On master: commit;
2021-12-29 05:24:24.493247 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2021-12-29 05:24:24.495507 (MainThread): 13:24:24 | 1 of 1 OK hook: jrtests_learn_dbt1.on-run-end.0...................... [SUCCESS 1 in 1.77s]
2021-12-29 05:24:24.495964 (MainThread): 13:24:24 | 
2021-12-29 05:24:24.496521 (MainThread): On master: Close
2021-12-29 05:24:24.679044 (MainThread): 13:24:24 | 
2021-12-29 05:24:24.679551 (MainThread): 13:24:24 | Finished running 2 incremental models, 3 table models, 3 view models, 2 hooks in 21.68s.
2021-12-29 05:24:24.679926 (MainThread): Connection 'master' was properly closed.
2021-12-29 05:24:24.680216 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2021-12-29 05:24:24.694196 (MainThread): 
2021-12-29 05:24:24.694529 (MainThread): Completed successfully
2021-12-29 05:24:24.694800 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-29 05:24:24.695076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac84a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcac02fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca94ebf40>]}
2021-12-29 05:24:24.695391 (MainThread): Flushing usage events
2022-01-19 09:51:44.725393 (MainThread): Running with dbt=0.21.0
2022-01-19 09:51:46.644752 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-19 09:51:46.647363 (MainThread): Tracking: tracking
2022-01-19 09:51:46.648029 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc071392b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07370aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07370ab20>]}
2022-01-19 09:51:46.672208 (MainThread): Partial parsing not enabled
2022-01-19 09:51:46.720830 (MainThread): Parsing macros/catalog.sql
2022-01-19 09:51:46.723312 (MainThread): Parsing macros/adapters.sql
2022-01-19 09:51:46.765020 (MainThread): Parsing macros/materializations/merge.sql
2022-01-19 09:51:46.769477 (MainThread): Parsing macros/materializations/seed.sql
2022-01-19 09:51:46.774644 (MainThread): Parsing macros/materializations/view.sql
2022-01-19 09:51:46.776175 (MainThread): Parsing macros/materializations/table.sql
2022-01-19 09:51:46.779541 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-19 09:51:46.787929 (MainThread): Parsing macros/core.sql
2022-01-19 09:51:46.791802 (MainThread): Parsing macros/materializations/test.sql
2022-01-19 09:51:46.799288 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-19 09:51:46.809269 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-19 09:51:46.811126 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-19 09:51:46.829157 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-19 09:51:46.862978 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-19 09:51:46.886317 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-19 09:51:46.888094 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-19 09:51:46.898721 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-19 09:51:46.918473 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-19 09:51:46.931821 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-19 09:51:46.942829 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-19 09:51:46.951353 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-19 09:51:46.955704 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-19 09:51:46.957159 (MainThread): Parsing macros/etc/query.sql
2022-01-19 09:51:46.958075 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-19 09:51:46.959442 (MainThread): Parsing macros/etc/datetime.sql
2022-01-19 09:51:46.968320 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-19 09:51:46.970432 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-19 09:51:46.972963 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-19 09:51:46.974587 (MainThread): Parsing macros/adapters/common.sql
2022-01-19 09:51:47.035478 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-19 09:51:47.037406 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-19 09:51:47.038647 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-19 09:51:47.039886 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-19 09:51:47.042234 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-01-19 09:51:47.043484 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-01-19 09:51:47.044848 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-01-19 09:51:47.045783 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-01-19 09:51:47.052525 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-01-19 09:51:47.054066 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-01-19 09:51:47.055563 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-01-19 09:51:47.058403 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-01-19 09:51:47.059485 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-01-19 09:51:47.062043 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-01-19 09:51:47.072735 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-01-19 09:51:47.074840 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-01-19 09:51:47.076477 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-01-19 09:51:47.078245 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-01-19 09:51:47.080004 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-01-19 09:51:47.081644 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-01-19 09:51:47.082727 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-01-19 09:51:47.086252 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-01-19 09:51:47.091447 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-01-19 09:51:47.095306 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-01-19 09:51:47.097624 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-01-19 09:51:47.099343 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-01-19 09:51:47.101525 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-01-19 09:51:47.128623 (MainThread): Parsing macros/web/get_url_host.sql
2022-01-19 09:51:47.130873 (MainThread): Parsing macros/web/get_url_path.sql
2022-01-19 09:51:47.133369 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-01-19 09:51:47.134887 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-01-19 09:51:47.136056 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-01-19 09:51:47.137306 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-01-19 09:51:47.138350 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-01-19 09:51:47.139531 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-01-19 09:51:47.141469 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-01-19 09:51:47.143430 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-01-19 09:51:47.145930 (MainThread): Parsing macros/schema_tests/recency.sql
2022-01-19 09:51:47.148012 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-01-19 09:51:47.149304 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-01-19 09:51:47.151773 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-01-19 09:51:47.153934 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-01-19 09:51:47.155358 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-01-19 09:51:47.156597 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-01-19 09:51:47.159676 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-01-19 09:51:47.161931 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-01-19 09:51:47.164299 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-01-19 09:51:47.166563 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-01-19 09:51:47.169399 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-01-19 09:51:47.170737 (MainThread): Parsing macros/schema_tests/equality.sql
2022-01-19 09:51:47.174689 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-01-19 09:51:47.184498 (MainThread): Parsing macros/sql/date_spine.sql
2022-01-19 09:51:47.189170 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-01-19 09:51:47.190960 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-01-19 09:51:47.194340 (MainThread): Parsing macros/sql/generate_series.sql
2022-01-19 09:51:47.198422 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-01-19 09:51:47.201917 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-01-19 09:51:47.203573 (MainThread): Parsing macros/sql/star.sql
2022-01-19 09:51:47.206951 (MainThread): Parsing macros/sql/unpivot.sql
2022-01-19 09:51:47.214606 (MainThread): Parsing macros/sql/union.sql
2022-01-19 09:51:47.222811 (MainThread): Parsing macros/sql/groupby.sql
2022-01-19 09:51:47.224209 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-01-19 09:51:47.227833 (MainThread): Parsing macros/sql/safe_add.sql
2022-01-19 09:51:47.229673 (MainThread): Parsing macros/sql/nullcheck.sql
2022-01-19 09:51:47.231228 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-01-19 09:51:47.237727 (MainThread): Parsing macros/sql/get_column_values.sql
2022-01-19 09:51:47.243844 (MainThread): Parsing macros/sql/pivot.sql
2022-01-19 09:51:47.248279 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-01-19 09:51:47.250999 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-01-19 09:51:47.661318 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-01-19 09:51:47.676082 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-01-19 09:51:47.681517 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-01-19 09:51:47.685562 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-01-19 09:51:47.693649 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-01-19 09:51:47.697370 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-01-19 09:51:47.716248 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-01-19 09:51:47.720966 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-01-19 09:51:47.731466 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-01-19 09:51:47.734339 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-01-19 09:51:47.804564 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cb9fc92-7e5d-4000-8334-d98b4a99bd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc073856490>]}
2022-01-19 09:51:47.814279 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cb9fc92-7e5d-4000-8334-d98b4a99bd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07372e9a0>]}
2022-01-19 09:51:47.814693 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-01-19 09:51:47.816239 (MainThread): 
2022-01-19 09:51:47.816669 (MainThread): Acquiring new snowflake connection "master".
2022-01-19 09:51:47.818324 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-01-19 09:51:47.830487 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-01-19 09:51:47.830696 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-01-19 09:51:47.830817 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-19 09:51:48.828663 (ThreadPoolExecutor-1_0): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.'
2022-01-19 09:51:48.829116 (ThreadPoolExecutor-1_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-01-19 09:51:48.829310 (ThreadPoolExecutor-1_0): Rolling back transaction.
2022-01-19 09:51:48.829587 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2022-01-19 09:51:48.829766 (ThreadPoolExecutor-1_0): Rolling back transaction.
2022-01-19 09:51:48.829991 (ThreadPoolExecutor-1_0): On list_analytics_dbt: No close available on handle
2022-01-19 09:51:48.831194 (MainThread): Connection 'master' was properly closed.
2022-01-19 09:51:48.831483 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2022-01-19 09:51:48.831708 (MainThread): ERROR: Database Error
  250001 (08001): Failed to connect to DB: pj87053.ap-southeast-2.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.
2022-01-19 09:51:48.832045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc073843bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07372ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0738561c0>]}
2022-01-19 09:51:48.832522 (MainThread): Flushing usage events
2022-01-19 09:51:54.976848 (MainThread): Running with dbt=0.21.0
2022-01-19 09:51:55.932114 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-01-19 09:51:55.932581 (MainThread): Tracking: tracking
2022-01-19 09:51:55.932789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee15190>]}
2022-01-19 09:51:55.934423 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-6uvovuy3'
2022-01-19 09:51:55.934745 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-01-19 09:51:56.311419 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-01-19 09:51:56.312079 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-19 09:51:56.593760 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-19 09:51:56.624054 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-01-19 09:51:56.955997 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-01-19 09:51:56.956980 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-19 09:51:57.295309 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-19 09:51:57.323259 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-01-19 09:51:57.650308 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-01-19 09:51:57.651074 (MainThread): Installing dbt-labs/dbt_utils@0.7.6
2022-01-19 09:51:58.283414 (MainThread):   Installed from version 0.7.6
2022-01-19 09:51:58.283727 (MainThread):   Updated version available: 0.8.0
2022-01-19 09:51:58.284127 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '7231f20f-0f9a-4df0-a05b-44cbbfe3295e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee15370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee15250>]}
2022-01-19 09:51:58.284541 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-01-19 09:51:58.285251 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee6b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eccacf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6eee418b0>]}
2022-01-19 09:51:58.285539 (MainThread): Flushing usage events
2022-02-23 00:18:40.742809 (MainThread): Running with dbt=0.21.0
2022-02-23 00:18:45.614333 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-02-23 00:18:45.615525 (MainThread): Tracking: tracking
2022-02-23 00:18:45.615835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b643580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8995ebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b605340>]}
2022-02-23 00:18:45.617200 (MainThread): Set downloads directory='/var/folders/tk/l1p_n0tn6fzd6r8gpl36jggh0000gn/T/dbt-downloads-cj1xrqep'
2022-02-23 00:18:45.617504 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-02-23 00:18:45.941549 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-02-23 00:18:45.941898 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-02-23 00:18:46.157447 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-02-23 00:18:46.185511 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-02-23 00:18:46.402724 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-02-23 00:18:46.403338 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-02-23 00:18:46.628539 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-02-23 00:18:46.657147 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-02-23 00:18:46.879613 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-02-23 00:18:46.880366 (MainThread): Installing dbt-labs/dbt_utils@0.7.6
2022-02-23 00:18:48.220770 (MainThread):   Installed from version 0.7.6
2022-02-23 00:18:48.221176 (MainThread):   Updated version available: 0.8.0
2022-02-23 00:18:48.221617 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd10486b5-c7d0-4349-add5-f1f17e8454ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b643580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b682eb0>]}
2022-02-23 00:18:48.222101 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-02-23 00:18:48.223306 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b67fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b67f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa895e416d0>]}
2022-02-23 00:18:48.223853 (MainThread): Flushing usage events
2022-02-23 01:33:03.038615 (MainThread): Running with dbt=0.21.0
2022-02-23 01:33:03.884473 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:33:03.886372 (MainThread): Tracking: tracking
2022-02-23 01:33:03.886933 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9acabfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9cf09cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9cf09d60>]}
2022-02-23 01:33:03.906939 (MainThread): Partial parsing not enabled
2022-02-23 01:33:03.945235 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:33:03.947669 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:33:03.985103 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:33:03.988230 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:33:03.991801 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:33:03.993169 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:33:03.995677 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:33:04.003452 (MainThread): Parsing macros/core.sql
2022-02-23 01:33:04.007378 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:33:04.016653 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:33:04.026738 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:33:04.028553 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:33:04.045350 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:33:04.078180 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:33:04.099806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:33:04.101584 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:33:04.111166 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:33:04.129780 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:33:04.142971 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:33:04.150591 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:33:04.157248 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:33:04.160536 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:33:04.161716 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:33:04.162482 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:33:04.163669 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:33:04.171402 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:33:04.172814 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:33:04.174736 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:33:04.175960 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:33:04.223787 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:33:04.225191 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:33:04.226127 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:33:04.227162 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:33:04.228919 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:33:04.229978 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:33:04.231326 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:33:04.232115 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:33:04.236528 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:33:04.237544 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:33:04.238741 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:33:04.241015 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:33:04.241823 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:33:04.243612 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:33:04.252604 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:33:04.254460 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:33:04.255602 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:33:04.256721 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:33:04.257993 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:33:04.259200 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:33:04.259929 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:33:04.262865 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:33:04.267162 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:33:04.270580 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:33:04.272056 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:33:04.273520 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:33:04.275056 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:33:04.295833 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:33:04.297442 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:33:04.300079 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:33:04.301486 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:33:04.302340 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:33:04.303288 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:33:04.304189 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:33:04.305166 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:33:04.306545 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:33:04.307906 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:33:04.309733 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:33:04.311606 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:33:04.312742 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:33:04.314795 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:33:04.316550 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:33:04.317938 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:33:04.319102 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:33:04.321584 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:33:04.323273 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:33:04.324779 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:33:04.326598 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:33:04.329024 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:33:04.330421 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:33:04.333578 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:33:04.341388 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:33:04.345239 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:33:04.346514 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:33:04.349385 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:33:04.352784 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:33:04.355617 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:33:04.356916 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:33:04.359942 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:33:04.366329 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:33:04.373049 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:33:04.374112 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:33:04.376855 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:33:04.378153 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:33:04.379431 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:33:04.384442 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:33:04.388851 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:33:04.392124 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:33:04.393961 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:33:04.737300 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:33:04.748493 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:33:04.752152 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:33:04.755147 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:33:04.761807 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:33:04.764912 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:33:04.779935 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:33:04.783954 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:33:04.792637 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:33:04.794974 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:33:04.855132 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e67e4d93-fd77-4f5a-8719-e1dd850bf412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9d047f40>]}
2022-02-23 01:33:04.870330 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e67e4d93-fd77-4f5a-8719-e1dd850bf412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9cf28cd0>]}
2022-02-23 01:33:04.870871 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:33:04.873032 (MainThread): 
2022-02-23 01:33:04.873512 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:33:04.875088 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:33:04.892841 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:33:04.893126 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:33:04.893349 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:33:05.880849 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.99 seconds
2022-02-23 01:33:05.884699 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:33:06.051692 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:33:06.052099 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:33:06.052334 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2022-02-23 01:33:06.058361 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2022-02-23 01:33:06.058595 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2022-02-23 01:33:06.058728 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-02-23 01:33:06.975478 (ThreadPoolExecutor-0_0): Snowflake query id: 01a27e1d-3200-b451-0000-0000a34d11e1
2022-02-23 01:33:06.975859 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2022-02-23 01:33:06.976202 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2022-02-23 01:33:06.976433 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-02-23 01:33:06.976707 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2022-02-23 01:33:07.140533 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:33:07.140998 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2022-02-23 01:33:07.141483 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9d047cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9d047f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd9d096760>]}
2022-02-23 01:33:07.142038 (MainThread): Flushing usage events
2022-02-23 01:33:08.527081 (MainThread): Encountered an error:
2022-02-23 01:33:08.527639 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2022-02-23 01:33:08.536534 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    create_future.result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in create_schema
    adapter.create_schema(relation)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2022-02-23 01:35:08.777623 (MainThread): Running with dbt=0.21.0
2022-02-23 01:35:09.665771 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:35:09.667295 (MainThread): Tracking: tracking
2022-02-23 01:35:09.667851 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70e3bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710805bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710805c40>]}
2022-02-23 01:35:09.686275 (MainThread): Partial parsing not enabled
2022-02-23 01:35:09.707470 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:35:09.709870 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:35:09.750485 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:35:09.754740 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:35:09.759537 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:35:09.760961 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:35:09.763983 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:35:09.772528 (MainThread): Parsing macros/core.sql
2022-02-23 01:35:09.776780 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:35:09.783791 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:35:09.793632 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:35:09.795316 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:35:09.812571 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:35:09.844932 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:35:09.866703 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:35:09.868471 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:35:09.878018 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:35:09.896711 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:35:09.908748 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:35:09.915378 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:35:09.921365 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:35:09.924587 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:35:09.925949 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:35:09.926733 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:35:09.927930 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:35:09.935585 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:35:09.937499 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:35:09.939697 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:35:09.941266 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:35:09.991565 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:35:09.993105 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:35:09.994050 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:35:09.995092 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:35:09.996876 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:35:09.997705 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:35:09.998837 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:35:09.999612 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:35:10.005200 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:35:10.006401 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:35:10.007445 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:35:10.009866 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:35:10.010700 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:35:10.012506 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:35:10.022920 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:35:10.024745 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:35:10.026092 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:35:10.027411 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:35:10.028943 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:35:10.030383 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:35:10.031257 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:35:10.034480 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:35:10.040589 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:35:10.044263 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:35:10.046033 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:35:10.047419 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:35:10.049205 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:35:10.073981 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:35:10.076851 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:35:10.079388 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:35:10.080856 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:35:10.081914 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:35:10.083023 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:35:10.084025 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:35:10.085144 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:35:10.086703 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:35:10.088199 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:35:10.090261 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:35:10.092068 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:35:10.093217 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:35:10.095807 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:35:10.097849 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:35:10.099165 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:35:10.100348 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:35:10.102982 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:35:10.104859 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:35:10.106546 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:35:10.108649 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:35:10.111246 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:35:10.112570 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:35:10.115899 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:35:10.124458 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:35:10.128920 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:35:10.130436 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:35:10.133643 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:35:10.137727 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:35:10.141085 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:35:10.142577 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:35:10.145812 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:35:10.152323 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:35:10.159946 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:35:10.161058 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:35:10.163921 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:35:10.165217 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:35:10.166545 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:35:10.171737 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:35:10.177231 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:35:10.180713 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:35:10.182658 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:35:10.515001 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:35:10.525985 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:35:10.529683 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:35:10.532856 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:35:10.539812 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:35:10.542910 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:35:10.559516 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:35:10.563660 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:35:10.572369 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:35:10.574673 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:35:10.626732 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e906400-e642-49a5-9285-4c37917d9d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710943dc0>]}
2022-02-23 01:35:10.635401 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e906400-e642-49a5-9285-4c37917d9d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb71082d460>]}
2022-02-23 01:35:10.635721 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:35:10.637225 (MainThread): 
2022-02-23 01:35:10.637642 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:35:10.639144 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:35:10.654286 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:35:10.654534 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:35:10.654666 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:35:11.734021 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.08 seconds
2022-02-23 01:35:11.735560 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:35:11.904257 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:35:11.904571 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:35:11.904759 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2022-02-23 01:35:11.909862 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2022-02-23 01:35:11.910044 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2022-02-23 01:35:11.910166 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-02-23 01:35:12.704097 (ThreadPoolExecutor-0_0): Snowflake query id: 01a27e1f-3200-b451-0000-0000a34d1201
2022-02-23 01:35:12.704561 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2022-02-23 01:35:12.704998 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2022-02-23 01:35:12.705315 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-02-23 01:35:12.705673 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2022-02-23 01:35:12.887792 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:35:12.888279 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2022-02-23 01:35:12.888754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710943ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710943c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7107e0c10>]}
2022-02-23 01:35:12.889312 (MainThread): Flushing usage events
2022-02-23 01:35:14.233274 (MainThread): Encountered an error:
2022-02-23 01:35:14.233864 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2022-02-23 01:35:14.237416 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    create_future.result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/devanand/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in create_schema
    adapter.create_schema(relation)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2022-02-23 01:39:49.153984 (MainThread): Running with dbt=0.21.0
2022-02-23 01:39:50.011456 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:39:50.013826 (MainThread): Tracking: tracking
2022-02-23 01:39:50.014354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac7ccdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca747bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca747c70>]}
2022-02-23 01:39:50.034829 (MainThread): Partial parsing not enabled
2022-02-23 01:39:50.056201 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:39:50.058573 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:39:50.093311 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:39:50.096953 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:39:50.101342 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:39:50.102585 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:39:50.105472 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:39:50.113445 (MainThread): Parsing macros/core.sql
2022-02-23 01:39:50.116794 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:39:50.122904 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:39:50.131799 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:39:50.133324 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:39:50.147972 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:39:50.175675 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:39:50.194606 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:39:50.196058 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:39:50.206090 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:39:50.225118 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:39:50.238279 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:39:50.246088 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:39:50.253055 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:39:50.256963 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:39:50.258561 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:39:50.259456 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:39:50.260820 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:39:50.268701 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:39:50.270778 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:39:50.273005 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:39:50.274658 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:39:50.326900 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:39:50.328528 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:39:50.329614 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:39:50.330826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:39:50.332921 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:39:50.333909 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:39:50.335205 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:39:50.336111 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:39:50.341267 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:39:50.342497 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:39:50.343668 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:39:50.346231 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:39:50.347164 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:39:50.349191 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:39:50.358692 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:39:50.360438 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:39:50.361687 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:39:50.362982 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:39:50.364438 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:39:50.365954 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:39:50.366935 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:39:50.370948 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:39:50.376670 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:39:50.380053 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:39:50.381958 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:39:50.383367 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:39:50.385156 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:39:50.408848 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:39:50.410755 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:39:50.413280 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:39:50.414800 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:39:50.415789 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:39:50.416856 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:39:50.417870 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:39:50.418934 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:39:50.420546 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:39:50.421847 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:39:50.423704 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:39:50.425451 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:39:50.426454 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:39:50.428376 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:39:50.430068 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:39:50.431185 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:39:50.432170 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:39:50.434434 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:39:50.436017 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:39:50.437417 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:39:50.439253 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:39:50.441790 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:39:50.442954 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:39:50.445881 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:39:50.453496 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:39:50.457429 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:39:50.458810 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:39:50.461549 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:39:50.464994 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:39:50.467849 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:39:50.469173 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:39:50.471999 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:39:50.478794 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:39:50.485550 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:39:50.486625 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:39:50.489443 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:39:50.490997 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:39:50.492410 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:39:50.497602 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:39:50.501995 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:39:50.506904 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:39:50.509215 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:39:50.861361 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:39:50.872347 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:39:50.875974 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:39:50.878998 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:39:50.885660 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:39:50.889001 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:39:50.903572 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '5878d054-cde1-4c23-b31a-8e134be0eeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca90d3d0>]}
2022-02-23 01:39:50.904553 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:39:50.908542 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:39:50.917351 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:39:50.919624 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:39:50.976329 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5878d054-cde1-4c23-b31a-8e134be0eeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca887a00>]}
2022-02-23 01:39:50.984546 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5878d054-cde1-4c23-b31a-8e134be0eeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca76dcd0>]}
2022-02-23 01:39:50.984918 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:39:50.986416 (MainThread): 
2022-02-23 01:39:50.986901 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:39:50.988577 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:39:51.003225 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:39:51.003480 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:39:51.003621 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:39:52.006981 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.00 seconds
2022-02-23 01:39:52.010425 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:39:52.176868 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:39:52.177348 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2022-02-23 01:39:52.177631 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2022-02-23 01:39:52.184116 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2022-02-23 01:39:52.184368 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2022-02-23 01:39:52.184538 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-02-23 01:39:52.753862 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.57 seconds
2022-02-23 01:39:52.756256 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2022-02-23 01:39:52.961189 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-02-23 01:39:52.973311 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-02-23 01:39:52.973654 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-02-23 01:39:52.973890 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-23 01:39:53.566552 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.59 seconds
2022-02-23 01:39:53.569610 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2022-02-23 01:39:53.743218 (MainThread): 09:39:53 | 
2022-02-23 01:39:53.743811 (MainThread): 09:39:53 | Running 1 on-run-start hook
2022-02-23 01:39:53.744170 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2022-02-23 01:39:53.748178 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2022-02-23 01:39:53.751635 (MainThread): 09:39:53 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2022-02-23 01:39:53.753173 (MainThread): Using snowflake connection "master".
2022-02-23 01:39:53.753630 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2022-02-23 01:39:53.754103 (MainThread): Opening a new connection, currently in state init
2022-02-23 01:39:54.352317 (MainThread): Snowflake query id: 01a27e23-3200-b451-0000-0000a34d1285
2022-02-23 01:39:54.352835 (MainThread): Snowflake error: 002003 (42S02): SQL compilation error:
Table 'ANALYTICS.DBT.AUDIT_TABLE' does not exist or not authorized.
2022-02-23 01:39:54.353245 (MainThread): Database error while running on-run-start
2022-02-23 01:39:54.353671 (MainThread): On master: Close
2022-02-23 01:39:54.527121 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:39:54.527630 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2022-02-23 01:39:54.528114 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca895220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acae65b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acada7b80>]}
2022-02-23 01:39:54.528681 (MainThread): Flushing usage events
2022-02-23 01:39:55.985395 (MainThread): Encountered an error:
2022-02-23 01:39:55.985966 (MainThread): Database Error
  002003 (42S02): SQL compilation error:
  Table 'ANALYTICS.DBT.AUDIT_TABLE' does not exist or not authorized.
2022-02-23 01:39:55.987711 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Table 'ANALYTICS.DBT.AUDIT_TABLE' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (42S02): SQL compilation error:
  Table 'ANALYTICS.DBT.AUDIT_TABLE' does not exist or not authorized.

2022-02-23 01:41:02.554245 (MainThread): Running with dbt=0.21.0
2022-02-23 01:41:03.435853 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:41:03.437460 (MainThread): Tracking: tracking
2022-02-23 01:41:03.437930 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7884c8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a747b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a747c40>]}
2022-02-23 01:41:03.458128 (MainThread): Partial parsing not enabled
2022-02-23 01:41:03.479702 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:41:03.482022 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:41:03.517387 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:41:03.521043 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:41:03.525339 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:41:03.526634 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:41:03.529545 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:41:03.537636 (MainThread): Parsing macros/core.sql
2022-02-23 01:41:03.541126 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:41:03.547289 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:41:03.555851 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:41:03.557308 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:41:03.571668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:41:03.600666 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:41:03.622172 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:41:03.623775 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:41:03.633589 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:41:03.652644 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:41:03.665936 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:41:03.673353 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:41:03.680263 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:41:03.683817 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:41:03.685391 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:41:03.686274 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:41:03.687667 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:41:03.696000 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:41:03.697773 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:41:03.699981 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:41:03.701437 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:41:03.747848 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:41:03.749194 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:41:03.750118 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:41:03.751151 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:41:03.753260 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:41:03.754201 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:41:03.755508 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:41:03.756308 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:41:03.760816 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:41:03.762475 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:41:03.763594 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:41:03.765885 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:41:03.766720 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:41:03.768519 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:41:03.777004 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:41:03.778487 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:41:03.779599 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:41:03.780708 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:41:03.782024 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:41:03.783969 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:41:03.785342 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:41:03.788296 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:41:03.792847 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:41:03.796095 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:41:03.797797 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:41:03.799143 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:41:03.800966 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:41:03.824807 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:41:03.826765 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:41:03.829168 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:41:03.830614 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:41:03.831607 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:41:03.832669 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:41:03.833756 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:41:03.835335 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:41:03.837338 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:41:03.838981 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:41:03.840744 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:41:03.842359 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:41:03.843350 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:41:03.845303 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:41:03.847008 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:41:03.848140 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:41:03.849527 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:41:03.851879 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:41:03.853499 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:41:03.855281 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:41:03.857049 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:41:03.859293 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:41:03.860438 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:41:03.863441 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:41:03.871172 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:41:03.876098 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:41:03.877820 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:41:03.880765 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:41:03.884426 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:41:03.887873 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:41:03.889923 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:41:03.893353 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:41:03.900297 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:41:03.908087 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:41:03.909483 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:41:03.912510 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:41:03.913997 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:41:03.915527 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:41:03.922953 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:41:03.928294 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:41:03.932243 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:41:03.934388 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:41:04.282658 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:41:04.294281 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:41:04.298320 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:41:04.302459 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:41:04.309626 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:41:04.312948 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:41:04.329073 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:41:04.333398 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:41:04.342628 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:41:04.345065 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:41:04.397430 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26fe22ab-cc47-45ad-b081-eab3b307c6ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a884ee0>]}
2022-02-23 01:41:04.405445 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26fe22ab-cc47-45ad-b081-eab3b307c6ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a76dc70>]}
2022-02-23 01:41:04.405914 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:41:04.407641 (MainThread): 
2022-02-23 01:41:04.408148 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:41:04.409968 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:41:04.428257 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:41:04.428520 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:41:04.428718 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:41:05.407955 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.98 seconds
2022-02-23 01:41:05.411312 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:41:05.581463 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-02-23 01:41:05.595499 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-02-23 01:41:05.595827 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-02-23 01:41:05.596046 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-23 01:41:06.429723 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.83 seconds
2022-02-23 01:41:06.433089 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2022-02-23 01:41:06.617520 (MainThread): 09:41:06 | 
2022-02-23 01:41:06.618102 (MainThread): 09:41:06 | Running 1 on-run-start hook
2022-02-23 01:41:06.618513 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2022-02-23 01:41:06.622459 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2022-02-23 01:41:06.625460 (MainThread): 09:41:06 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2022-02-23 01:41:06.626822 (MainThread): Using snowflake connection "master".
2022-02-23 01:41:06.627350 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2022-02-23 01:41:06.627917 (MainThread): Opening a new connection, currently in state init
2022-02-23 01:41:07.206283 (MainThread): Snowflake query id: 01a27e25-3200-b451-0000-0000a34d1299
2022-02-23 01:41:07.206522 (MainThread): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:41:07.206703 (MainThread): Database error while running on-run-start
2022-02-23 01:41:07.206905 (MainThread): On master: Close
2022-02-23 01:41:07.381398 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:41:07.381930 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2022-02-23 01:41:07.382433 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a895040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78af58430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78af58ee0>]}
2022-02-23 01:41:07.383073 (MainThread): Flushing usage events
2022-02-23 01:41:08.663287 (MainThread): Encountered an error:
2022-02-23 01:41:08.663883 (MainThread): Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:41:08.665703 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'

2022-02-23 01:42:14.762248 (MainThread): Running with dbt=0.21.0
2022-02-23 01:42:15.649355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:42:15.651289 (MainThread): Tracking: tracking
2022-02-23 01:42:15.651964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cdca1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0602c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0602cd0>]}
2022-02-23 01:42:15.671702 (MainThread): Partial parsing not enabled
2022-02-23 01:42:15.693828 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:42:15.696106 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:42:15.730374 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:42:15.733973 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:42:15.738072 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:42:15.739319 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:42:15.742158 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:42:15.750121 (MainThread): Parsing macros/core.sql
2022-02-23 01:42:15.753199 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:42:15.758780 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:42:15.766949 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:42:15.768379 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:42:15.782996 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:42:15.810241 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:42:15.829351 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:42:15.831051 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:42:15.839457 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:42:15.855918 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:42:15.867339 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:42:15.873857 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:42:15.879981 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:42:15.883036 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:42:15.884210 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:42:15.884955 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:42:15.886157 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:42:15.892948 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:42:15.894354 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:42:15.896652 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:42:15.897892 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:42:15.945215 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:42:15.946648 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:42:15.947597 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:42:15.948635 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:42:15.950419 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:42:15.951250 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:42:15.952357 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:42:15.953134 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:42:15.957756 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:42:15.958756 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:42:15.959768 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:42:15.962006 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:42:15.963257 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:42:15.965178 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:42:15.973644 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:42:15.975287 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:42:15.976497 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:42:15.977707 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:42:15.978995 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:42:15.980487 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:42:15.981298 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:42:15.984187 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:42:15.988500 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:42:15.991284 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:42:15.992723 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:42:15.994782 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:42:15.996509 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:42:16.020664 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:42:16.022383 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:42:16.024470 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:42:16.025718 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:42:16.026797 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:42:16.028216 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:42:16.029112 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:42:16.030178 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:42:16.031694 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:42:16.033230 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:42:16.035248 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:42:16.036966 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:42:16.038167 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:42:16.040425 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:42:16.042370 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:42:16.043665 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:42:16.044804 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:42:16.047380 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:42:16.049215 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:42:16.050876 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:42:16.053498 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:42:16.056768 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:42:16.058127 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:42:16.061434 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:42:16.069970 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:42:16.074253 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:42:16.075719 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:42:16.078869 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:42:16.082793 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:42:16.086066 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:42:16.087568 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:42:16.090821 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:42:16.098343 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:42:16.106331 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:42:16.107614 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:42:16.110638 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:42:16.111952 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:42:16.113251 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:42:16.118291 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:42:16.123563 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:42:16.127678 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:42:16.129763 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:42:16.469365 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:42:16.481279 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:42:16.485061 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:42:16.488767 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:42:16.498026 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:42:16.501803 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:42:16.519961 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:42:16.524647 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:42:16.534591 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:42:16.537312 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:42:16.589935 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e8e053d-9a96-464b-9f98-be8185142c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0747e80>]}
2022-02-23 01:42:16.597978 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e8e053d-9a96-464b-9f98-be8185142c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0627d30>]}
2022-02-23 01:42:16.598362 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:42:16.599922 (MainThread): 
2022-02-23 01:42:16.600399 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:42:16.602121 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:42:16.619034 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:42:16.619229 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:42:16.619347 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:42:17.483658 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2022-02-23 01:42:17.487025 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:42:17.660600 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-02-23 01:42:17.674224 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-02-23 01:42:17.674524 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-02-23 01:42:17.674745 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-23 01:42:18.245585 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.57 seconds
2022-02-23 01:42:18.248967 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2022-02-23 01:42:18.415156 (MainThread): 09:42:18 | 
2022-02-23 01:42:18.415765 (MainThread): 09:42:18 | Running 1 on-run-start hook
2022-02-23 01:42:18.416233 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2022-02-23 01:42:18.419995 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2022-02-23 01:42:18.422853 (MainThread): 09:42:18 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2022-02-23 01:42:18.424020 (MainThread): Using snowflake connection "master".
2022-02-23 01:42:18.424668 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2022-02-23 01:42:18.425293 (MainThread): Opening a new connection, currently in state init
2022-02-23 01:42:19.027437 (MainThread): Snowflake query id: 01a27e26-3200-b449-0000-0000a34d228d
2022-02-23 01:42:19.027769 (MainThread): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:42:19.028045 (MainThread): Database error while running on-run-start
2022-02-23 01:42:19.028335 (MainThread): On master: Close
2022-02-23 01:42:19.199134 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:42:19.199607 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2022-02-23 01:42:19.200083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0755280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0f44f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d0f44ee0>]}
2022-02-23 01:42:19.200647 (MainThread): Flushing usage events
2022-02-23 01:42:20.651468 (MainThread): Encountered an error:
2022-02-23 01:42:20.652037 (MainThread): Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:42:20.653707 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'

2022-02-23 01:43:43.336212 (MainThread): Running with dbt=0.21.0
2022-02-23 01:43:44.204949 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:43:44.207040 (MainThread): Tracking: tracking
2022-02-23 01:43:44.207662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46abcdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46cf0ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46cf0abe0>]}
2022-02-23 01:43:44.227163 (MainThread): Partial parsing not enabled
2022-02-23 01:43:44.248826 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:43:44.251435 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:43:44.286899 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:43:44.290681 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:43:44.294890 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:43:44.296458 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:43:44.299369 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:43:44.307473 (MainThread): Parsing macros/core.sql
2022-02-23 01:43:44.310617 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:43:44.316629 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:43:44.325155 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:43:44.326602 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:43:44.341325 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:43:44.370574 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:43:44.389469 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:43:44.390989 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:43:44.399932 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:43:44.417729 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:43:44.430543 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:43:44.437649 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:43:44.444094 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:43:44.447165 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:43:44.448352 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:43:44.449217 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:43:44.450577 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:43:44.457548 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:43:44.458956 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:43:44.460856 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:43:44.462086 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:43:44.510005 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:43:44.511526 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:43:44.512481 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:43:44.513521 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:43:44.515398 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:43:44.516748 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:43:44.518144 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:43:44.518935 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:43:44.523735 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:43:44.524815 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:43:44.526048 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:43:44.528595 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:43:44.529423 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:43:44.531538 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:43:44.541424 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:43:44.543174 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:43:44.544824 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:43:44.546187 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:43:44.547795 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:43:44.549310 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:43:44.550283 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:43:44.553508 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:43:44.558334 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:43:44.561546 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:43:44.563217 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:43:44.564762 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:43:44.566853 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:43:44.590552 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:43:44.592644 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:43:44.594846 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:43:44.596178 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:43:44.597089 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:43:44.598076 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:43:44.598991 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:43:44.600192 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:43:44.601648 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:43:44.602999 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:43:44.604812 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:43:44.606407 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:43:44.607430 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:43:44.609476 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:43:44.611350 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:43:44.612541 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:43:44.613584 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:43:44.616051 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:43:44.617869 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:43:44.619375 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:43:44.621212 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:43:44.623552 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:43:44.624748 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:43:44.627835 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:43:44.636375 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:43:44.640322 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:43:44.641662 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:43:44.644460 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:43:44.648468 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:43:44.651539 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:43:44.653028 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:43:44.655908 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:43:44.662323 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:43:44.669207 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:43:44.670471 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:43:44.673976 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:43:44.675730 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:43:44.677986 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:43:44.684706 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:43:44.689724 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:43:44.693397 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:43:44.696028 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:43:45.037996 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:43:45.050906 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:43:45.055305 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:43:45.059140 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:43:45.066568 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:43:45.070073 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:43:45.085724 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '7771dea5-c3c4-4779-bf70-607840df3b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46d0b1370>]}
2022-02-23 01:43:45.086799 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:43:45.091158 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:43:45.101003 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:43:45.103609 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:43:45.158124 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7771dea5-c3c4-4779-bf70-607840df3b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46d056940>]}
2022-02-23 01:43:45.167190 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7771dea5-c3c4-4779-bf70-607840df3b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46cf2d430>]}
2022-02-23 01:43:45.167553 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:43:45.169040 (MainThread): 
2022-02-23 01:43:45.169469 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:43:45.171009 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:43:45.188815 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:43:45.189046 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:43:45.189204 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:43:46.106780 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.92 seconds
2022-02-23 01:43:46.110261 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:43:46.286800 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-02-23 01:43:46.296716 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-02-23 01:43:46.297019 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-02-23 01:43:46.297189 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-23 01:43:47.087246 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.79 seconds
2022-02-23 01:43:47.090488 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2022-02-23 01:43:47.263939 (MainThread): 09:43:47 | 
2022-02-23 01:43:47.264528 (MainThread): 09:43:47 | Running 1 on-run-start hook
2022-02-23 01:43:47.264947 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2022-02-23 01:43:47.268804 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2022-02-23 01:43:47.272012 (MainThread): 09:43:47 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2022-02-23 01:43:47.273221 (MainThread): Using snowflake connection "master".
2022-02-23 01:43:47.274189 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2022-02-23 01:43:47.274743 (MainThread): Opening a new connection, currently in state init
2022-02-23 01:43:47.849052 (MainThread): Snowflake query id: 01a27e27-3200-b451-0000-0000a34d12c9
2022-02-23 01:43:47.849517 (MainThread): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:43:47.849921 (MainThread): Database error while running on-run-start
2022-02-23 01:43:47.850348 (MainThread): On master: Close
2022-02-23 01:43:48.019815 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:43:48.020219 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2022-02-23 01:43:48.020612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46cee01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46d71bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46d71b1c0>]}
2022-02-23 01:43:48.021073 (MainThread): Flushing usage events
2022-02-23 01:43:49.535293 (MainThread): Encountered an error:
2022-02-23 01:43:49.535858 (MainThread): Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'
2022-02-23 01:43:49.537517 (MainThread): Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 183, in exception_handler
    yield
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'AUDIT_TABLE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/devanand/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/devanand/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'AUDIT_TABLE'

2022-02-23 01:45:23.116536 (MainThread): Running with dbt=0.21.0
2022-02-23 01:45:24.001258 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/devanand/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-23 01:45:24.002891 (MainThread): Tracking: tracking
2022-02-23 01:45:24.003410 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa304cebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307700b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307700c10>]}
2022-02-23 01:45:24.023395 (MainThread): Partial parsing not enabled
2022-02-23 01:45:24.046931 (MainThread): Parsing macros/catalog.sql
2022-02-23 01:45:24.049374 (MainThread): Parsing macros/adapters.sql
2022-02-23 01:45:24.085018 (MainThread): Parsing macros/materializations/merge.sql
2022-02-23 01:45:24.088730 (MainThread): Parsing macros/materializations/seed.sql
2022-02-23 01:45:24.092974 (MainThread): Parsing macros/materializations/view.sql
2022-02-23 01:45:24.094243 (MainThread): Parsing macros/materializations/table.sql
2022-02-23 01:45:24.097175 (MainThread): Parsing macros/materializations/incremental.sql
2022-02-23 01:45:24.105424 (MainThread): Parsing macros/core.sql
2022-02-23 01:45:24.108673 (MainThread): Parsing macros/materializations/test.sql
2022-02-23 01:45:24.114406 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-23 01:45:24.122924 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-23 01:45:24.124363 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-23 01:45:24.139797 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-23 01:45:24.171084 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-23 01:45:24.192622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-23 01:45:24.194329 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-23 01:45:24.204539 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-23 01:45:24.223844 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-23 01:45:24.235942 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-23 01:45:24.242499 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-23 01:45:24.248461 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-23 01:45:24.253088 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-23 01:45:24.255000 (MainThread): Parsing macros/etc/query.sql
2022-02-23 01:45:24.256349 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-23 01:45:24.257987 (MainThread): Parsing macros/etc/datetime.sql
2022-02-23 01:45:24.265252 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-23 01:45:24.266791 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-23 01:45:24.269189 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-23 01:45:24.270657 (MainThread): Parsing macros/adapters/common.sql
2022-02-23 01:45:24.322969 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-23 01:45:24.324630 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-23 01:45:24.325856 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-23 01:45:24.327066 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-23 01:45:24.329144 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-02-23 01:45:24.330107 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-02-23 01:45:24.331408 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-02-23 01:45:24.332325 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 01:45:24.337652 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 01:45:24.338902 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-02-23 01:45:24.340101 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 01:45:24.342706 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-02-23 01:45:24.343663 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-02-23 01:45:24.345729 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-02-23 01:45:24.355508 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 01:45:24.357270 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-02-23 01:45:24.358543 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 01:45:24.359850 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-02-23 01:45:24.361334 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-02-23 01:45:24.362737 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-02-23 01:45:24.363572 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 01:45:24.366818 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 01:45:24.371879 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-02-23 01:45:24.375157 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-02-23 01:45:24.376825 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 01:45:24.378163 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 01:45:24.379954 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 01:45:24.401615 (MainThread): Parsing macros/web/get_url_host.sql
2022-02-23 01:45:24.403321 (MainThread): Parsing macros/web/get_url_path.sql
2022-02-23 01:45:24.405414 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-02-23 01:45:24.406840 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 01:45:24.407711 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 01:45:24.408643 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-02-23 01:45:24.409521 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-02-23 01:45:24.410452 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 01:45:24.411780 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 01:45:24.413072 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-02-23 01:45:24.414809 (MainThread): Parsing macros/schema_tests/recency.sql
2022-02-23 01:45:24.416398 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-02-23 01:45:24.418067 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-02-23 01:45:24.423012 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 01:45:24.426782 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 01:45:24.428104 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-02-23 01:45:24.429265 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 01:45:24.431896 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 01:45:24.433818 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 01:45:24.435590 (MainThread): Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 01:45:24.437700 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-02-23 01:45:24.440295 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 01:45:24.441687 (MainThread): Parsing macros/schema_tests/equality.sql
2022-02-23 01:45:24.444985 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 01:45:24.453866 (MainThread): Parsing macros/sql/date_spine.sql
2022-02-23 01:45:24.458256 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-02-23 01:45:24.459777 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 01:45:24.463276 (MainThread): Parsing macros/sql/generate_series.sql
2022-02-23 01:45:24.467432 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 01:45:24.471259 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 01:45:24.472873 (MainThread): Parsing macros/sql/star.sql
2022-02-23 01:45:24.476243 (MainThread): Parsing macros/sql/unpivot.sql
2022-02-23 01:45:24.483667 (MainThread): Parsing macros/sql/union.sql
2022-02-23 01:45:24.491651 (MainThread): Parsing macros/sql/groupby.sql
2022-02-23 01:45:24.492939 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-02-23 01:45:24.496285 (MainThread): Parsing macros/sql/safe_add.sql
2022-02-23 01:45:24.497789 (MainThread): Parsing macros/sql/nullcheck.sql
2022-02-23 01:45:24.499310 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 01:45:24.505816 (MainThread): Parsing macros/sql/get_column_values.sql
2022-02-23 01:45:24.510836 (MainThread): Parsing macros/sql/pivot.sql
2022-02-23 01:45:24.514661 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 01:45:24.516831 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-02-23 01:45:24.861424 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:45:24.872391 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:45:24.876042 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:45:24.879208 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:45:24.885661 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:45:24.888689 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:45:24.905070 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:45:24.909596 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:45:24.921717 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0".
2022-02-23 01:45:24.924658 (MainThread): Acquiring new snowflake connection "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0".
2022-02-23 01:45:24.984176 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307855760>]}
2022-02-23 01:45:24.992637 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa30772f970>]}
2022-02-23 01:45:24.992955 (MainThread): Found 8 models, 6 tests, 0 snapshots, 0 analyses, 359 macros, 2 operations, 0 seed files, 0 sources, 0 exposures
2022-02-23 01:45:24.994435 (MainThread): 
2022-02-23 01:45:24.994888 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:45:24.996314 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2022-02-23 01:45:25.010904 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2022-02-23 01:45:25.011123 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2022-02-23 01:45:25.011258 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-23 01:45:25.883043 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.87 seconds
2022-02-23 01:45:25.886476 (ThreadPoolExecutor-0_0): On list_analytics: Close
2022-02-23 01:45:26.057736 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2022-02-23 01:45:26.070312 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2022-02-23 01:45:26.070611 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2022-02-23 01:45:26.070828 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-23 01:45:26.945607 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.87 seconds
2022-02-23 01:45:26.948006 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2022-02-23 01:45:27.114565 (MainThread): 09:45:27 | 
2022-02-23 01:45:27.115157 (MainThread): 09:45:27 | Running 1 on-run-start hook
2022-02-23 01:45:27.115583 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0
2022-02-23 01:45:27.119118 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-start-0"
2022-02-23 01:45:27.121964 (MainThread): 09:45:27 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-start.0................. [RUN]
2022-02-23 01:45:27.122998 (MainThread): Using snowflake connection "master".
2022-02-23 01:45:27.123645 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, start_time) values ('start_process',current_timestamp());
2022-02-23 01:45:27.124023 (MainThread): Opening a new connection, currently in state init
2022-02-23 01:45:28.759051 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2022-02-23 01:45:28.759877 (MainThread): Using snowflake connection "master".
2022-02-23 01:45:28.760391 (MainThread): On master: commit;
2022-02-23 01:45:28.868845 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2022-02-23 01:45:28.871175 (MainThread): 09:45:28 | 1 of 1 OK hook: jrtests_learn_dbt1.on-run-start.0.................... [SUCCESS 1 in 1.75s]
2022-02-23 01:45:28.871658 (MainThread): 09:45:28 | 
2022-02-23 01:45:28.872081 (MainThread): On master: Close
2022-02-23 01:45:29.044226 (MainThread): 09:45:29 | Concurrency: 1 threads (target='dev')
2022-02-23 01:45:29.044786 (MainThread): 09:45:29 | 
2022-02-23 01:45:29.047299 (Thread-1): Began running node model.jrtests_learn_dbt1.dates
2022-02-23 01:45:29.048067 (Thread-1): 09:45:29 | 1 of 8 START incremental model dbt.dates............................. [RUN]
2022-02-23 01:45:29.048780 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:45:29.049143 (Thread-1): Compiling model.jrtests_learn_dbt1.dates
2022-02-23 01:45:29.056708 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.dates"
2022-02-23 01:45:29.057723 (Thread-1): finished collecting timing info
2022-02-23 01:45:29.108412 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.dates"
2022-02-23 01:45:29.109625 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.dates".
2022-02-23 01:45:29.109796 (Thread-1): On model.jrtests_learn_dbt1.dates: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.dates"} */


      create or replace transient table analytics.dbt.dates  as
      (
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
where d_date <= CURRENT_DATE


      );
2022-02-23 01:45:29.109928 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:31.216027 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2022-02-23 01:45:31.235377 (Thread-1): finished collecting timing info
2022-02-23 01:45:31.235766 (Thread-1): On model.jrtests_learn_dbt1.dates: Close
2022-02-23 01:45:31.397831 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3080280d0>]}
2022-02-23 01:45:31.398800 (Thread-1): 09:45:31 | 1 of 8 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.35s]
2022-02-23 01:45:31.399271 (Thread-1): Finished running node model.jrtests_learn_dbt1.dates
2022-02-23 01:45:31.399726 (Thread-1): Began running node model.jrtests_learn_dbt1.my_first_dbt_model
2022-02-23 01:45:31.400379 (Thread-1): 09:45:31 | 2 of 8 START table model dbt.first_model_2........................... [RUN]
2022-02-23 01:45:31.401483 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:45:31.401890 (Thread-1): Compiling model.jrtests_learn_dbt1.my_first_dbt_model
2022-02-23 01:45:31.408465 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2022-02-23 01:45:31.409889 (Thread-1): finished collecting timing info
2022-02-23 01:45:31.423975 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_first_dbt_model"
2022-02-23 01:45:31.425834 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_first_dbt_model".
2022-02-23 01:45:31.426093 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model_2  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, 'True' as first_variable
from source_data
where id >= 1

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-02-23 01:45:31.426267 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:32.604202 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2022-02-23 01:45:32.607750 (Thread-1): finished collecting timing info
2022-02-23 01:45:32.608262 (Thread-1): On model.jrtests_learn_dbt1.my_first_dbt_model: Close
2022-02-23 01:45:32.773301 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa308028880>]}
2022-02-23 01:45:32.774147 (Thread-1): 09:45:32 | 2 of 8 OK created table model dbt.first_model_2...................... [SUCCESS 1 in 1.37s]
2022-02-23 01:45:32.774712 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_first_dbt_model
2022-02-23 01:45:32.775130 (Thread-1): Began running node model.jrtests_learn_dbt1.orders_data
2022-02-23 01:45:32.776175 (Thread-1): 09:45:32 | 3 of 8 START view model dbt.orders_data.............................. [RUN]
2022-02-23 01:45:32.776983 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:45:32.777425 (Thread-1): Compiling model.jrtests_learn_dbt1.orders_data
2022-02-23 01:45:32.783218 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.orders_data"
2022-02-23 01:45:32.784438 (Thread-1): finished collecting timing info
2022-02-23 01:45:32.805734 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.orders_data"
2022-02-23 01:45:32.806800 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.orders_data".
2022-02-23 01:45:32.807035 (Thread-1): On model.jrtests_learn_dbt1.orders_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.orders_data"} */

  create or replace  view analytics.dbt.orders_data  as (
    
select *, current_timestamp() as o_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
  );
2022-02-23 01:45:32.807212 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:33.513421 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2022-02-23 01:45:33.516941 (Thread-1): finished collecting timing info
2022-02-23 01:45:33.517442 (Thread-1): On model.jrtests_learn_dbt1.orders_data: Close
2022-02-23 01:45:33.694601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307cbf8b0>]}
2022-02-23 01:45:33.695991 (Thread-1): 09:45:33 | 3 of 8 OK created view model dbt.orders_data......................... [SUCCESS 1 in 0.92s]
2022-02-23 01:45:33.696680 (Thread-1): Finished running node model.jrtests_learn_dbt1.orders_data
2022-02-23 01:45:33.697360 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_data
2022-02-23 01:45:33.698712 (Thread-1): 09:45:33 | 4 of 8 START view model dbt.raw_data................................. [RUN]
2022-02-23 01:45:33.700001 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:45:33.700652 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_data
2022-02-23 01:45:33.709695 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_data"
2022-02-23 01:45:33.710959 (Thread-1): finished collecting timing info
2022-02-23 01:45:33.715406 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_data"
2022-02-23 01:45:33.717156 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_data".
2022-02-23 01:45:33.717543 (Thread-1): On model.jrtests_learn_dbt1.raw_data: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_data"} */

  create or replace  view analytics.dbt.raw_data  as (
    

select *, current_timestamp() as r_loaddate from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2022-02-23 01:45:33.717784 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:34.446021 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2022-02-23 01:45:34.449478 (Thread-1): finished collecting timing info
2022-02-23 01:45:34.449963 (Thread-1): On model.jrtests_learn_dbt1.raw_data: Close
2022-02-23 01:45:34.627025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307f70400>]}
2022-02-23 01:45:34.627980 (Thread-1): 09:45:34 | 4 of 8 OK created view model dbt.raw_data............................ [SUCCESS 1 in 0.93s]
2022-02-23 01:45:34.628435 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_data
2022-02-23 01:45:34.628889 (Thread-1): Began running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2022-02-23 01:45:34.629862 (Thread-1): 09:45:34 | 5 of 8 START table model dbt.snowflake_customer_purchase............. [RUN]
2022-02-23 01:45:34.630956 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:45:34.631440 (Thread-1): Compiling model.jrtests_learn_dbt1.snowflake_customer_purchase
2022-02-23 01:45:34.636788 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2022-02-23 01:45:34.638222 (Thread-1): finished collecting timing info
2022-02-23 01:45:34.642838 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.snowflake_customer_purchase"
2022-02-23 01:45:34.644513 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.snowflake_customer_purchase".
2022-02-23 01:45:34.644847 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.snowflake_customer_purchase"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchase  as
      (
select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
sum(o.o_totalprice) as total_order_price
from
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY
      );
2022-02-23 01:45:34.645167 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:36.745611 (Thread-1): SQL status: SUCCESS 1 in 2.10 seconds
2022-02-23 01:45:36.749022 (Thread-1): finished collecting timing info
2022-02-23 01:45:36.749504 (Thread-1): On model.jrtests_learn_dbt1.snowflake_customer_purchase: Close
2022-02-23 01:45:36.914911 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307f70880>]}
2022-02-23 01:45:36.915876 (Thread-1): 09:45:36 | 5 of 8 OK created table model dbt.snowflake_customer_purchase........ [SUCCESS 1 in 2.28s]
2022-02-23 01:45:36.916363 (Thread-1): Finished running node model.jrtests_learn_dbt1.snowflake_customer_purchase
2022-02-23 01:45:36.916971 (Thread-1): Began running node model.jrtests_learn_dbt1.my_second_dbt_model
2022-02-23 01:45:36.917950 (Thread-1): 09:45:36 | 6 of 8 START table model dbt.my_second_dbt_model..................... [RUN]
2022-02-23 01:45:36.918819 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:45:36.919291 (Thread-1): Compiling model.jrtests_learn_dbt1.my_second_dbt_model
2022-02-23 01:45:36.924159 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2022-02-23 01:45:36.924847 (Thread-1): finished collecting timing info
2022-02-23 01:45:36.927778 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.my_second_dbt_model"
2022-02-23 01:45:36.928875 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.my_second_dbt_model".
2022-02-23 01:45:36.929075 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model_2
where id = 1
      );
2022-02-23 01:45:36.929244 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:38.495232 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2022-02-23 01:45:38.498765 (Thread-1): finished collecting timing info
2022-02-23 01:45:38.499292 (Thread-1): On model.jrtests_learn_dbt1.my_second_dbt_model: Close
2022-02-23 01:45:38.669426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa308083b20>]}
2022-02-23 01:45:38.670399 (Thread-1): 09:45:38 | 6 of 8 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 1.75s]
2022-02-23 01:45:38.670869 (Thread-1): Finished running node model.jrtests_learn_dbt1.my_second_dbt_model
2022-02-23 01:45:38.671316 (Thread-1): Began running node model.jrtests_learn_dbt1.raw_join_transform
2022-02-23 01:45:38.671923 (Thread-1): 09:45:38 | 7 of 8 START view model dbt.raw_join_transform....................... [RUN]
2022-02-23 01:45:38.672979 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:45:38.673317 (Thread-1): Compiling model.jrtests_learn_dbt1.raw_join_transform
2022-02-23 01:45:38.679736 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2022-02-23 01:45:38.681101 (Thread-1): finished collecting timing info
2022-02-23 01:45:38.686004 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.raw_join_transform"
2022-02-23 01:45:38.688111 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.raw_join_transform".
2022-02-23 01:45:38.688369 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.raw_join_transform"} */

  create or replace  view analytics.dbt.raw_join_transform  as (
    
with orders_data as( select * from analytics.dbt.orders_data),
raw_data as ( select * from analytics.dbt.raw_data),
transform as
(
  select c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY as nation,
  c.r_loaddate, o.o_loaddate,
sum(o.o_totalprice) as total_order_price,
current_timestamp() as load_date
from
raw_data c
LEFT JOIN   orders_data o
on c.c_custkey = o.o_custkey
group by c.C_CUSTKEY,c.C_NAME,c.C_NATIONKEY,c.r_loaddate, o.o_loaddate
)
select * from transform
  );
2022-02-23 01:45:38.688571 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:39.701058 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2022-02-23 01:45:39.704566 (Thread-1): finished collecting timing info
2022-02-23 01:45:39.705046 (Thread-1): On model.jrtests_learn_dbt1.raw_join_transform: Close
2022-02-23 01:45:39.875448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa308083310>]}
2022-02-23 01:45:39.876436 (Thread-1): 09:45:39 | 7 of 8 OK created view model dbt.raw_join_transform.................. [SUCCESS 1 in 1.20s]
2022-02-23 01:45:39.876988 (Thread-1): Finished running node model.jrtests_learn_dbt1.raw_join_transform
2022-02-23 01:45:39.878495 (Thread-1): Began running node model.jrtests_learn_dbt1.target_table
2022-02-23 01:45:39.879178 (Thread-1): 09:45:39 | 8 of 8 START incremental model dbt.target_table...................... [RUN]
2022-02-23 01:45:39.879794 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:45:39.880116 (Thread-1): Compiling model.jrtests_learn_dbt1.target_table
2022-02-23 01:45:39.891396 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt1.target_table"
2022-02-23 01:45:39.893402 (Thread-1): finished collecting timing info
2022-02-23 01:45:39.897497 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt1.target_table"
2022-02-23 01:45:39.899512 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt1.target_table".
2022-02-23 01:45:39.899853 (Thread-1): On model.jrtests_learn_dbt1.target_table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "node_id": "model.jrtests_learn_dbt1.target_table"} */


      create or replace  table analytics.dbt.target_table  as
      (

with raw_join_transform as (select * from analytics.dbt.raw_join_transform),
dailyrun as
(
  select md5(cast(coalesce(cast(raw_join_transform.c_custkey as 
    varchar
), '') || '-' || coalesce(cast(raw_join_transform.nation as 
    varchar
), '') as 
    varchar
)) shakey_raw,
  raw_join_transform.* from raw_join_transform
)

select * from dailyrun


      );
2022-02-23 01:45:39.900272 (Thread-1): Opening a new connection, currently in state closed
2022-02-23 01:45:41.791866 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2022-02-23 01:45:41.794171 (Thread-1): finished collecting timing info
2022-02-23 01:45:41.794466 (Thread-1): On model.jrtests_learn_dbt1.target_table: Close
2022-02-23 01:45:42.127583 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814dcf4c-1f93-4bb4-9a94-31c5a99bb730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307f34640>]}
2022-02-23 01:45:42.128733 (Thread-1): 09:45:42 | 8 of 8 OK created incremental model dbt.target_table................. [SUCCESS 1 in 2.25s]
2022-02-23 01:45:42.129389 (Thread-1): Finished running node model.jrtests_learn_dbt1.target_table
2022-02-23 01:45:42.131475 (MainThread): Acquiring new snowflake connection "master".
2022-02-23 01:45:42.131983 (MainThread): 09:45:42 | 
2022-02-23 01:45:42.132528 (MainThread): 09:45:42 | Running 1 on-run-end hook
2022-02-23 01:45:42.132943 (MainThread): Compiling operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0
2022-02-23 01:45:42.140893 (MainThread): Writing injected SQL for node "operation.jrtests_learn_dbt1.jrtests_learn_dbt1-on-run-end-0"
2022-02-23 01:45:42.142303 (MainThread): 09:45:42 | 1 of 1 START hook: jrtests_learn_dbt1.on-run-end.0................... [RUN]
2022-02-23 01:45:42.143087 (MainThread): Using snowflake connection "master".
2022-02-23 01:45:42.143525 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jrtests-snowflake-db", "target_name": "dev", "connection_name": "master"} */
insert into ANALYTICS.DBT.AUDIT_TABLE (process_name, end_time) values ('end_process',current_timestamp());
2022-02-23 01:45:42.144114 (MainThread): Opening a new connection, currently in state closed
2022-02-23 01:45:43.535434 (MainThread): SQL status: SUCCESS 1 in 1.39 seconds
2022-02-23 01:45:43.536085 (MainThread): Using snowflake connection "master".
2022-02-23 01:45:43.536428 (MainThread): On master: commit;
2022-02-23 01:45:43.716345 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-02-23 01:45:43.718542 (MainThread): 09:45:43 | 1 of 1 OK hook: jrtests_learn_dbt1.on-run-end.0...................... [SUCCESS 1 in 1.58s]
2022-02-23 01:45:43.719064 (MainThread): 09:45:43 | 
2022-02-23 01:45:43.719491 (MainThread): On master: Close
2022-02-23 01:45:43.894608 (MainThread): 09:45:43 | 
2022-02-23 01:45:43.895157 (MainThread): 09:45:43 | Finished running 2 incremental models, 3 table models, 3 view models, 2 hooks in 18.90s.
2022-02-23 01:45:43.895598 (MainThread): Connection 'master' was properly closed.
2022-02-23 01:45:43.895937 (MainThread): Connection 'model.jrtests_learn_dbt1.target_table' was properly closed.
2022-02-23 01:45:43.912131 (MainThread): 
2022-02-23 01:45:43.912475 (MainThread): Completed successfully
2022-02-23 01:45:43.912761 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2022-02-23 01:45:43.913276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa307844b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa30772fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa304cebd90>]}
2022-02-23 01:45:43.914184 (MainThread): Flushing usage events
